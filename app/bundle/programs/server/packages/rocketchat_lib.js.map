{"version":3,"sources":["meteor://💻app/packages/rocketchat:lib/lib/core.js","meteor://💻app/packages/rocketchat:lib/lib/settings.js","meteor://💻app/packages/rocketchat:lib/lib/RoomTypeConfig.js","meteor://💻app/packages/rocketchat:lib/lib/roomTypes/conversation.js","meteor://💻app/packages/rocketchat:lib/lib/roomTypes/direct.js","meteor://💻app/packages/rocketchat:lib/lib/roomTypes/favorite.js","meteor://💻app/packages/rocketchat:lib/lib/roomTypes/index.js","meteor://💻app/packages/rocketchat:lib/lib/roomTypes/private.js","meteor://💻app/packages/rocketchat:lib/lib/roomTypes/public.js","meteor://💻app/packages/rocketchat:lib/lib/roomTypes/unread.js","meteor://💻app/packages/rocketchat:lib/lib/getURL.js","meteor://💻app/packages/rocketchat:lib/lib/callbacks.js","meteor://💻app/packages/rocketchat:lib/lib/fileUploadRestrictions.js","meteor://💻app/packages/rocketchat:lib/lib/getAvatarColor.js","meteor://💻app/packages/rocketchat:lib/lib/getDefaultSubscriptionPref.js","meteor://💻app/packages/rocketchat:lib/lib/getValidRoomName.js","meteor://💻app/packages/rocketchat:lib/lib/placeholders.js","meteor://💻app/packages/rocketchat:lib/lib/promises.js","meteor://💻app/packages/rocketchat:lib/lib/RoomTypesCommon.js","meteor://💻app/packages/rocketchat:lib/lib/slashCommand.js","meteor://💻app/packages/rocketchat:lib/lib/Message.js","meteor://💻app/packages/rocketchat:lib/lib/MessageProperties.js","meteor://💻app/packages/rocketchat:lib/lib/messageBox.js","meteor://💻app/packages/rocketchat:lib/lib/MessageTypes.js","meteor://💻app/packages/rocketchat:lib/lib/templateVarHandler.js","meteor://💻app/packages/rocketchat:lib/lib/getUserNotificationPreference.js","meteor://💻app/packages/rocketchat:lib/lib/getUserPreference.js","meteor://💻app/packages/rocketchat:lib/lib/startup/settingsOnLoadSiteUrl.js","meteor://💻app/packages/rocketchat:lib/server/lib/debug.js","meteor://💻app/packages/rocketchat:lib/server/lib/bugsnag.js","meteor://💻app/packages/rocketchat:lib/server/lib/metrics.js","meteor://💻app/packages/rocketchat:lib/server/lib/RateLimiter.js","meteor://💻app/packages/rocketchat:lib/server/lib/configLogger.js","meteor://💻app/packages/rocketchat:lib/server/lib/PushNotification.js","meteor://💻app/packages/rocketchat:lib/server/lib/defaultBlockedDomainsList.js","meteor://💻app/packages/rocketchat:lib/server/lib/interceptDirectReplyEmails.js","meteor://💻app/packages/rocketchat:lib/server/lib/loginErrorMessageOverride.js","meteor://💻app/packages/rocketchat:lib/server/lib/notifyUsersOnMessage.js","meteor://💻app/packages/rocketchat:lib/server/lib/processDirectEmail.js","meteor://💻app/packages/rocketchat:lib/server/lib/roomTypes.js","meteor://💻app/packages/rocketchat:lib/server/lib/sendNotificationsOnMessage.js","meteor://💻app/packages/rocketchat:lib/server/lib/validateEmailDomain.js","meteor://💻app/packages/rocketchat:lib/server/lib/passwordPolicy.js","meteor://💻app/packages/rocketchat:lib/server/lib/index.js","meteor://💻app/packages/rocketchat:lib/server/lib/PasswordPolicyClass.js","meteor://💻app/packages/rocketchat:lib/server/functions/isDocker.js","meteor://💻app/packages/rocketchat:lib/server/functions/addUserToDefaultChannels.js","meteor://💻app/packages/rocketchat:lib/server/functions/addUserToRoom.js","meteor://💻app/packages/rocketchat:lib/server/functions/archiveRoom.js","meteor://💻app/packages/rocketchat:lib/server/functions/checkUsernameAvailability.js","meteor://💻app/packages/rocketchat:lib/server/functions/checkEmailAvailability.js","meteor://💻app/packages/rocketchat:lib/server/functions/createRoom.js","meteor://💻app/packages/rocketchat:lib/server/functions/cleanRoomHistory.js","meteor://💻app/packages/rocketchat:lib/server/functions/deleteMessage.js","meteor://💻app/packages/rocketchat:lib/server/functions/deleteUser.js","meteor://💻app/packages/rocketchat:lib/server/functions/getFullUserData.js","meteor://💻app/packages/rocketchat:lib/server/functions/getRoomByNameOrIdWithOptionToJoin.js","meteor://💻app/packages/rocketchat:lib/server/functions/loadMessageHistory.js","meteor://💻app/packages/rocketchat:lib/server/functions/removeUserFromRoom.js","meteor://💻app/packages/rocketchat:lib/server/functions/saveUser.js","meteor://💻app/packages/rocketchat:lib/server/functions/saveCustomFields.js","meteor://💻app/packages/rocketchat:lib/server/functions/saveCustomFieldsWithoutValidation.js","meteor://💻app/packages/rocketchat:lib/server/functions/sendMessage.js","meteor://💻app/packages/rocketchat:lib/server/functions/settings.js","meteor://💻app/packages/rocketchat:lib/server/functions/setUserAvatar.js","meteor://💻app/packages/rocketchat:lib/server/functions/setUsername.js","meteor://💻app/packages/rocketchat:lib/server/functions/setRealName.js","meteor://💻app/packages/rocketchat:lib/server/functions/setEmail.js","meteor://💻app/packages/rocketchat:lib/server/functions/unarchiveRoom.js","meteor://💻app/packages/rocketchat:lib/server/functions/updateMessage.js","meteor://💻app/packages/rocketchat:lib/server/functions/validateCustomFields.js","meteor://💻app/packages/rocketchat:lib/server/functions/Notifications.js","meteor://💻app/packages/rocketchat:lib/server/functions/notifications/audio.js","meteor://💻app/packages/rocketchat:lib/server/functions/notifications/desktop.js","meteor://💻app/packages/rocketchat:lib/server/functions/notifications/email.js","meteor://💻app/packages/rocketchat:lib/server/functions/notifications/index.js","meteor://💻app/packages/rocketchat:lib/server/functions/notifications/mobile.js","meteor://💻app/packages/rocketchat:lib/server/models/_Base.js","meteor://💻app/packages/rocketchat:lib/server/models/Avatars.js","meteor://💻app/packages/rocketchat:lib/server/models/Messages.js","meteor://💻app/packages/rocketchat:lib/server/models/Reports.js","meteor://💻app/packages/rocketchat:lib/server/models/Rooms.js","meteor://💻app/packages/rocketchat:lib/server/models/Settings.js","meteor://💻app/packages/rocketchat:lib/server/models/Subscriptions.js","meteor://💻app/packages/rocketchat:lib/server/models/Uploads.js","meteor://💻app/packages/rocketchat:lib/server/models/Users.js","meteor://💻app/packages/rocketchat:lib/server/models/ExportOperations.js","meteor://💻app/packages/rocketchat:lib/server/models/UserDataFiles.js","meteor://💻app/packages/rocketchat:lib/server/models/_BaseDb.js","meteor://💻app/packages/rocketchat:lib/server/oauth/oauth.js","meteor://💻app/packages/rocketchat:lib/server/oauth/facebook.js","meteor://💻app/packages/rocketchat:lib/server/oauth/twitter.js","meteor://💻app/packages/rocketchat:lib/server/oauth/google.js","meteor://💻app/packages/rocketchat:lib/server/oauth/proxy.js","meteor://💻app/packages/rocketchat:lib/server/startup/statsTracker.js","meteor://💻app/packages/rocketchat:lib/server/startup/settingsOnLoadCdnPrefix.js","meteor://💻app/packages/rocketchat:lib/server/startup/settingsOnLoadDirectReply.js","meteor://💻app/packages/rocketchat:lib/server/startup/settingsOnLoadSMTP.js","meteor://💻app/packages/rocketchat:lib/server/startup/oAuthServicesUpdate.js","meteor://💻app/packages/rocketchat:lib/server/startup/settings.js","meteor://💻app/packages/rocketchat:lib/server/startup/email.js","meteor://💻app/packages/rocketchat:lib/server/publications/settings.js","meteor://💻app/packages/rocketchat:lib/server/methods/addOAuthService.js","meteor://💻app/packages/rocketchat:lib/server/methods/refreshOAuthService.js","meteor://💻app/packages/rocketchat:lib/server/methods/addUserToRoom.js","meteor://💻app/packages/rocketchat:lib/server/methods/addUsersToRoom.js","meteor://💻app/packages/rocketchat:lib/server/methods/archiveRoom.js","meteor://💻app/packages/rocketchat:lib/server/methods/blockUser.js","meteor://💻app/packages/rocketchat:lib/server/methods/checkRegistrationSecretURL.js","meteor://💻app/packages/rocketchat:lib/server/methods/checkUsernameAvailability.js","meteor://💻app/packages/rocketchat:lib/server/methods/cleanRoomHistory.js","meteor://💻app/packages/rocketchat:lib/server/methods/createChannel.js","meteor://💻app/packages/rocketchat:lib/server/methods/createToken.js","meteor://💻app/packages/rocketchat:lib/server/methods/createPrivateGroup.js","meteor://💻app/packages/rocketchat:lib/server/methods/deleteMessage.js","meteor://💻app/packages/rocketchat:lib/server/methods/deleteUserOwnAccount.js","meteor://💻app/packages/rocketchat:lib/server/methods/executeSlashCommandPreview.js","meteor://💻app/packages/rocketchat:lib/server/methods/filterBadWords.js","meteor://💻app/packages/rocketchat:lib/server/methods/filterATAllTag.js","meteor://💻app/packages/rocketchat:lib/server/methods/filterATHereTag.js","meteor://💻app/packages/rocketchat:lib/server/methods/getChannelHistory.js","meteor://💻app/packages/rocketchat:lib/server/methods/getFullUserData.js","meteor://💻app/packages/rocketchat:lib/server/methods/getRoomJoinCode.js","meteor://💻app/packages/rocketchat:lib/server/methods/getRoomRoles.js","meteor://💻app/packages/rocketchat:lib/server/methods/getServerInfo.js","meteor://💻app/packages/rocketchat:lib/server/methods/getSingleMessage.js","meteor://💻app/packages/rocketchat:lib/server/methods/getSlashCommandPreviews.js","meteor://💻app/packages/rocketchat:lib/server/methods/getUserRoles.js","meteor://💻app/packages/rocketchat:lib/server/methods/insertOrUpdateUser.js","meteor://💻app/packages/rocketchat:lib/server/methods/joinDefaultChannels.js","meteor://💻app/packages/rocketchat:lib/server/methods/joinRoom.js","meteor://💻app/packages/rocketchat:lib/server/methods/leaveRoom.js","meteor://💻app/packages/rocketchat:lib/server/methods/removeOAuthService.js","meteor://💻app/packages/rocketchat:lib/server/methods/restartServer.js","meteor://💻app/packages/rocketchat:lib/server/methods/robotMethods.js","meteor://💻app/packages/rocketchat:lib/server/methods/saveSetting.js","meteor://💻app/packages/rocketchat:lib/server/methods/sendInvitationEmail.js","meteor://💻app/packages/rocketchat:lib/server/methods/sendMessage.js","meteor://💻app/packages/rocketchat:lib/server/methods/sendSMTPTestEmail.js","meteor://💻app/packages/rocketchat:lib/server/methods/setAdminStatus.js","meteor://💻app/packages/rocketchat:lib/server/methods/setRealName.js","meteor://💻app/packages/rocketchat:lib/server/methods/setUsername.js","meteor://💻app/packages/rocketchat:lib/server/methods/setEmail.js","meteor://💻app/packages/rocketchat:lib/server/methods/unarchiveRoom.js","meteor://💻app/packages/rocketchat:lib/server/methods/unblockUser.js","meteor://💻app/packages/rocketchat:lib/server/methods/updateMessage.js","meteor://💻app/packages/rocketchat:lib/startup/defaultRoomTypes.js","meteor://💻app/packages/rocketchat:lib/startup/index.js"],"names":["EventEmitter","module","watch","require","default","v","RocketChat","models","_","settings","callbacks","regexCallbacks","ts","Date","get","_id","callback","onload","Meteor","Object","keys","forEach","key","value","isRegExp","test","reduce","items","push","set","call","batchSet","save","setting","editor","actions","map","reduceRight","wrap","err","success","load","initialLoad","item","cbKey","cbValue","regex","concat","k","name","source","export","RoomSettingsEnum","UiTextContext","RoomTypeRouteConfig","RoomTypeConfig","NAME","TOPIC","ANNOUNCEMENT","DESCRIPTION","READ_ONLY","REACT_WHEN_READ_ONLY","ARCHIVE_OR_UNARCHIVE","JOIN_CODE","BROADCAST","SYSTEM_MESSAGES","E2E","CLOSE_WARNING","HIDE_WARNING","LEAVE_WARNING","NO_ROOMS_SUBSCRIBED","constructor","path","length","Error","_name","_path","identifier","Random","id","order","icon","header","label","route","_identifier","_order","_icon","_header","_label","_route","getDisplayName","room","allowRoomSettingChange","roomName","canBeCreated","isServer","authz","hasAtLeastOnePermission","userId","canBeDeleted","t","supportMembersList","isGroupChat","canAddUser","userDetailShowAll","userDetailShowAdmin","preventRenaming","includeInRoomSearch","enableMembersListProfile","getUiText","getMsgSender","senderId","Users","findOneById","getNotificationDetails","user","notificationMessage","title","text","username","canAccessUploadedFile","ConversationRoomType","condition","getUserPreference","DirectMessageRoomRoute","DirectMessageRoomType","action","params","openRoom","link","sub","findRoom","query","subscription","Subscriptions","findOne","rid","ChatRoom","roomData","fields","fname","secondaryRoomName","groupByType","getUserStatus","roomId","Session","usernames","join","context","FavoriteRoomType","PrivateRoomType","PublicRoomType","UnreadRoomType","PrivateRoomRoute","hasAllPermission","broadcast","ro","PublicRoomRoute","showJoinLink","unread","s","getURL","cdn","full","cdnPrefix","rtrim","trim","pathPrefix","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX","basePath","finalPath","ltrim","isCordova","absoluteUrl","showTime","showTotalTime","priority","HIGH","MEDIUM","LOW","getHooks","hookName","add","hook","isNumber","stack","find","cb","sortBy","remove","filter","run","constant","rocketchatHooksEnd","metrics","rocketchatHooks","startTimer","callbacks_length","totalTime","result","rocketchatCallbacksEnd","rocketchatCallbacks","time","now","callbackResult","currentTime","statsTracker","timing","split","match","console","log","String","runAsync","defer","fileUploadMediaWhiteList","mediaTypeWhiteList","fileUploadIsValidContentType","type","list","contains","wildCardGlob","wildcards","indexOf","replace","colors","getAvatarColor","getDefaultSubscriptionPref","_getDefaultSubscriptionPref","userPref","desktopNotifications","mobileNotifications","emailNotificationMode","highlights","preferences","Array","isArray","userHighlights","desktopPrefOrigin","mobilePushNotifications","mobilePrefOrigin","emailNotifications","emailPrefOrigin","getValidRoomName","displayName","slugifiedName","Rooms","findOneByDisplayName","archived","function","channel_name","slugify","nameValidation","RegExp","error","findOneByName","tmpName","next","findOneByNameAndNotId","placeholders","str","data","strLeft","strRightBack","email","password","reason","unsubscribe","promises","getHook","p","Promise","resolve","previousPromise","then","RoomTypesCommon","roomTypes","roomTypesOrder","mainOrder","roomConfig","routeConfig","isClient","triggersExit","roomExit","FlowRouter","hasCustomLink","roomType","getRouteLink","subData","routeData","getConfig","args","slashCommands","commands","_addingSlashCommand","command","options","providesPreview","previewer","previewCallback","description","permission","clientOnly","_runningSlashCommand","message","getPreviews","_gettingSlashCommandPreviews","previewInfo","slice","executePreview","_executeSlashCommandPreview","preview","methods","slashCommand","method","cmd","msg","Message","parse","language","messageType","MessageTypes","getType","render","template","localStorage","getItem","TAPi18n","__","u","html","escapeHTML","messageProperties","GraphemeSplitter","splitter","countGraphemes","messageWithoutEmojiShortnames","emoji","undefined","messageBox","group","config","actionExists","expression","ret","getById","messageActions","types","registerType","isSystemMessage","system","startup","room_name","user_by","user_added","user_removed","user_left","user_muted","user_unmuted","role","logger","Logger","templateVarHandler","variable","object","templateRegex","exec","tmpVariable","hasOwnProperty","debug","tmplVar","tmplAttrName","attrVal","getUserNotificationPreference","_getUserNotificationPreference","pref","preferenceKey","origin","serverValue","defaultValue","preference","host","ROOT_URL","defaultOptions","rootUrl","hostname","process","env","MOBILE_ROOT_URL","MOBILE_DDP_URL","WebAppInternals","generateBoilerplate","publish","Log_Trace_Methods","Log_Trace_Subscriptions","Log_Trace_Methods_Filter","Log_Trace_Subscriptions_Filter","traceConnection","enable","prefix","connection","clientAddress","httpHeaders","wrapMethods","originalHandler","methodsMap","originalArgs","end","meteorMethods","has_connection","has_user","prototype","unblock","apply","originalMeteorMethods","methodMap","each","handler","originalMeteorPublish","func","meteorSubscriptions","originalReady","ready","WebApp","rawConnectHandlers","use","req","res","setHeader","InstanceStatus","bugsnag","register","notify","Info","app","version","info","on","bindEnvironment","originalMeteorDebug","_debug","client","connect","http","promclient","collectDefaultMetrics","Summary","help","labelNames","rocketchatRestApi","messagesSent","Counter","notificationsSent","ddpSessions","Gauge","ddpAthenticatedSessions","ddpConnectedUsers","migration","instanceCount","oplogEnabled","totalUsers","activeUsers","nonActiveUsers","onlineUsers","awayUsers","offlineUsers","totalRooms","totalChannels","totalPrivateGroups","totalDirect","totalLivechat","totalMessages","totalChannelMessages","totalPrivateGroupMessages","totalDirectMessages","totalLivechatMessages","setDefaultLabels","uniqueId","siteUrl","setPrometheusData","date","unique_id","site_url","sessions","values","server","authenticatedSessions","unique","Statistics","statistics","findLast","Migrations","_getControl","enabled","write","createServer","timer","updatePrometheusConfig","port","listen","BIND_IP","setInterval","close","clearInterval","RateLimiter","limitFunction","fn","numRequests","timeInterval","matchers","TEST_MODE","rateLimiter","addRule","matcher","increment","rateLimitResult","check","allowed","Math","ceil","timeToReset","seconds","limitMethod","methodName","DDPRateLimiter","LoggerManager","showPackage","showFileAndLine","logLevel","parseInt","setTimeout","PushNotification","getNotificationId","serverId","hash","i","charCodeAt","send","usersTo","payload","badge","category","from","sound","notId","gcm","style","summaryText","image","Assets","apn","inc","notification_type","Push","emailDomainDefaultBlackList","IMAPIntercepter","POP3Intercepter","POP3Helper","IMAP","POP3","simpleParser","imap","tls","connTimeout","keepalive","delete","state","openInbox","getEmails","openBox","start","isActive","stop","Function","once","restart","search","newEmails","f","fetch","bodies","struct","markSeen","seqno","stream","headerBuffer","bodyBuffer","chunk","which","toString","body","headers","parseHeader","to","seq","addFlags","processDirectEmail","pop3","enabletls","totalMsgCount","currentMsgCount","login","status","msgcount","retr","quit","msgnumber","mail","initialProcess","dele","messageId","running","max","_runLoginHandlers","Accounts","methodInvocation","messageContainsHighlight","moment","some","highlight","regexp","escapeRegExp","notifyUsersOnMessage","editedAt","abs","diff","incMsgCountById","lastMessage","setLastMessageById","toAll","toHere","mentionIds","highlightsIds","findByRoomWithUserHighlights","mentions","mention","unreadCountDM","incUnreadForRoomIdExcludingUserId","incGroupMentionsAndUnreadForRoomIdExcludingUserId","incUserMentionsAndUnreadForRoomIdAndUserIds","compact","unreadCount","incUnread","includes","incMsgCountAndSetLastMessageById","setAlertForRoomIdExcludingUserId","setOpenForRoomIdExcludingUserId","reply","EmailReplyParser","sendMessage","sentByEmail","groupable","tsDiff","findOneByEmailAddress","prevMessage","Messages","mid","roomInfo","prevMessageLink","findOneByRoomIdAndUserId","blocked","blocker","muted","alias","parse_reply","roomTypesServer","setPublish","setRoomFind","roomFind","getRoomFind","getRoomName","runPublish","scope","sendNotification","callJoinRoom","parseMessageTextPerUser","replaceMentionedUsernamesWithFullNames","sendEmail","shouldNotifyEmail","sendSinglePush","shouldNotifyMobile","notifyDesktopUser","shouldNotifyDesktop","notifyAudioUser","shouldNotifyAudio","sender","hasMentionToAll","hasMentionToHere","disableAllMessageNotifications","disableNotifications","ignored","hasMentionToUser","muteGroupMentions","receiver","active","hasPermission","isHighlighted","audioNotifications","notificationSent","duration","desktopNotificationDuration","statusConnection","senderUsername","senderName","receiverUsername","emails","verified","emailAddress","address","Sandstorm","sendAllNotifications","mentionIdsWithoutGroups","maxMembersForNotification","roomMembersCount","findByRoomId","count","$or","$exists","kind","notificationField","$ne","$in","serverField","serverPreference","subscriptions","findNotificationPreferencesByRoom","findByRoomIdAndUserIds","index","splice","all","users","catch","dns","emailDomainBlackList","emailDomainWhiteList","useDefaultBlackList","useDNSDomainCheck","domain","validateEmailDomain","emailValidation","emailDomain","substr","lastIndexOf","wrapAsync","resolveMx","e","PasswordPolicy","passwordPolicy","minLength","maxLength","forbidRepeatingCharacters","forbidRepeatingCharactersCount","mustContainAtLeastOneLowercase","mustContainAtLeastOneUppercase","mustContainAtLeastOneNumber","mustContainAtLeastOneSpecialCharacter","throwError","_forbidRepeatingCharactersCount","forbiddingRepeatingCharacters","validate","exportDefault","fs","hasDockerEnv","statSync","hasDockerCGroup","readFileSync","isDocker","addUserToDefaultChannels","silenced","defaultRooms","findByDefaultAndTypes","muteUsernameByRoomId","createWithRoomAndUser","open","alert","userMentions","groupMentions","createUserJoinWithRoomIdAndUser","addUserToRoom","inviter","createUserAddedWithRoomIdAndUser","archiveRoom","archiveById","archiveByRoomId","usernameBlackList","toRegExp","usernameIsBlocked","restrictedUsername","checkUsernameAvailability","$regex","checkEmailAvailability","createRoom","owner","members","readOnly","extraData","findOneByUsername","reactWhenReadOnly","assign","msgs","usersCount","sysMes","Apps","isLoaded","prevent","await","getBridges","getListenerBridge","roomEvent","createWithFullRoomData","member","isTheOwner","extra","ls","addUserRoles","cleanRoomHistory","latest","oldest","inclusive","limit","excludePinned","filesOnly","fromUsers","gt","lt","fileCount","findFilesByRoomIdPinnedTimestampAndUsers","pinned","document","FileUpload","getStore","deleteById","file","update","$unset","$set","attachments","color","removeByIdPinnedTimestampLimitAndUsers","removeByIdPinnedTimestampAndUsers","resetLastMessageById","Notifications","notifyRoom","deleteMessage","keepHistory","showDeletedStatus","deletedMsg","messageEvent","cloneAndSaveAsHistoryById","setHiddenById","Uploads","_hidden","removeById","setAsDeletedByIdAndUser","deleteUser","avatarOrigin","roomCache","db","findByUserId","subscribers","hasRole","numOwners","getUsersInRole","messageErasureType","store","findFilesByUserId","removeByUserId","rocketCat","nameAlias","unlinkUserId","removeByRoomId","removeFilesByRoomId","removeDirectRoomContainingUsername","deleteByName","Integrations","disableByUserId","notifyLogged","defaultFields","utcOffset","fullFields","phone","createdAt","lastLogin","services","requirePasswordChange","requirePasswordChangeReason","roles","publicCustomFields","customFields","customFieldsOnServer","JSON","element","public","warn","getFullUserData","l","userToRetrieveFullUserData","isMyOwnInfo","viewFullOtherUserInfo","_customFields","sort","findByUsername","usernameReg","findByUsernameNameOrEmailAddress","getRoomByNameOrIdWithOptionToJoin","_getRoomByNameOrIdWithOptionToJoin","currentUserId","nameOrId","tryDirectByUserIdOnly","joinChannel","errorOnEmpty","startsWith","substring","findOneByIdOrName","roomUser","isObject","runAsUser","hideMessagesOfType","loadMessageHistory","records","findVisibleByRoomIdBeforeTimestampNotContainingTypes","findVisibleByRoomIdNotContainingTypes","UI_Use_Real_Name","messages","starred","findWhere","unreadNotLoaded","firstUnread","firstMessage","unreadMessages","findVisibleByRoomIdBetweenTimestampsNotContainingTypes","removeUserFromRoom","removedUser","createUserLeaveWithRoomIdAndUser","createCommandWithRoomIdAndUser","removeByRoomIdAndUserId","Mailer","getTemplate","validateUserData","userData","existingRoles","pluck","getRoles","difference","field","escape","input","saveUser","createUser","joinDefaultChannels","updateUser","sendWelcomeEmail","subject","gravatarUrl","Gravatar","imageUrl","size","secure","setUserAvatar","setUsername","setRealName","shouldSendVerificationEmailToUser","setEmail","setPassword","saveCustomFields","formData","validateCustomFields","saveCustomFieldsWithoutValidation","customFieldsMeta","setCustomFields","setCustomFieldsDirectMessagesByUserId","fieldName","modifyRecordField","array","$addToSet","objectMaybeIncluding","Match","Where","validateAttachmentsFields","attachmentField","short","Boolean","OneOf","Integer","validateAttachmentsActions","attachmentActions","url","image_url","is_webview","webview_height_ratio","msg_in_chat_window","validateAttachment","attachment","thumb_url","button_alignment","Any","message_link","collapsed","author_name","author_link","author_icon","title_link","title_link_download","audio_url","video_url","validateBodyAttachments","upsert","avatar","parseUrls","Markdown","code","urls","mountTokensBack","tokens","sandstormSessionId","insert","blockedSettings","SETTINGS_BLOCKED","settingId","hiddenSettings","SETTINGS_HIDDEN","_sorter","packageValue","valueSource","hidden","sorter","enableQuery","stringify","i18nDefaultQuery","toLowerCase","processEnvValue","meteorSettingsValue","i18nLabel","i18nDescription","autocomplete","updateOperations","$setOnInsert","force","extend","section","existantSetting","Settings","addGroup","isFunction","updateById","updateValueAndEditorById","updateValueById","updateOptionsById","clearById","init","observe","added","record","changed","removed","afterInitialLoad","onAfterInitialLoad","dataURI","contentType","service","encoding","setAvatarOrigin","HTTP","npmRequestOptions","response","statusCode","content","fileData","RocketChatFile","dataURIParse","buffer","Buffer","fileStore","_setUsername","previousUsername","sendEnrollmentEmail","avatarSuggestions","getAvatarSuggestionForUser","gravatar","avatarData","blob","updateAllUsernamesByUserId","updateUsernameOfEditByUserId","findByMention","updatedMsg","updateUsernameAndMessageOfMentionByIdAndOldUsername","replaceUsername","replaceMutedUsername","replaceUsernameOfUserByUserId","setUserUsernameByUserId","setNameForDirectRoomsWithOldName","LivechatDepartmentAgents","replaceUsernameOfAgentByUserId","model","updateFileNameById","_setRealName","setName","updateDirectFNameByName","_setEmail","shouldSendVerificationEmail","unarchiveRoom","unarchiveById","unarchiveByRoomId","updateMessage","originalMessage","appMessage","editedBy","tempid","fieldValue","required","streamAll","Streamer","streamLogged","streamRoom","streamRoomUsers","streamUser","allowWrite","eventName","findByRoomIdAndNotUserId","notifyUser","allowRead","token","notifyAll","unshift","emit","notifyAllInThisInstance","emitWithoutBroadcast","notifyLoggedInThisInstance","notifyRoomInThisInstance","notifyUserInThisInstance","typing","advice","goToMessage","inlinecss","getEmailContent","lng","userName","channel","messageContent","fileHeader","subjectKey","emailSubject","room_path","replyto","messageText","image_type","reject","CATEGORY_MESSAGE","CATEGORY_MESSAGE_NOREPLY","alwaysNotifyMobileBoolean","SubscriptionRaw","rawCollection","getBadgeCount","aggregate","$match","$group","total","$sum","toArray","canSendMessageToRoom","ModelsBaseDb","objectPath","ModelsBase","nameOrModel","_db","collectionName","bind","arrayToCursor","setUpdatedAt","findOneByIds","ids","insertOrUpsert","allow","deny","ensureIndex","dropIndex","tryEnsureIndex","tryDropIndex","trashFind","trashFindOneById","trashFindDeletedAfter","processQueryOptionsOnResult","a","b","r","direction","valueA","valueB","skip","fieldsToRemove","fieldsToGet","pickFields","obj","picked","omit","_Base","Avatars","before","doc","instanceId","insertAvatarFileInit","complete","uploading","progress","extension","uploadedAt","updateFileComplete","fileId","direct","updateFileCompleteByNameAndUserId","deleteFile","sparse","expireAt","expireAfterSeconds","snippeted","location","slackBotId","slackTs","countVisibleByRoomIdBetweenTimestampsInclusive","afterTimestamp","beforeTimestamp","$gte","$lte","findVisibleByMentionAndRoomId","findVisibleByRoomId","$nin","findInvisibleByRoomId","findVisibleByRoomIdAfterTimestamp","timestamp","$gt","findForUpdates","_updatedAt","findVisibleByRoomIdBeforeTimestamp","$lt","findVisibleByRoomIdBeforeTimestampInclusive","findVisibleByRoomIdBetweenTimestamps","findVisibleByRoomIdBetweenTimestampsInclusive","findVisibleCreatedOrEditedAfterTimestamp","findStarredByUserAtRoom","findPinnedByRoom","findSnippetedByRoom","getLastTimestamp","findByRoomIdAndMessageIds","messageIds","findOneBySlackBotIdAndSlackTs","findOneBySlackTs","findByRoomIdAndType","getLastVisibleMessageSentWithNoTypeByRoomId","me","parent","reactions","setPinnedByIdAndUserId","pinnedBy","pinnedAt","setSnippetedByIdAndUserId","snippetName","snippetedBy","snippetedAt","setUrlsById","multi","oldUsername","newUsername","newMessage","updateUserStarById","$pull","upgradeEtsToEditAt","ets","$rename","setMessageAttachments","setSlackBotIdAndSlackTs","newUserId","newNameAlias","createWithTypeRoomIdMessageAndUser","createNavigationHistoryWithRoomIdMessageAndUser","createUserRemovedWithRoomIdAndUser","createUserMutedWithRoomIdAndUser","createUserUnmutedWithRoomIdAndUser","createNewModeratorWithRoomIdAndUser","createModeratorRemovedWithRoomIdAndUser","createNewOwnerWithRoomIdAndUser","createOwnerRemovedWithRoomIdAndUser","createNewLeaderWithRoomIdAndUser","createLeaderRemovedWithRoomIdAndUser","createSubscriptionRoleAddedWithRoomIdAndUser","createSubscriptionRoleRemovedWithRoomIdAndUser","messagesToDelete","getMessageByFileId","fileID","setAsRead","until","setAsReadById","findUnreadMessagesByRoomAndDate","after","Reports","createWithMessageDescriptionAndUserId","ModelRooms","_idOrName","findOneByImportId","importIds","findOneByNameAndType","findById","findByIds","roomIds","findByType","findByTypeInIds","findByTypes","findBySubscriptionUserId","findBySubscriptionTypeAndUserId","findByUserIdAndType","findBySubscriptionUserIdUpdatedAfter","findByNameContaining","nameRegex","findByNameContainingAndTypes","findByNameAndType","findByNameAndTypeNotDefault","findByNameAndTypesNotInIds","findChannelAndPrivateByNameStarting","findDirectRoomContainingUsername","findByTypeAndName","findByTypeAndNameContaining","findByTypeInIdsAndNameContaining","findByTypeAndArchivationState","archivationstate","addImportIds","$each","setNameById","setFnameById","$inc","lastMessageTimestamp","lm","incUsersCountById","incUsersCountByIds","setJoinCodeById","joinCode","joinCodeRequired","setUserById","setTypeById","setTopicById","topic","setAnnouncementById","announcement","announcementDetails","setCustomFieldsById","unmuteUsernameByRoomId","saveDefaultById","saveRetentionEnabledById","saveRetentionMaxAgeById","Number","saveRetentionExcludePinnedById","saveRetentionFilesOnlyById","saveRetentionOverrideGlobalById","saveEncryptedById","encrypted","setTopicAndTagsById","tags","setData","unsetData","isEmpty","tag","createWithTypeNameUserAndUsernames","createWithIdTypeAndName","ModelSettings","findOneNotHiddenById","findByRole","findPublic","findNotHiddenPublic","findNotHiddenPublicUpdatedAfter","updatedAt","findNotHiddenPrivate","findNotHidden","findNotHiddenUpdatedAfter","findSetupWizardSettings","wizard","updateValueNotHiddenById","createWithIdAndValue","_createdAt","ModelSubscriptions","autoTranslate","autoTranslateLanguage","findOneByRoomIdAndUsername","findOneByRoomNameAndUserId","findByUserIdAndTypes","findByUserIdUpdatedAfter","findByRoomIdAndRoles","findByTypeAndUserId","getLastSeen","userIds","findByRoomIdAndUserIdsOrAllMessages","findByRoomIdWhenUserIdExists","findByRoomIdWhenUsernameExists","findUnreadByUserId","getMinimumLastSeenByRoomId","hideByRoomIdAndUserId","openByRoomIdAndUserId","setAsReadByRoomIdAndUserId","setAsUnreadByRoomIdAndUserId","firstMessageUnreadTimestamp","setFavoriteByRoomIdAndUserId","favorite","updateNameAndAlertByRoomId","updateDisplayNameByRoomId","oldName","incGroup","incUser","ignoreUser","ignoredUser","ignore","setBlockedByRoomId","query2","update2","unsetBlockedByRoomId","updateCustomFieldsByRoomId","cfields","updateTypeByRoomId","addRoleById","removeRoleById","setArchivedByUsername","clearDesktopNotificationUserPreferences","updateDesktopNotificationUserPreferences","clearMobileNotificationUserPreferences","updateMobileNotificationUserPreferences","clearEmailNotificationUserPreferences","updateEmailNotificationUserPreferences","updateUserHighlights","findNotHiddenFilesOfRoom","searchText","fileQuery","fileOptions","insertFileInit","ModelUsers","findOneAdmin","admin","findOneByIdAndLoginToken","_hashLoginToken","findUsersNotOffline","findActiveByUsernameOrNameRegexWithExceptions","searchTerm","exceptions","termRegex","$and","findByActiveUsersExcept","orStmt","acc","el","findUsersByNameOrUsername","nameOrUsername","usernameNameOrEmailAddress","findLDAPUsers","ldap","findCrowdUsers","crowd","getLastLogin","findUsersByUsernames","findUsersByIds","findUsersWithUsernameByIds","findUsersWithUsernameByIdsNotOffline","getOldest","updateLastLoginById","setServiceId","serviceName","serviceId","serviceIdKey","setEmailVerified","$elemMatch","unsetAvatarOrigin","setUserActive","setAllUsersActive","unsetLoginTokens","unsetRequirePasswordChange","resetPasswordAndSetRequirePasswordChange","setLanguage","setProfile","profile","clearSettings","setPreferences","clockMode","setUtcOffset","saveUserById","phoneNumber","setReason","unsetReason","addBannerById","banner","removeBannerById","create","getUsersToSendOfflineEmail","usersIds","ExportOperations","ModelExportOperations","findLastOperationByUser","fullExport","findPendingByUser","findAllPending","updateOperation","roomList","fileList","generatedFile","exportOperation","UserDataFiles","ModelUserDataFiles","findLastFileByUser","userDataFile","baseName","trash","Mongo","Collection","_ensureIndex","collection","_deletedAt","isOplogAvailable","MongoInternals","defaultRemoteCollectionDriver","mongo","_oplogHandle","onOplogEntry","isOplogEnabled","baseModel","wrapModel","alreadyListeningToOplog","event","processOplogRecord","_defineTooFarBehind","MAX_SAFE_INTEGER","originals","self","_doNotMixInclusionAndExclusionFields","removeKeys","updateHasPositionalOperator","op","clientAction","o","oplog","listenerCount","findOptions","insertedId","_returnObject","__collection__","_dropIndex","deletedAt","AccessTokenServices","registerAccessTokenService","handleAccessTokenRequest","registerLoginHandler","accessToken","ObjectIncluding","ServiceConfiguration","configurations","ConfigError","oauth","serviceNames","LoginCancelledError","numericError","oauthResult","updateOrCreateUserFromExternalService","serviceData","OAuth","crypto","Npm","whitelisted","FB_API_VERSION","FB_URL","getIdentity","secret","hmac","createHmac","openSecret","access_token","appsecret_proof","digest","expiresIn","identity","Maybe","expiresAt","pick","Twit","whitelistedFields","appId","appSecret","accessTokenSecret","Twitter","consumer_key","consumer_secret","access_token_secret","syncTwitter","getScopes","idToken","scopes","Google","refreshToken","_redirectUri","proxy","StatsD","StatsTracker","dogstatsd","track","stats","hrtime","decrement","histogram","gauge","testWebAppInternals","useForAll","isString","setBundledJsCssPrefix","cdnValue","cdnJsCss","startEmailIntercepter","debounce","buildMailURL","MAIL_URL","encodeURIComponent","oauth_updated","_OAuthServicesUpdate","clientId","custom","serverURL","tokenPath","identityPath","authorizePath","buttonLabelText","buttonLabelColor","loginStyle","buttonColor","tokenSentVia","identityTokenSentVia","usernameField","mergeUsers","CustomOAuth","consumerKey","OAuthServicesUpdate","OAuthServicesRemove","DEPLOYMENT_ID","readonly","step","actionText","multiline","placeholder","properties","addOAuthService","capitalize","persistent","refreshOAuthService","addUsersToRoom","userInRoom","newUser","blockUser","subscription2","checkRegistrationSecretURL","createChannel","Optional","createToken","_generateStampedLoginToken","_insertLoginToken","authToken","createPrivateGroup","tokenpass","balance","forceDelete","deleteAllowed","deleteOwn","blockDeleteInMinutes","msgTs","currentTsDiff","deleteUserOwnAccount","bcrypt","_checkPassword","algorithm","executeSlashCommandPreview","theCmd","Filter","badWordsList","clean","getChannelHistory","unreads","fromUserId","isUndefined","isDate","firstMsg","getRoomJoinCode","getRoomRoles","Roles","getServerInfo","getSingleMessage","msgId","getSlashCommandPreviews","getUserRoles","roleIds","findUsersInRoles","intersection","insertOrUpdateUser","joinRoom","balances","updateUserTokenpassBalances","Tokenpass","validateAccess","canAccessRoom","leaveRoom","removeOAuthService","restart_server","abort","exit","m","cursor","saveSetting","sendInvitationEmail","validEmails","checkAddressFormat","message_ts","server_ts","getTime","adjustedMessage","sandstorm","sendSMTPTestEmail","setAdminStatus","param","joinDefaultChannelsSilenced","unblockUser","editAllowed","editOwn","blockEditInMinutes","setSettings"],"mappings":"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","file":"/packages/rocketchat_lib.js","sourcesContent":["import EventEmitter from 'wolfy87-eventemitter';\nRocketChat = new EventEmitter();\n/*\n* Kick off the global namespace for RocketChat.\n* @namespace RocketChat\n*/\nRocketChat.models = {};\n","import _ from 'underscore';\n\n/*\n* RocketChat.settings holds all packages settings\n* @namespace RocketChat.settings\n*/\nRocketChat.settings = {\n\tcallbacks: {},\n\tregexCallbacks: {},\n\tts: new Date,\n\tget(_id, callback) {\n\t\tif (callback != null) {\n\t\t\tRocketChat.settings.onload(_id, callback);\n\t\t\tif (!Meteor.settings) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_id === '*') {\n\t\t\t\treturn Object.keys(Meteor.settings).forEach((key) => {\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tcallback(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (_.isRegExp(_id) && Meteor.settings) {\n\t\t\t\treturn Object.keys(Meteor.settings).forEach((key) => {\n\t\t\t\t\tif (!_id.test(key)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tcallback(key, value);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn Meteor.settings[_id] != null && callback(_id, Meteor.settings[_id]);\n\t\t} else {\n\t\t\tif (!Meteor.settings) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (_.isRegExp(_id)) {\n\t\t\t\treturn Object.keys(Meteor.settings).reduce((items, key) => {\n\t\t\t\t\tconst value = Meteor.settings[key];\n\t\t\t\t\tif (_id.test(key)) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn items;\n\t\t\t\t}, []);\n\t\t\t}\n\t\t\treturn Meteor.settings && Meteor.settings[_id];\n\t\t}\n\t},\n\tset(_id, value, callback) {\n\t\treturn Meteor.call('saveSetting', _id, value, callback);\n\t},\n\tbatchSet(settings, callback) {\n\t\t// async -> sync\n\t\t// http://daemon.co.za/2012/04/simple-async-with-only-underscore/\n\t\tconst save = function(setting) {\n\t\t\treturn function(callback) {\n\t\t\t\treturn Meteor.call('saveSetting', setting._id, setting.value, setting.editor, callback);\n\t\t\t};\n\t\t};\n\t\tconst actions = _.map(settings, (setting) => save(setting));\n\t\treturn _(actions).reduceRight(_.wrap, (err, success) => callback(err, success))();\n\t},\n\tload(key, value, initialLoad) {\n\t\t['*', key].forEach((item) => {\n\t\t\tif (RocketChat.settings.callbacks[item]) {\n\t\t\t\tRocketChat.settings.callbacks[item].forEach((callback) => callback(key, value, initialLoad));\n\t\t\t}\n\t\t});\n\t\tObject.keys(RocketChat.settings.regexCallbacks).forEach((cbKey) => {\n\t\t\tconst cbValue = RocketChat.settings.regexCallbacks[cbKey];\n\t\t\tif (!cbValue.regex.test(key)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcbValue.callbacks.forEach((callback) => callback(key, value, initialLoad));\n\t\t});\n\t},\n\tonload(key, callback) {\n\t\t// if key is '*'\n\t\t// \tfor key, value in Meteor.settings\n\t\t// \t\tcallback key, value, false\n\t\t// else if Meteor.settings?[_id]?\n\t\t// \tcallback key, Meteor.settings[_id], false\n\t\tconst keys = [].concat(key);\n\t\tkeys.forEach((k) => {\n\t\t\tif (_.isRegExp(k)) {\n\t\t\t\tRocketChat.settings.regexCallbacks[name = k.source] = RocketChat.settings.regexCallbacks[name = k.source] || {\n\t\t\t\t\tregex: k,\n\t\t\t\t\tcallbacks: [],\n\t\t\t\t};\n\t\t\t\tRocketChat.settings.regexCallbacks[k.source].callbacks.push(callback);\n\t\t\t} else {\n\t\t\t\tRocketChat.settings.callbacks[k] = RocketChat.settings.callbacks[k] || [];\n\t\t\t\tRocketChat.settings.callbacks[k].push(callback);\n\t\t\t}\n\t\t});\n\t},\n};\n","export const RoomSettingsEnum = {\n\tNAME: 'roomName',\n\tTOPIC: 'roomTopic',\n\tANNOUNCEMENT: 'roomAnnouncement',\n\tDESCRIPTION: 'roomDescription',\n\tREAD_ONLY: 'readOnly',\n\tREACT_WHEN_READ_ONLY: 'reactWhenReadOnly',\n\tARCHIVE_OR_UNARCHIVE: 'archiveOrUnarchive',\n\tJOIN_CODE: 'joinCode',\n\tBROADCAST: 'broadcast',\n\tSYSTEM_MESSAGES: 'systemMessages',\n\tE2E: 'encrypted',\n};\n\nexport const UiTextContext = {\n\tCLOSE_WARNING: 'closeWarning',\n\tHIDE_WARNING: 'hideWarning',\n\tLEAVE_WARNING: 'leaveWarning',\n\tNO_ROOMS_SUBSCRIBED: 'noRoomsSubscribed',\n};\n\nexport class RoomTypeRouteConfig {\n\tconstructor({ name, path }) {\n\t\tif (typeof name !== 'undefined' && (typeof name !== 'string' || name.length === 0)) {\n\t\t\tthrow new Error('The name must be a string.');\n\t\t}\n\n\t\tif (typeof path !== 'undefined' && (typeof path !== 'string' || path.length === 0)) {\n\t\t\tthrow new Error('The path must be a string.');\n\t\t}\n\n\t\tthis._name = name;\n\t\tthis._path = path;\n\t}\n\n\tget name() {\n\t\treturn this._name;\n\t}\n\n\tget path() {\n\t\treturn this._path;\n\t}\n}\n\nexport class RoomTypeConfig {\n\tconstructor({\n\t\tidentifier = Random.id(),\n\t\torder,\n\t\ticon,\n\t\theader,\n\t\tlabel,\n\t\troute,\n\t}) {\n\t\tif (typeof identifier !== 'string' || identifier.length === 0) {\n\t\t\tthrow new Error('The identifier must be a string.');\n\t\t}\n\n\t\tif (typeof order !== 'number') {\n\t\t\tthrow new Error('The order must be a number.');\n\t\t}\n\n\t\tif (typeof icon !== 'undefined' && (typeof icon !== 'string' || icon.length === 0)) {\n\t\t\tthrow new Error('The icon must be a string.');\n\t\t}\n\n\t\tif (typeof header !== 'undefined' && (typeof header !== 'string' || header.length === 0)) {\n\t\t\tthrow new Error('The header must be a string.');\n\t\t}\n\n\t\tif (typeof label !== 'undefined' && (typeof label !== 'string' || label.length === 0)) {\n\t\t\tthrow new Error('The label must be a string.');\n\t\t}\n\n\t\tif (typeof route !== 'undefined' && !(route instanceof RoomTypeRouteConfig)) {\n\t\t\tthrow new Error('Room\\'s route is not a valid route configuration. Must be an instance of \"RoomTypeRouteConfig\".');\n\t\t}\n\n\t\tthis._identifier = identifier;\n\t\tthis._order = order;\n\t\tthis._icon = icon;\n\t\tthis._header = header;\n\t\tthis._label = label;\n\t\tthis._route = route;\n\t}\n\n\t/**\n\t * The room type's internal identifier.\n\t */\n\tget identifier() {\n\t\treturn this._identifier;\n\t}\n\n\t/**\n\t * The order of this room type for the display.\n\t */\n\tget order() {\n\t\treturn this._order;\n\t}\n\n\t/**\n\t * Sets the order of this room type for the display.\n\t *\n\t * @param {number} order the number value for the order\n\t */\n\tset order(order) {\n\t\tif (typeof order !== 'number') {\n\t\t\tthrow new Error('The order must be a number.');\n\t\t}\n\n\t\tthis._order = order;\n\t}\n\n\t/**\n\t * The icon class, css, to use as the visual aid.\n\t */\n\tget icon() {\n\t\treturn this._icon;\n\t}\n\n\t/**\n\t * The header name of this type.\n\t */\n\tget header() {\n\t\treturn this._header;\n\t}\n\n\t/**\n\t * The i18n label for this room type.\n\t */\n\tget label() {\n\t\treturn this._label;\n\t}\n\n\t/**\n\t * The route config for this room type.\n\t */\n\tget route() {\n\t\treturn this._route;\n\t}\n\n\t/**\n\t * Gets the room's name to display in the UI.\n\t *\n\t * @param {object} room\n\t */\n\tgetDisplayName(room) {\n\t\treturn room.name;\n\t}\n\n\tallowRoomSettingChange(/* room, setting */) {\n\t\treturn true;\n\t}\n\n\t/**\n\t * Return a room's name\n\t *\n\t * @abstract\n\t * @return {string} Room's name according to it's type\n\t */\n\troomName(/* room */) {\n\t\treturn '';\n\t}\n\n\tcanBeCreated() {\n\t\treturn Meteor.isServer ?\n\t\t\tRocketChat.authz.hasAtLeastOnePermission(Meteor.userId(), [`create-${ this._identifier }`]) :\n\t\t\tRocketChat.authz.hasAtLeastOnePermission([`create-${ this._identifier }`]);\n\t}\n\n\tcanBeDeleted(room) {\n\t\treturn Meteor.isServer ?\n\t\t\tRocketChat.authz.hasAtLeastOnePermission(Meteor.userId(), [`delete-${ room.t }`], room._id) :\n\t\t\tRocketChat.authz.hasAtLeastOnePermission([`delete-${ room.t }`], room._id);\n\t}\n\n\tsupportMembersList(/* room */) {\n\t\treturn true;\n\t}\n\n\tisGroupChat() {\n\t\treturn false;\n\t}\n\n\tcanAddUser(/* userId, room */) {\n\t\treturn false;\n\t}\n\n\tuserDetailShowAll(/* room */) {\n\t\treturn true;\n\t}\n\n\tuserDetailShowAdmin(/* room */) {\n\t\treturn true;\n\t}\n\n\tpreventRenaming(/* room */) {\n\t\treturn false;\n\t}\n\n\tincludeInRoomSearch() {\n\t\treturn false;\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns a text which can be used in generic UIs.\n\t * @param context The role of the text in the UI-Element\n\t * @return {string} A text or a translation key - the consumers of this method will pass the\n\t * returned value to an internationalization library\n\t */\n\tgetUiText(/* context */) {\n\t\treturn '';\n\t}\n\n\t/**\n\t * Returns the full object of message sender\n\t * @param {string} senderId Sender's _id\n\t * @return {object} Sender's object from db\n\t */\n\tgetMsgSender(senderId) {\n\t\treturn Meteor.isServer ? RocketChat.models.Users.findOneById(senderId) : {};\n\t}\n\n\t/**\n\t * Returns details to use on notifications\n\t *\n\t * @param {object} room\n\t * @param {object} user\n\t * @param {string} notificationMessage\n\t * @return {object} Notification details\n\t */\n\tgetNotificationDetails(room, user, notificationMessage) {\n\t\tif (!Meteor.isServer) {\n\t\t\treturn {};\n\t\t}\n\n\t\tconst title = `#${ this.roomName(room) }`;\n\n\t\tconst text = `${ RocketChat.settings.get('UI_Use_Real_Name') ? user.name : user.username }: ${ notificationMessage }`;\n\n\t\treturn { title, text };\n\t}\n\n\t/**\n\t * Check if there is an user with the same id and loginToken\n\t * @param {object} allowData\n\t * @return {object} User's object from db\n\t */\n\tcanAccessUploadedFile(/* accessData */) {\n\t\treturn false;\n\t}\n\n}\n","import { RoomTypeConfig } from '../RoomTypeConfig';\n\nexport class ConversationRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'merged',\n\t\t\torder: 30,\n\t\t\tlabel: 'Conversations',\n\t\t});\n\t}\n\n\tcondition() {\n\t\t// returns true only if sidebarGroupByType is not set\n\t\treturn !RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t}\n}\n","/* globals openRoom */\nimport { RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext } from '../RoomTypeConfig';\n\nexport class DirectMessageRoomRoute extends RoomTypeRouteConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tname: 'direct',\n\t\t\tpath: '/direct/:username',\n\t\t});\n\t}\n\n\taction(params) {\n\t\treturn openRoom('d', params.username);\n\t}\n\n\tlink(sub) {\n\t\treturn { username: sub.name };\n\t}\n}\n\nexport class DirectMessageRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'd',\n\t\t\torder: 50,\n\t\t\tlabel: 'Direct_Messages',\n\t\t\troute: new DirectMessageRoomRoute(),\n\t\t});\n\t}\n\n\tfindRoom(identifier) {\n\t\tif (!RocketChat.authz.hasAtLeastOnePermission('view-d-room')) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tname: identifier,\n\t\t};\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne(query);\n\t\tif (subscription && subscription.rid) {\n\t\t\treturn ChatRoom.findOne(subscription.rid);\n\t\t}\n\t}\n\n\troomName(roomData) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne({ rid: roomData._id }, { fields: { name: 1, fname: 1 } });\n\t\tif (!subscription) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name') && subscription.fname) {\n\t\t\treturn subscription.fname;\n\t\t}\n\n\t\treturn subscription.name;\n\t}\n\n\tsecondaryRoomName(roomData) {\n\t\tif (RocketChat.settings.get('UI_Use_Real_Name')) {\n\t\t\tconst subscription = RocketChat.models.Subscriptions.findOne({ rid: roomData._id }, { fields: { name: 1 } });\n\t\t\treturn subscription && subscription.name;\n\t\t}\n\t}\n\n\tcondition() {\n\t\tconst groupByType = RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && RocketChat.authz.hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);\n\t}\n\n\tgetUserStatus(roomId) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne({ rid: roomId });\n\t\tif (subscription == null) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn Session.get(`user_${ subscription.name }_status`);\n\t}\n\n\tgetDisplayName(room) {\n\t\treturn room.usernames.join(' x ');\n\t}\n\n\tallowRoomSettingChange(room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.NAME:\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tcase RoomSettingsEnum.DESCRIPTION:\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\tcase RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE:\n\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\treturn false;\n\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\treturn RocketChat.settings.get('E2E_Enable') === true;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn true;\n\t}\n\n\tuserDetailShowAll(/* room */) {\n\t\treturn false;\n\t}\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Private_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Private_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n\n\t/**\n\t * Returns details to use on notifications\n\t *\n\t * @param {object} room\n\t * @param {object} user\n\t * @param {string} notificationMessage\n\t * @return {object} Notification details\n\t */\n\tgetNotificationDetails(room, user, notificationMessage) {\n\t\tif (!Meteor.isServer) {\n\t\t\treturn {};\n\t\t}\n\n\t\tconst title = RocketChat.settings.get('UI_Use_Real_Name') ? user.name : `@${ user.username }`;\n\t\tconst text = notificationMessage;\n\n\t\treturn { title, text };\n\t}\n}\n","import { RoomTypeConfig } from '../RoomTypeConfig';\n\nexport class FavoriteRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'f',\n\t\t\torder: 20,\n\t\t\theader: 'favorite',\n\t\t\ticon: 'star',\n\t\t\tlabel: 'Favorites',\n\t\t});\n\t}\n\tcondition() {\n\t\treturn RocketChat.settings.get('Favorite_Rooms') && RocketChat.getUserPreference(Meteor.userId(), 'sidebarShowFavorites');\n\t}\n}\n","import { ConversationRoomType } from './conversation';\nimport { DirectMessageRoomType } from './direct';\nimport { FavoriteRoomType } from './favorite';\nimport { PrivateRoomType } from './private';\nimport { PublicRoomType } from './public';\nimport { UnreadRoomType } from './unread';\n\nexport {\n\tConversationRoomType,\n\tDirectMessageRoomType,\n\tFavoriteRoomType,\n\tPrivateRoomType,\n\tPublicRoomType,\n\tUnreadRoomType,\n};\n","/* globals openRoom */\nimport { RoomSettingsEnum, RoomTypeConfig, RoomTypeRouteConfig, UiTextContext } from '../RoomTypeConfig';\n\nexport class PrivateRoomRoute extends RoomTypeRouteConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tname: 'group',\n\t\t\tpath: '/group/:name',\n\t\t});\n\t}\n\n\taction(params) {\n\t\treturn openRoom('p', params.name);\n\t}\n}\n\nexport class PrivateRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'p',\n\t\t\torder: 40,\n\t\t\ticon: 'lock',\n\t\t\tlabel: 'Private_Groups',\n\t\t\troute: new PrivateRoomRoute(),\n\t\t});\n\t}\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'p',\n\t\t\tname: identifier,\n\t\t};\n\n\t\treturn ChatRoom.findOne(query);\n\t}\n\n\troomName(roomData) {\n\t\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\treturn roomData.fname || roomData.name;\n\t\t}\n\n\t\treturn roomData.name;\n\t}\n\n\tcondition() {\n\t\tconst groupByType = RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && RocketChat.authz.hasAllPermission('view-p-room');\n\t}\n\n\tisGroupChat() {\n\t\treturn true;\n\t}\n\n\tcanAddUser(room) {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['add-user-to-any-p-room', 'add-user-to-joined-room'], room._id);\n\t}\n\n\tallowRoomSettingChange(room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\treturn false;\n\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\treturn room.broadcast;\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\treturn !room.broadcast;\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\treturn !room.broadcast && room.ro;\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\treturn RocketChat.settings.get('E2E_Enable') === true;\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn true;\n\t}\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Group_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Group_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n}\n","/* globals openRoom */\nimport { RoomTypeConfig, RoomTypeRouteConfig, RoomSettingsEnum, UiTextContext } from '../RoomTypeConfig';\n\nexport class PublicRoomRoute extends RoomTypeRouteConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tname: 'channel',\n\t\t\tpath: '/channel/:name',\n\t\t});\n\t}\n\n\taction(params) {\n\t\treturn openRoom('c', params.name);\n\t}\n}\n\nexport class PublicRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'c',\n\t\t\torder: 30,\n\t\t\ticon: 'hashtag',\n\t\t\tlabel: 'Channels',\n\t\t\troute: new PublicRoomRoute(),\n\t\t});\n\t}\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'c',\n\t\t\tname: identifier,\n\t\t};\n\t\treturn ChatRoom.findOne(query);\n\t}\n\n\troomName(roomData) {\n\t\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\treturn roomData.fname || roomData.name;\n\t\t}\n\t\treturn roomData.name;\n\t}\n\n\tcondition() {\n\t\tconst groupByType = RocketChat.getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\treturn groupByType && (RocketChat.authz.hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || RocketChat.settings.get('Accounts_AllowAnonymousRead') === true);\n\t}\n\n\tshowJoinLink(roomId) {\n\t\treturn !!ChatRoom.findOne({ _id: roomId, t: 'c' });\n\t}\n\n\tincludeInRoomSearch() {\n\t\treturn true;\n\t}\n\n\tisGroupChat() {\n\t\treturn true;\n\t}\n\n\tcanAddUser(room) {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['add-user-to-any-c-room', 'add-user-to-joined-room'], room._id);\n\t}\n\n\tenableMembersListProfile() {\n\t\treturn true;\n\t}\n\n\tallowRoomSettingChange(room, setting) {\n\t\tswitch (setting) {\n\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\treturn room.broadcast;\n\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\treturn !room.broadcast;\n\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\treturn !room.broadcast && room.ro;\n\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\tdefault:\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tgetUiText(context) {\n\t\tswitch (context) {\n\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\treturn 'Hide_Room_Warning';\n\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\treturn 'Leave_Room_Warning';\n\t\t\tdefault:\n\t\t\t\treturn '';\n\t\t}\n\t}\n}\n","import { RoomTypeConfig } from '../RoomTypeConfig';\n\nexport class UnreadRoomType extends RoomTypeConfig {\n\tconstructor() {\n\t\tsuper({\n\t\t\tidentifier: 'unread',\n\t\t\torder: 10,\n\t\t\tlabel: 'Unread',\n\t\t});\n\n\t\tthis.unread = true;\n\t}\n\n\tcondition() {\n\t\treturn RocketChat.getUserPreference(Meteor.userId(), 'sidebarShowUnread');\n\t}\n}\n","import s from 'underscore.string';\n\nRocketChat.getURL = (path, { cdn = true, full = false } = {}) => {\n\tconst cdnPrefix = s.rtrim(s.trim(RocketChat.settings.get('CDN_PREFIX') || ''), '/');\n\tconst pathPrefix = s.rtrim(s.trim(__meteor_runtime_config__.ROOT_URL_PATH_PREFIX || ''), '/');\n\n\tlet basePath;\n\n\tconst finalPath = s.ltrim(s.trim(path), '/');\n\n\tif (cdn && cdnPrefix !== '') {\n\t\tbasePath = cdnPrefix + pathPrefix;\n\t} else if (full || Meteor.isCordova) {\n\t\treturn Meteor.absoluteUrl(finalPath);\n\t} else {\n\t\tbasePath = pathPrefix;\n\t}\n\n\treturn `${ basePath }/${ finalPath }`;\n};\n","import _ from 'underscore';\n\n/*\n* Callback hooks provide an easy way to add extra steps to common operations.\n* @namespace RocketChat.callbacks\n*/\n\nRocketChat.callbacks = {};\n\nif (Meteor.isServer) {\n\tRocketChat.callbacks.showTime = true;\n\tRocketChat.callbacks.showTotalTime = true;\n} else {\n\tRocketChat.callbacks.showTime = false;\n\tRocketChat.callbacks.showTotalTime = false;\n}\n\n\n/*\n* Callback priorities\n*/\n\nRocketChat.callbacks.priority = {\n\tHIGH: -1000,\n\tMEDIUM: 0,\n\tLOW: 1000,\n};\n\nconst getHooks = (hookName) => RocketChat.callbacks[hookName] || [];\n\n/*\n* Add a callback function to a hook\n* @param {String} hook - The name of the hook\n* @param {Function} callback - The callback function\n*/\n\nRocketChat.callbacks.add = function(hook, callback, priority, id = Random.id()) {\n\tif (!_.isNumber(priority)) {\n\t\tpriority = RocketChat.callbacks.priority.MEDIUM;\n\t}\n\tcallback.priority = priority;\n\tcallback.id = id;\n\tRocketChat.callbacks[hook] = getHooks(hook);\n\n\tif (RocketChat.callbacks.showTime === true) {\n\t\tconst err = new Error;\n\t\tcallback.stack = err.stack;\n\t}\n\n\tif (RocketChat.callbacks[hook].find((cb) => cb.id === callback.id)) {\n\t\treturn;\n\t}\n\tRocketChat.callbacks[hook].push(callback);\n\tRocketChat.callbacks[hook] = _.sortBy(RocketChat.callbacks[hook], function(callback) {\n\t\treturn callback.priority || RocketChat.callbacks.priority.MEDIUM;\n\t});\n};\n\n\n/*\n* Remove a callback from a hook\n* @param {string} hook - The name of the hook\n* @param {string} id - The callback's id\n*/\n\nRocketChat.callbacks.remove = function(hook, id) {\n\tRocketChat.callbacks[hook] = getHooks(hook).filter((callback) => callback.id !== id);\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n* @returns {Object} Returns the item after it's been through all the callbacks for this hook\n*/\n\nRocketChat.callbacks.run = function(hook, item, constant) {\n\tconst callbacks = RocketChat.callbacks[hook];\n\tif (!callbacks || !callbacks.length) {\n\t\treturn item;\n\t}\n\n\tlet rocketchatHooksEnd;\n\tif (Meteor.isServer) {\n\t\trocketchatHooksEnd = RocketChat.metrics.rocketchatHooks.startTimer({ hook, callbacks_length: callbacks.length });\n\t}\n\n\tlet totalTime = 0;\n\tconst result = callbacks.reduce(function(result, callback) {\n\t\tlet rocketchatCallbacksEnd;\n\t\tif (Meteor.isServer) {\n\t\t\trocketchatCallbacksEnd = RocketChat.metrics.rocketchatCallbacks.startTimer({ hook, callback: callback.id });\n\t\t}\n\t\tconst time = RocketChat.callbacks.showTime === true || RocketChat.callbacks.showTotalTime === true ? Date.now() : 0;\n\n\t\tconst callbackResult = callback(result, constant);\n\n\t\tif (RocketChat.callbacks.showTime === true || RocketChat.callbacks.showTotalTime === true) {\n\t\t\tconst currentTime = Date.now() - time;\n\t\t\ttotalTime += currentTime;\n\t\t\tif (RocketChat.callbacks.showTime === true) {\n\t\t\t\tif (Meteor.isServer) {\n\t\t\t\t\trocketchatCallbacksEnd();\n\t\t\t\t\tRocketChat.statsTracker.timing('callbacks.time', currentTime, [`hook:${ hook }`, `callback:${ callback.id }`]);\n\t\t\t\t} else {\n\t\t\t\t\tlet stack = callback.stack && typeof callback.stack.split === 'function' && callback.stack.split('\\n');\n\t\t\t\t\tstack = stack && stack[2] && (stack[2].match(/\\(.+\\)/) || [])[0];\n\t\t\t\t\tconsole.log(String(currentTime), hook, callback.id, stack);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn (typeof callbackResult === 'undefined') ? result : callbackResult;\n\t}, item);\n\n\tif (Meteor.isServer) {\n\t\trocketchatHooksEnd();\n\t}\n\n\tif (RocketChat.callbacks.showTotalTime === true) {\n\t\tif (Meteor.isServer) {\n\t\t\tRocketChat.statsTracker.timing('callbacks.totalTime', totalTime, [`hook:${ hook }`]);\n\t\t} else {\n\t\t\tconsole.log(`${ hook }:`, totalTime);\n\t\t}\n\t}\n\n\treturn result;\n\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item, in async mode (only works on server)\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n*/\n\nRocketChat.callbacks.runAsync = function(hook, item, constant) {\n\tconst callbacks = RocketChat.callbacks[hook];\n\tif (Meteor.isServer && callbacks && callbacks.length) {\n\t\tMeteor.defer(function() {\n\t\t\tcallbacks.forEach((callback) => callback(item, constant));\n\t\t});\n\t}\n\treturn item;\n};\n","import _ from 'underscore';\n\nRocketChat.fileUploadMediaWhiteList = function() {\n\tconst mediaTypeWhiteList = RocketChat.settings.get('FileUpload_MediaTypeWhiteList');\n\n\tif (!mediaTypeWhiteList || mediaTypeWhiteList === '*') {\n\t\treturn;\n\t}\n\treturn _.map(mediaTypeWhiteList.split(','), function(item) {\n\t\treturn item.trim();\n\t});\n};\n\nRocketChat.fileUploadIsValidContentType = function(type) {\n\tconst list = RocketChat.fileUploadMediaWhiteList();\n\tif (!list) {\n\t\treturn true;\n\t}\n\n\tif (!type) {\n\t\treturn false;\n\t}\n\n\tif (_.contains(list, type)) {\n\t\treturn true;\n\t} else {\n\t\tconst wildCardGlob = '/*';\n\t\tconst wildcards = _.filter(list, function(item) {\n\t\t\treturn item.indexOf(wildCardGlob) > 0;\n\t\t});\n\t\tif (_.contains(wildcards, type.replace(/(\\/.*)$/, wildCardGlob))) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n","const colors = ['#F44336', '#E91E63', '#9C27B0', '#673AB7', '#3F51B5', '#2196F3', '#03A9F4', '#00BCD4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFC107', '#FF9800', '#FF5722', '#795548', '#9E9E9E', '#607D8B'];\n\nRocketChat.getAvatarColor = function(name) {\n\treturn colors[name.length % colors.length];\n};\n","RocketChat.getDefaultSubscriptionPref = function _getDefaultSubscriptionPref(userPref) {\n\tconst subscription = {};\n\n\tconst {\n\t\tdesktopNotifications,\n\t\tmobileNotifications,\n\t\temailNotificationMode,\n\t\thighlights,\n\t} = (userPref.settings && userPref.settings.preferences) || {};\n\n\tif (Array.isArray(highlights) && highlights.length) {\n\t\tsubscription.userHighlights = highlights;\n\t}\n\n\tif (desktopNotifications && desktopNotifications !== 'default') {\n\t\tsubscription.desktopNotifications = desktopNotifications;\n\t\tsubscription.desktopPrefOrigin = 'user';\n\t}\n\n\tif (mobileNotifications && mobileNotifications !== 'default') {\n\t\tsubscription.mobilePushNotifications = mobileNotifications;\n\t\tsubscription.mobilePrefOrigin = 'user';\n\t}\n\n\tif (emailNotificationMode && emailNotificationMode !== 'default') {\n\t\tsubscription.emailNotifications = emailNotificationMode;\n\t\tsubscription.emailPrefOrigin = 'user';\n\t}\n\n\treturn subscription;\n};\n","import s from 'underscore.string';\n\nRocketChat.getValidRoomName = function getValidRoomName(displayName, rid = '') {\n\tlet slugifiedName = displayName;\n\n\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\tconst room = RocketChat.models.Rooms.findOneByDisplayName(displayName);\n\t\tif (room && room._id !== rid) {\n\t\t\tif (room.archived) {\n\t\t\t\tthrow new Meteor.Error('error-archived-duplicate-name', `There's an archived channel with name ${ displayName }`, { function: 'RocketChat.getValidRoomName', channel_name: displayName });\n\t\t\t} else {\n\t\t\t\tthrow new Meteor.Error('error-duplicate-channel-name', `A channel with name '${ displayName }' exists`, { function: 'RocketChat.getValidRoomName', channel_name: displayName });\n\t\t\t}\n\t\t}\n\t\tslugifiedName = s.slugify(displayName);\n\t}\n\n\tlet nameValidation;\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (error) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\tif (!nameValidation.test(slugifiedName)) {\n\t\tthrow new Meteor.Error('error-invalid-room-name', `${ slugifiedName } is not a valid room name.`, {\n\t\t\tfunction: 'RocketChat.getValidRoomName',\n\t\t\tchannel_name: slugifiedName,\n\t\t});\n\t}\n\n\tconst room = RocketChat.models.Rooms.findOneByName(slugifiedName);\n\tif (room && room._id !== rid) {\n\t\tif (RocketChat.settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\tlet tmpName = slugifiedName;\n\t\t\tlet next = 0;\n\t\t\twhile (RocketChat.models.Rooms.findOneByNameAndNotId(tmpName, rid)) {\n\t\t\t\ttmpName = `${ slugifiedName }-${ ++next }`;\n\t\t\t}\n\t\t\tslugifiedName = tmpName;\n\t\t} else if (room.archived) {\n\t\t\tthrow new Meteor.Error('error-archived-duplicate-name', `There's an archived channel with name ${ slugifiedName }`, { function: 'RocketChat.getValidRoomName', channel_name: slugifiedName });\n\t\t} else {\n\t\t\tthrow new Meteor.Error('error-duplicate-channel-name', `A channel with name '${ slugifiedName }' exists`, { function: 'RocketChat.getValidRoomName', channel_name: slugifiedName });\n\t\t}\n\t}\n\n\treturn slugifiedName;\n};\n","import s from 'underscore.string';\n\nRocketChat.placeholders = {};\n\nRocketChat.placeholders.replace = function(str, data) {\n\tif (!str) {\n\t\treturn '';\n\t}\n\n\tstr = str.replace(/\\[Site_Name\\]/g, RocketChat.settings.get('Site_Name') || '');\n\tstr = str.replace(/\\[Site_URL\\]/g, RocketChat.settings.get('Site_Url') || '');\n\n\tif (data) {\n\t\tstr = str.replace(/\\[name\\]/g, data.name || '');\n\t\tstr = str.replace(/\\[fname\\]/g, s.strLeft(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[lname\\]/g, s.strRightBack(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[email\\]/g, data.email || '');\n\t\tstr = str.replace(/\\[password\\]/g, data.password || '');\n\t\tstr = str.replace(/\\[reason\\]/g, data.reason || '');\n\t\tstr = str.replace(/\\[User\\]/g, data.user || '');\n\t\tstr = str.replace(/\\[Room\\]/g, data.room || '');\n\n\t\tif (data.unsubscribe) {\n\t\t\tstr = str.replace(/\\[unsubscribe\\]/g, data.unsubscribe);\n\t\t}\n\t}\n\n\tstr = str.replace(/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g, '$1' + '<br>' + '$2');\n\n\n\treturn str;\n};\n","import _ from 'underscore';\n\n/*\n* Callback hooks provide an easy way to add extra steps to common operations.\n* @namespace RocketChat.promises\n*/\n\nRocketChat.promises = {};\n\n\n/*\n* Callback priorities\n*/\n\nRocketChat.promises.priority = {\n\tHIGH: -1000,\n\tMEDIUM: 0,\n\tLOW: 1000,\n};\n\nconst getHook = (hookName) => RocketChat.promises[hookName] || [];\n\n/*\n* Add a callback function to a hook\n* @param {String} hook - The name of the hook\n* @param {Function} callback - The callback function\n*/\n\nRocketChat.promises.add = function(hook, callback, p = RocketChat.promises.priority.MEDIUM, id) {\n\tcallback.priority = _.isNumber(p) ? p : RocketChat.promises.priority.MEDIUM;\n\tcallback.id = id || Random.id();\n\tRocketChat.promises[hook] = getHook(hook);\n\tif (RocketChat.promises[hook].find((cb) => cb.id === callback.id)) {\n\t\treturn;\n\t}\n\tRocketChat.promises[hook].push(callback);\n\tRocketChat.promises[hook] = _.sortBy(RocketChat.promises[hook], (callback) => callback.priority || RocketChat.promises.priority.MEDIUM);\n};\n\n\n/*\n* Remove a callback from a hook\n* @param {string} hook - The name of the hook\n* @param {string} id - The callback's id\n*/\n\nRocketChat.promises.remove = function(hook, id) {\n\tRocketChat.promises[hook] = getHook(hook).filter((callback) => callback.id !== id);\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n* @returns {Object} Returns the item after it's been through all the callbacks for this hook\n*/\n\nRocketChat.promises.run = function(hook, item, constant) {\n\tconst callbacks = RocketChat.promises[hook];\n\tif (callbacks == null || callbacks.length === 0) {\n\t\treturn Promise.resolve(item);\n\t}\n\treturn callbacks.reduce((previousPromise, callback) => previousPromise.then((result) => callback(result, constant)), Promise.resolve(item));\n};\n\n\n/*\n* Successively run all of a hook's callbacks on an item, in async mode (only works on server)\n* @param {String} hook - The name of the hook\n* @param {Object} item - The post, comment, modifier, etc. on which to run the callbacks\n* @param {Object} [constant] - An optional constant that will be passed along to each callback\n*/\n\nRocketChat.promises.runAsync = function(hook, item, constant) {\n\tconst callbacks = RocketChat.promises[hook];\n\tif (!Meteor.isServer || callbacks == null || callbacks.length === 0) {\n\t\treturn item;\n\t}\n\tMeteor.defer(() => callbacks.forEach((callback) => callback(item, constant)));\n};\n","/* globals roomExit */\nimport { RoomTypeConfig } from './RoomTypeConfig';\n\nexport class RoomTypesCommon {\n\tconstructor() {\n\t\tthis.roomTypes = {};\n\t\tthis.roomTypesOrder = [];\n\t\tthis.mainOrder = 1;\n\t}\n\n\t/**\n\t * Adds a room type to the application.\n\t *\n\t * @param {RoomTypeConfig} roomConfig\n\t * @returns {void}\n\t */\n\tadd(roomConfig) {\n\t\tif (!(roomConfig instanceof RoomTypeConfig)) {\n\t\t\tthrow new Error('Invalid Room Configuration object, it must extend \"RoomTypeConfig\"');\n\t\t}\n\n\t\tif (this.roomTypes[roomConfig.identifier]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!roomConfig.order) {\n\t\t\troomConfig.order = this.mainOrder + 10;\n\t\t\tthis.mainOrder += 10;\n\t\t}\n\n\t\tthis.roomTypesOrder.push({\n\t\t\tidentifier: roomConfig.identifier,\n\t\t\torder: roomConfig.order,\n\t\t});\n\n\t\tthis.roomTypes[roomConfig.identifier] = roomConfig;\n\n\t\tif (roomConfig.route && roomConfig.route.path && roomConfig.route.name && roomConfig.route.action) {\n\t\t\tconst routeConfig = {\n\t\t\t\tname: roomConfig.route.name,\n\t\t\t\taction: roomConfig.route.action,\n\t\t\t};\n\n\t\t\tif (Meteor.isClient) {\n\t\t\t\trouteConfig.triggersExit = [roomExit];\n\t\t\t}\n\n\t\t\treturn FlowRouter.route(roomConfig.route.path, routeConfig);\n\t\t}\n\t}\n\n\thasCustomLink(roomType) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link != null;\n\t}\n\n\t/**\n\t * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))\n\t * @param {object} subData the user's subscription data\n\t */\n\tgetRouteLink(roomType, subData) {\n\t\tif (!this.roomTypes[roomType]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet routeData = {};\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].route && this.roomTypes[roomType].route.link) {\n\t\t\trouteData = this.roomTypes[roomType].route.link(subData);\n\t\t} else if (subData && subData.name) {\n\t\t\trouteData = {\n\t\t\t\tname: subData.name,\n\t\t\t};\n\t\t}\n\n\t\treturn FlowRouter.path(this.roomTypes[roomType].route.name, routeData);\n\t}\n\n\t/**\n\t * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))\n\t * @param {RoomTypeConfig} roomConfig room's type configuration\n\t */\n\tgetConfig(roomType) {\n\t\treturn this.roomTypes[roomType];\n\t}\n\n\tgetURL(...args) {\n\t\tconst path = this.getRouteLink(...args);\n\t\tif (!path) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Meteor.absoluteUrl(path.replace(/^\\//, ''));\n\t}\n}\n","RocketChat.slashCommands = {\n\tcommands: {},\n};\n\nRocketChat.slashCommands.add = function _addingSlashCommand(command, callback, options = {}, result, providesPreview = false, previewer, previewCallback) {\n\tRocketChat.slashCommands.commands[command] = {\n\t\tcommand,\n\t\tcallback,\n\t\tparams: options.params,\n\t\tdescription: options.description,\n\t\tpermission: options.permission,\n\t\tclientOnly: options.clientOnly || false,\n\t\tresult,\n\t\tprovidesPreview,\n\t\tpreviewer,\n\t\tpreviewCallback,\n\t};\n};\n\nRocketChat.slashCommands.run = function _runningSlashCommand(command, params, message) {\n\tif (RocketChat.slashCommands.commands[command] && typeof RocketChat.slashCommands.commands[command].callback === 'function') {\n\t\tif (!message || !message.rid) {\n\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t}\n\n\t\treturn RocketChat.slashCommands.commands[command].callback(command, params, message);\n\t}\n};\n\nRocketChat.slashCommands.getPreviews = function _gettingSlashCommandPreviews(command, params, message) {\n\tif (RocketChat.slashCommands.commands[command] && typeof RocketChat.slashCommands.commands[command].previewer === 'function') {\n\t\tif (!message || !message.rid) {\n\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t}\n\n\t\t// { i18nTitle, items: [{ id, type, value }] }\n\t\tconst previewInfo = RocketChat.slashCommands.commands[command].previewer(command, params, message);\n\n\t\tif (typeof previewInfo !== 'object' || !Array.isArray(previewInfo.items) || previewInfo.items.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// A limit of ten results, to save time and bandwidth\n\t\tif (previewInfo.items.length >= 10) {\n\t\t\tpreviewInfo.items = previewInfo.items.slice(0, 10);\n\t\t}\n\n\t\treturn previewInfo;\n\t}\n};\n\nRocketChat.slashCommands.executePreview = function _executeSlashCommandPreview(command, params, message, preview) {\n\tif (RocketChat.slashCommands.commands[command] && typeof RocketChat.slashCommands.commands[command].previewCallback === 'function') {\n\t\tif (!message || !message.rid) {\n\t\t\tthrow new Meteor.Error('invalid-command-usage', 'Executing a command requires at least a message with a room id.');\n\t\t}\n\n\t\t// { id, type, value }\n\t\tif (!preview.id || !preview.type || !preview.value) {\n\t\t\tthrow new Meteor.Error('error-invalid-preview', 'Preview Item must have an id, type, and value.');\n\t\t}\n\n\t\treturn RocketChat.slashCommands.commands[command].previewCallback(command, params, message, preview);\n\t}\n};\n\nMeteor.methods({\n\tslashCommand(command) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'slashCommand',\n\t\t\t});\n\t\t}\n\n\t\tif (!command || !command.cmd || !RocketChat.slashCommands.commands[command.cmd]) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\treturn RocketChat.slashCommands.run(command.cmd, command.params, command.msg);\n\t},\n});\n","import s from 'underscore.string';\n\nRocketChat.Message = {\n\tparse(msg, language) {\n\t\tconst messageType = RocketChat.MessageTypes.getType(msg);\n\t\tif (messageType) {\n\t\t\tif (messageType.render) {\n\t\t\t\treturn messageType.render(msg);\n\t\t\t} else if (messageType.template) {\n\t\t\t\t// Render message\n\t\t\t\treturn;\n\t\t\t} else if (messageType.message) {\n\t\t\t\tif (!language && typeof localStorage !== 'undefined') {\n\t\t\t\t\tlanguage = localStorage.getItem('userLanguage');\n\t\t\t\t}\n\t\t\t\tconst data = (typeof messageType.data === 'function' && messageType.data(msg)) || {};\n\t\t\t\treturn TAPi18n.__(messageType.message, data, language);\n\t\t\t}\n\t\t}\n\t\tif (msg.u && msg.u.username === RocketChat.settings.get('Chatops_Username')) {\n\t\t\tmsg.html = msg.msg;\n\t\t\treturn msg.html;\n\t\t}\n\t\tmsg.html = msg.msg;\n\t\tif (s.trim(msg.html) !== '') {\n\t\t\tmsg.html = s.escapeHTML(msg.html);\n\t\t}\n\t\tmsg.html = msg.html.replace(/\\n/gm, '<br/>');\n\t\treturn msg.html;\n\t},\n};\n","import GraphemeSplitter from 'grapheme-splitter';\n\nconst splitter = new GraphemeSplitter();\n\nexport const messageProperties = {\n\n\tlength: ((message) => splitter.countGraphemes(message)),\n\n\tmessageWithoutEmojiShortnames: ((message) => message.replace(/:\\w+:/gm, (match) => {\n\t\tif (RocketChat.emoji.list[match] !== undefined) {\n\t\t\treturn ' ';\n\t\t}\n\t\treturn match;\n\t})),\n};\n\n// check for tests\nif (typeof RocketChat !== 'undefined') {\n\tRocketChat.messageProperties = messageProperties;\n}\n","import EventEmitter from 'wolfy87-eventemitter';\n\nRocketChat.messageBox = new EventEmitter;\n\nRocketChat.messageBox.actions = new class {\n\tconstructor() {\n\t\tthis.actions = {};\n\t}\n\n\t/* Add a action to messagebox\n\t@param group\n\t@param label\n\t@param config\n\ticon: icon class\n\taction: action function\n\tcondition: condition to display the action\n\t*/\n\n\tadd(group, label, config) {\n\t\tif (!group && !label && !config) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.actions[group]) {\n\t\t\tthis.actions[group] = [];\n\t\t}\n\n\t\tconst actionExists = this.actions[group].find((action) => action.label === label);\n\n\t\tif (actionExists) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.actions[group].push({ ...config, label });\n\t}\n\tremove(group, expression) {\n\t\tif (!group || !this.actions[group]) {\n\t\t\treturn false;\n\t\t}\n\t\treturn (this.actions[group] = this.actions[group].filter((action) => expression.test(action.id)));\n\t}\n\tget(group) {\n\t\tif (!group) {\n\t\t\treturn Object.keys(this.actions).reduce((ret, key) => {\n\t\t\t\tconst actions = this.actions[key].filter((action) => !action.condition || action.condition());\n\t\t\t\tif (actions.length) {\n\t\t\t\t\tret[key] = actions;\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t}, {});\n\t\t}\n\n\t\treturn this.actions[group].filter((action) => !action.condition || action.condition());\n\t}\n\n\tgetById(id) {\n\t\tconst messageActions = this.actions;\n\t\tlet actions = [];\n\t\tObject.keys(messageActions).forEach(function(action) {\n\t\t\tactions = actions.concat(messageActions[action]);\n\t\t});\n\n\t\treturn actions.filter((action) => action.id === id);\n\t}\n};\n","RocketChat.MessageTypes = new class {\n\tconstructor() {\n\t\tthis.types = {};\n\t}\n\n\tregisterType(options) {\n\t\treturn this.types[options.id] = options;\n\t}\n\n\tgetType(message) {\n\t\treturn this.types[message && message.t];\n\t}\n\n\tisSystemMessage(message) {\n\t\tconst type = this.types[message && message.t];\n\t\treturn type && type.system;\n\t}\n\n};\n\nMeteor.startup(function() {\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'r',\n\t\tsystem: true,\n\t\tmessage: 'Room_name_changed',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\troom_name: message.msg,\n\t\t\t\tuser_by: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'au',\n\t\tsystem: true,\n\t\tmessage: 'User_added_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_added: message.msg,\n\t\t\t\tuser_by: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'ru',\n\t\tsystem: true,\n\t\tmessage: 'User_removed_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_removed: message.msg,\n\t\t\t\tuser_by: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'ul',\n\t\tsystem: true,\n\t\tmessage: 'User_left',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_left: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'uj',\n\t\tsystem: true,\n\t\tmessage: 'User_joined_channel',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'wm',\n\t\tsystem: true,\n\t\tmessage: 'Welcome',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'rm',\n\t\tsystem: true,\n\t\tmessage: 'Message_removed',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'rtc',\n\t\trender(message) {\n\t\t\treturn RocketChat.callbacks.run('renderRtcMessage', message);\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'user-muted',\n\t\tsystem: true,\n\t\tmessage: 'User_muted_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_muted: message.msg,\n\t\t\t\tuser_by: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'user-unmuted',\n\t\tsystem: true,\n\t\tmessage: 'User_unmuted_by',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tuser_unmuted: message.msg,\n\t\t\t\tuser_by: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'subscription-role-added',\n\t\tsystem: true,\n\t\tmessage: '__username__was_set__role__by__user_by_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.msg,\n\t\t\t\trole: message.role,\n\t\t\t\tuser_by: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'subscription-role-removed',\n\t\tsystem: true,\n\t\tmessage: '__username__is_no_longer__role__defined_by__user_by_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.msg,\n\t\t\t\trole: message.role,\n\t\t\t\tuser_by: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room-archived',\n\t\tsystem: true,\n\t\tmessage: 'This_room_has_been_archived_by__username_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n\tRocketChat.MessageTypes.registerType({\n\t\tid: 'room-unarchived',\n\t\tsystem: true,\n\t\tmessage: 'This_room_has_been_unarchived_by__username_',\n\t\tdata(message) {\n\t\t\treturn {\n\t\t\t\tusername: message.u.username,\n\t\t\t};\n\t\t},\n\t});\n});\n","let logger;\n\nif (Meteor.isServer) {\n\tlogger = new Logger('TemplateVarHandler', {});\n}\n\nRocketChat.templateVarHandler = function(variable, object) {\n\n\tconst templateRegex = /#{([\\w\\-]+)}/gi;\n\tlet match = templateRegex.exec(variable);\n\tlet tmpVariable = variable;\n\n\tif (match == null) {\n\t\tif (!object.hasOwnProperty(variable)) {\n\t\t\tlogger && logger.debug(`user does not have attribute: ${ variable }`);\n\t\t\treturn;\n\t\t}\n\t\treturn object[variable];\n\t} else {\n\t\tlogger && logger.debug('template found. replacing values');\n\t\twhile (match != null) {\n\t\t\tconst tmplVar = match[0];\n\t\t\tconst tmplAttrName = match[1];\n\n\t\t\tif (!object.hasOwnProperty(tmplAttrName)) {\n\t\t\t\tlogger && logger.debug(`user does not have attribute: ${ tmplAttrName }`);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst attrVal = object[tmplAttrName];\n\t\t\tlogger && logger.debug(`replacing template var: ${ tmplVar } with value: ${ attrVal }`);\n\t\t\ttmpVariable = tmpVariable.replace(tmplVar, attrVal);\n\t\t\tmatch = templateRegex.exec(variable);\n\t\t}\n\t\treturn tmpVariable;\n\t}\n};\n","RocketChat.getUserNotificationPreference = function _getUserNotificationPreference(user, pref) {\n\tif (typeof user === 'string') {\n\t\tuser = RocketChat.models.Users.findOneById(user);\n\t}\n\n\tlet preferenceKey;\n\tswitch (pref) {\n\t\tcase 'desktop': preferenceKey = 'desktopNotifications'; break;\n\t\tcase 'mobile': preferenceKey = 'mobileNotifications'; break;\n\t\tcase 'email': preferenceKey = 'emailNotificationMode'; break;\n\t}\n\n\tif (user && user.settings && user.settings.preferences && user.settings.preferences[preferenceKey] !== 'default') {\n\t\treturn {\n\t\t\tvalue: user.settings.preferences[preferenceKey],\n\t\t\torigin: 'user',\n\t\t};\n\t}\n\tconst serverValue = RocketChat.settings.get(`Accounts_Default_User_Preferences_${ preferenceKey }`);\n\tif (serverValue) {\n\t\treturn {\n\t\t\tvalue: serverValue,\n\t\t\torigin: 'server',\n\t\t};\n\t}\n\n\treturn null;\n};\n","/**\n * Tries to retrieve the user preference falling back to a default system\n * value or to a default value if it is passed as argument\n*/\nRocketChat.getUserPreference = function(user, key, defaultValue = undefined) {\n\tlet preference;\n\tif (typeof user === typeof '') {\n\t\tuser = RocketChat.models.Users.findOne(user, { fields: { [`settings.preferences.${ key }`]: 1 } });\n\t}\n\tif (user && user.settings && user.settings.preferences &&\n\t\tuser.settings.preferences.hasOwnProperty(key)) {\n\t\tpreference = user.settings.preferences[key];\n\t} else if (defaultValue === undefined) {\n\t\tpreference = RocketChat.settings.get(`Accounts_Default_User_Preferences_${ key }`);\n\t}\n\n\treturn preference !== undefined ? preference : defaultValue;\n};\n","/* globals WebAppInternals */\nRocketChat.settings.get('Site_Url', function(key, value) {\n\tif (value == null || value.trim() === '') {\n\t\treturn;\n\t}\n\tlet host = value.replace(/\\/$/, '');\n\t// let prefix = '';\n\tconst match = value.match(/([^\\/]+\\/{2}[^\\/]+)(\\/.+)/);\n\tif (match != null) {\n\t\thost = match[1];\n\t\t// prefix = match[2].replace(/\\/$/, '');\n\t}\n\t__meteor_runtime_config__.ROOT_URL = value;\n\n\tif (Meteor.absoluteUrl.defaultOptions && Meteor.absoluteUrl.defaultOptions.rootUrl) {\n\t\tMeteor.absoluteUrl.defaultOptions.rootUrl = value;\n\t}\n\tif (Meteor.isServer) {\n\t\tRocketChat.hostname = host.replace(/^https?:\\/\\//, '');\n\t\tprocess.env.MOBILE_ROOT_URL = host;\n\t\tprocess.env.MOBILE_DDP_URL = host;\n\t\tif (typeof WebAppInternals !== 'undefined' && WebAppInternals.generateBoilerplate) {\n\t\t\treturn WebAppInternals.generateBoilerplate();\n\t\t}\n\t}\n});\n","/* global InstanceStatus */\nimport _ from 'underscore';\n\nconst logger = new Logger('Meteor', {\n\tmethods: {\n\t\tmethod: {\n\t\t\ttype: 'debug',\n\t\t},\n\t\tpublish: {\n\t\t\ttype: 'debug',\n\t\t},\n\t},\n});\n\nlet Log_Trace_Methods;\nlet Log_Trace_Subscriptions;\nRocketChat.settings.get('Log_Trace_Methods', (key, value) => Log_Trace_Methods = value);\nRocketChat.settings.get('Log_Trace_Subscriptions', (key, value) => Log_Trace_Subscriptions = value);\n\nlet Log_Trace_Methods_Filter;\nlet Log_Trace_Subscriptions_Filter;\nRocketChat.settings.get('Log_Trace_Methods_Filter', (key, value) => Log_Trace_Methods_Filter = value ? new RegExp(value) : undefined);\nRocketChat.settings.get('Log_Trace_Subscriptions_Filter', (key, value) => Log_Trace_Subscriptions_Filter = value ? new RegExp(value) : undefined);\n\nconst traceConnection = (enable, filter, prefix, name, connection, userId) => {\n\tif (!enable) {\n\t\treturn;\n\t}\n\n\tif (filter && !filter.test(name)) {\n\t\treturn;\n\t}\n\n\tif (connection) {\n\t\tconsole.log(name, {\n\t\t\tid: connection.id,\n\t\t\tclientAddress: connection.clientAddress,\n\t\t\thttpHeaders: connection.httpHeaders,\n\t\t\tuserId,\n\t\t});\n\t} else {\n\t\tconsole.log(name, 'no-connection');\n\t}\n};\n\nconst wrapMethods = function(name, originalHandler, methodsMap) {\n\tmethodsMap[name] = function(...originalArgs) {\n\t\ttraceConnection(Log_Trace_Methods, Log_Trace_Methods_Filter, 'method', name, this.connection, this.userId);\n\t\tconst end = RocketChat.metrics.meteorMethods.startTimer({\n\t\t\tmethod: name,\n\t\t\thas_connection: this.connection != null,\n\t\t\thas_user: this.userId != null,\n\t\t});\n\t\tconst args = name === 'ufsWrite' ? Array.prototype.slice.call(originalArgs, 1) : originalArgs;\n\t\tlogger.method(name, '-> userId:', Meteor.userId(), ', arguments: ', args);\n\n\t\tthis.unblock();\n\t\tconst result = originalHandler.apply(this, originalArgs);\n\t\tend();\n\t\treturn result;\n\t};\n};\n\nconst originalMeteorMethods = Meteor.methods;\n\nMeteor.methods = function(methodMap) {\n\t_.each(methodMap, function(handler, name) {\n\t\twrapMethods(name, handler, methodMap);\n\t});\n\toriginalMeteorMethods(methodMap);\n};\n\nconst originalMeteorPublish = Meteor.publish;\n\nMeteor.publish = function(name, func) {\n\treturn originalMeteorPublish(name, function(...args) {\n\t\ttraceConnection(Log_Trace_Subscriptions, Log_Trace_Subscriptions_Filter, 'subscription', name, this.connection, this.userId);\n\t\tlogger.publish(name, '-> userId:', this.userId, ', arguments: ', args);\n\t\tconst end = RocketChat.metrics.meteorSubscriptions.startTimer({ subscription: name });\n\n\t\tconst originalReady = this.ready;\n\t\tthis.ready = function() {\n\t\t\tend();\n\t\t\treturn originalReady.apply(this, args);\n\t\t};\n\n\t\treturn func.apply(this, args);\n\t});\n};\n\nWebApp.rawConnectHandlers.use(function(req, res, next) {\n\tres.setHeader('X-Instance-ID', InstanceStatus.id());\n\treturn next();\n});\n","import bugsnag from 'bugsnag';\n\nRocketChat.bugsnag = bugsnag;\n\nRocketChat.settings.get('Bugsnag_api_key', (key, value) => {\n\tif (value) {\n\t\tbugsnag.register(value);\n\t}\n});\n\nconst notify = function(message, stack) {\n\tif (typeof stack === 'string') {\n\t\tmessage += ` ${ stack }`;\n\t}\n\tlet options = {};\n\tif (RocketChat.Info) {\n\t\toptions = { app: { version: RocketChat.Info.version, info: RocketChat.Info } };\n\t}\n\tconst error = new Error(message);\n\terror.stack = stack;\n\tRocketChat.bugsnag.notify(error, options);\n};\n\nprocess.on('uncaughtException', Meteor.bindEnvironment((error) => {\n\tnotify(error.message, error.stack);\n\tthrow error;\n}));\n\nconst originalMeteorDebug = Meteor._debug;\nMeteor._debug = function(...args) {\n\tnotify(...args);\n\treturn originalMeteorDebug(...args);\n};\n","import client from 'prom-client';\nimport connect from 'connect';\nimport http from 'http';\nimport _ from 'underscore';\n\nRocketChat.promclient = client;\nclient.collectDefaultMetrics();\n\nRocketChat.metrics = {};\n\n// one sample metrics only - a counter\n\nRocketChat.metrics.meteorMethods = new client.Summary({\n\tname: 'rocketchat_meteor_methods',\n\thelp: 'summary of meteor methods count and time',\n\tlabelNames: ['method', 'has_connection', 'has_user'],\n});\n\nRocketChat.metrics.rocketchatCallbacks = new client.Summary({\n\tname: 'rocketchat_callbacks',\n\thelp: 'summary of rocketchat callbacks count and time',\n\tlabelNames: ['hook', 'callback'],\n});\n\nRocketChat.metrics.rocketchatHooks = new client.Summary({\n\tname: 'rocketchat_hooks',\n\thelp: 'summary of rocketchat hooks count and time',\n\tlabelNames: ['hook', 'callbacks_length'],\n});\n\nRocketChat.metrics.rocketchatRestApi = new client.Summary({\n\tname: 'rocketchat_rest_api',\n\thelp: 'summary of rocketchat rest api count and time',\n\tlabelNames: ['method', 'entrypoint', 'user_agent', 'status', 'version'],\n});\n\nRocketChat.metrics.meteorSubscriptions = new client.Summary({\n\tname: 'rocketchat_meteor_subscriptions',\n\thelp: 'summary of meteor subscriptions count and time',\n\tlabelNames: ['subscription'],\n});\n\nRocketChat.metrics.messagesSent = new client.Counter({ name: 'rocketchat_message_sent', help: 'cumulated number of messages sent' });\nRocketChat.metrics.notificationsSent = new client.Counter({ name: 'rocketchat_notification_sent', labelNames: ['notification_type'], help: 'cumulated number of notifications sent' });\n\nRocketChat.metrics.ddpSessions = new client.Gauge({ name: 'rocketchat_ddp_sessions_count', help: 'number of open ddp sessions' });\nRocketChat.metrics.ddpAthenticatedSessions = new client.Gauge({ name: 'rocketchat_ddp_sessions_auth', help: 'number of authenticated open ddp sessions' });\nRocketChat.metrics.ddpConnectedUsers = new client.Gauge({ name: 'rocketchat_ddp_connected_users', help: 'number of unique connected users' });\n\nRocketChat.metrics.version = new client.Gauge({ name: 'rocketchat_version', labelNames: ['version'], help: 'Rocket.Chat version' });\nRocketChat.metrics.migration = new client.Gauge({ name: 'rocketchat_migration', help: 'migration versoin' });\nRocketChat.metrics.instanceCount = new client.Gauge({ name: 'rocketchat_instance_count', help: 'instances running' });\nRocketChat.metrics.oplogEnabled = new client.Gauge({ name: 'rocketchat_oplog_enabled', labelNames: ['enabled'], help: 'oplog enabled' });\n\n// User statistics\nRocketChat.metrics.totalUsers = new client.Gauge({ name: 'rocketchat_users_total', help: 'total of users' });\nRocketChat.metrics.activeUsers = new client.Gauge({ name: 'rocketchat_users_active', help: 'total of active users' });\nRocketChat.metrics.nonActiveUsers = new client.Gauge({ name: 'rocketchat_users_non_active', help: 'total of non active users' });\nRocketChat.metrics.onlineUsers = new client.Gauge({ name: 'rocketchat_users_online', help: 'total of users online' });\nRocketChat.metrics.awayUsers = new client.Gauge({ name: 'rocketchat_users_away', help: 'total of users away' });\nRocketChat.metrics.offlineUsers = new client.Gauge({ name: 'rocketchat_users_offline', help: 'total of users offline' });\n\n// Room statistics\nRocketChat.metrics.totalRooms = new client.Gauge({ name: 'rocketchat_rooms_total', help: 'total of rooms' });\nRocketChat.metrics.totalChannels = new client.Gauge({ name: 'rocketchat_channels_total', help: 'total of public rooms/channels' });\nRocketChat.metrics.totalPrivateGroups = new client.Gauge({ name: 'rocketchat_private_groups_total', help: 'total of private rooms' });\nRocketChat.metrics.totalDirect = new client.Gauge({ name: 'rocketchat_direct_total', help: 'total of direct rooms' });\nRocketChat.metrics.totalLivechat = new client.Gauge({ name: 'rocketchat_livechat_total', help: 'total of livechat rooms' });\n\n// Message statistics\nRocketChat.metrics.totalMessages = new client.Gauge({ name: 'rocketchat_messages_total', help: 'total of messages' });\nRocketChat.metrics.totalChannelMessages = new client.Gauge({ name: 'rocketchat_channel_messages_total', help: 'total of messages in public rooms' });\nRocketChat.metrics.totalPrivateGroupMessages = new client.Gauge({ name: 'rocketchat_private_group_messages_total', help: 'total of messages in private rooms' });\nRocketChat.metrics.totalDirectMessages = new client.Gauge({ name: 'rocketchat_direct_messages_total', help: 'total of messages in direct rooms' });\nRocketChat.metrics.totalLivechatMessages = new client.Gauge({ name: 'rocketchat_livechat_messages_total', help: 'total of messages in livechat rooms' });\n\nclient.register.setDefaultLabels({\n\tuniqueId: RocketChat.settings.get('uniqueID'),\n\tsiteUrl: RocketChat.settings.get('Site_Url'),\n});\n\nconst setPrometheusData = () => {\n\tconst date = new Date();\n\n\tclient.register.setDefaultLabels({\n\t\tunique_id: RocketChat.settings.get('uniqueID'),\n\t\tsite_url: RocketChat.settings.get('Site_Url'),\n\t\tversion: RocketChat.Info.version,\n\t});\n\n\tconst sessions = Object.values(Meteor.server.sessions);\n\tconst authenticatedSessions = sessions.filter((s) => s.userId);\n\tRocketChat.metrics.ddpSessions.set(sessions.length, date);\n\tRocketChat.metrics.ddpAthenticatedSessions.set(authenticatedSessions.length, date);\n\tRocketChat.metrics.ddpConnectedUsers.set(_.unique(authenticatedSessions.map((s) => s.userId)).length, date);\n\n\tif (!RocketChat.models.Statistics) {\n\t\treturn;\n\t}\n\n\tconst statistics = RocketChat.models.Statistics.findLast();\n\tif (!statistics) {\n\t\treturn;\n\t}\n\n\tRocketChat.metrics.version.set({ version: statistics.version }, 1, date);\n\tRocketChat.metrics.migration.set(RocketChat.Migrations._getControl().version, date);\n\tRocketChat.metrics.instanceCount.set(statistics.instanceCount, date);\n\tRocketChat.metrics.oplogEnabled.set({ enabled: statistics.oplogEnabled }, 1, date);\n\n\t// User statistics\n\tRocketChat.metrics.totalUsers.set(statistics.totalUsers, date);\n\tRocketChat.metrics.activeUsers.set(statistics.activeUsers, date);\n\tRocketChat.metrics.nonActiveUsers.set(statistics.nonActiveUsers, date);\n\tRocketChat.metrics.onlineUsers.set(statistics.onlineUsers, date);\n\tRocketChat.metrics.awayUsers.set(statistics.awayUsers, date);\n\tRocketChat.metrics.offlineUsers.set(statistics.offlineUsers, date);\n\n\t// Room statistics\n\tRocketChat.metrics.totalRooms.set(statistics.totalRooms, date);\n\tRocketChat.metrics.totalChannels.set(statistics.totalChannels, date);\n\tRocketChat.metrics.totalPrivateGroups.set(statistics.totalPrivateGroups, date);\n\tRocketChat.metrics.totalDirect.set(statistics.totalDirect, date);\n\tRocketChat.metrics.totalLivechat.set(statistics.totalLivechat, date);\n\n\t// Message statistics\n\tRocketChat.metrics.totalMessages.set(statistics.totalMessages, date);\n\tRocketChat.metrics.totalChannelMessages.set(statistics.totalChannelMessages, date);\n\tRocketChat.metrics.totalPrivateGroupMessages.set(statistics.totalPrivateGroupMessages, date);\n\tRocketChat.metrics.totalDirectMessages.set(statistics.totalDirectMessages, date);\n\tRocketChat.metrics.totalLivechatMessages.set(statistics.totalLivechatMessages, date);\n};\n\nconst app = connect();\n\n// const compression = require('compression');\n// app.use(compression());\n\napp.use('/metrics', (req, res) => {\n\tres.setHeader('Content-Type', 'text/plain');\n\tres.end(RocketChat.promclient.register.metrics());\n});\n\napp.use('/', (req, res) => {\n\tconst html = `<html>\n\t\t<head>\n\t\t\t<title>Rocket.Chat Prometheus Exporter</title>\n\t\t</head>\n\t\t<body>\n\t\t\t<h1>Rocket.Chat Prometheus Exporter</h1>\n\t\t\t<p><a href=\"/metrics\">Metrics</a></p>\n\t\t</body>\n\t</html>`;\n\n\tres.write(html);\n\tres.end();\n});\n\nconst server = http.createServer(app);\n\nlet timer;\nconst updatePrometheusConfig = () => {\n\tconst port = RocketChat.settings.get('Prometheus_Port');\n\tconst enabled = RocketChat.settings.get('Prometheus_Enabled');\n\n\tif (port == null || enabled == null) {\n\t\treturn;\n\t}\n\n\tif (enabled === true) {\n\t\tserver.listen({\n\t\t\tport,\n\t\t\thost: process.env.BIND_IP || '0.0.0.0',\n\t\t});\n\t\ttimer = Meteor.setInterval(setPrometheusData, 5000);\n\t} else {\n\t\tserver.close();\n\t\tMeteor.clearInterval(timer);\n\t}\n};\n\nRocketChat.settings.get('Prometheus_Enabled', updatePrometheusConfig);\nRocketChat.settings.get('Prometheus_Port', updatePrometheusConfig);\n","/* globals RateLimiter */\nimport _ from 'underscore';\n\nRocketChat.RateLimiter = new class {\n\tlimitFunction(fn, numRequests, timeInterval, matchers) {\n\t\tif (process.env.TEST_MODE === 'true') {\n\t\t\treturn fn;\n\t\t}\n\t\tconst rateLimiter = new RateLimiter();\n\t\trateLimiter.addRule(matchers, numRequests, timeInterval);\n\t\treturn function(...args) {\n\t\t\tconst match = {};\n\t\t\t_.each(matchers, function(matcher, key) {\n\t\t\t\treturn match[key] = args[key];\n\t\t\t});\n\t\t\trateLimiter.increment(match);\n\t\t\tconst rateLimitResult = rateLimiter.check(match);\n\t\t\tif (rateLimitResult.allowed) {\n\t\t\t\treturn fn.apply(null, args);\n\t\t\t} else {\n\t\t\t\tthrow new Meteor.Error('error-too-many-requests', `Error, too many requests. Please slow down. You must wait ${ Math.ceil(rateLimitResult.timeToReset / 1000) } seconds before trying again.`, {\n\t\t\t\t\ttimeToReset: rateLimitResult.timeToReset,\n\t\t\t\t\tseconds: Math.ceil(rateLimitResult.timeToReset / 1000),\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tlimitMethod(methodName, numRequests, timeInterval, matchers) {\n\t\tif (process.env.TEST_MODE === 'true') {\n\t\t\treturn;\n\t\t}\n\t\tconst match = {\n\t\t\ttype: 'method',\n\t\t\tname: methodName,\n\t\t};\n\t\t_.each(matchers, function(matcher, key) {\n\t\t\treturn match[key] = matchers[key];\n\t\t});\n\t\treturn DDPRateLimiter.addRule(match, numRequests, timeInterval);\n\t}\n\n};\n","/* globals LoggerManager */\nRocketChat.settings.get('Log_Package', function(key, value) {\n\treturn LoggerManager.showPackage = value;\n});\n\nRocketChat.settings.get('Log_File', function(key, value) {\n\treturn LoggerManager.showFileAndLine = value;\n});\n\nRocketChat.settings.get('Log_Level', function(key, value) {\n\tif (value != null) {\n\t\tLoggerManager.logLevel = parseInt(value);\n\t\tMeteor.setTimeout(() => LoggerManager.enable(true), 200);\n\t}\n});\n","/* globals Push */\nclass PushNotification {\n\tgetNotificationId(roomId) {\n\t\tconst serverId = RocketChat.settings.get('uniqueID');\n\t\treturn this.hash(`${ serverId }|${ roomId }`); // hash\n\t}\n\n\thash(str) {\n\t\tlet hash = 0;\n\t\tlet i = str.length;\n\n\t\twhile (i) {\n\t\t\thash = ((hash << 5) - hash) + str.charCodeAt(--i);\n\t\t\thash = hash & hash; // Convert to 32bit integer\n\t\t}\n\t\treturn hash;\n\t}\n\n\tsend({ roomName, roomId, username, message, usersTo, payload, badge = 1, category }) {\n\t\tlet title;\n\t\tif (roomName && roomName !== '') {\n\t\t\ttitle = `${ roomName }`;\n\t\t\tmessage = `${ username }: ${ message }`;\n\t\t} else {\n\t\t\ttitle = `${ username }`;\n\t\t}\n\t\tconst config = {\n\t\t\tfrom: 'push',\n\t\t\tbadge,\n\t\t\tsound: 'default',\n\t\t\ttitle,\n\t\t\ttext: message,\n\t\t\tpayload,\n\t\t\tquery: usersTo,\n\t\t\tnotId: this.getNotificationId(roomId),\n\t\t\tgcm: {\n\t\t\t\tstyle: 'inbox',\n\t\t\t\tsummaryText: '%n% new messages',\n\t\t\t\timage: RocketChat.Assets.getURL('Assets_favicon_192'),\n\t\t\t},\n\t\t};\n\n\t\tif (category !== '') {\n\t\t\tconfig.apn = {\n\t\t\t\tcategory,\n\t\t\t};\n\t\t}\n\n\t\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'mobile' });\n\t\treturn Push.send(config);\n\t}\n}\n\nRocketChat.PushNotification = new PushNotification();\n","RocketChat.emailDomainDefaultBlackList = [\n\t'0-mail.com',\n\t'0815.ru',\n\t'0815.su',\n\t'0clickemail.com',\n\t'0wnd.net',\n\t'0wnd.org',\n\t'10mail.org',\n\t'10minut.com.pl',\n\t'10minutemail.co.za',\n\t'10minutemail.com',\n\t'10minutemail.de',\n\t'123-m.com',\n\t'1chuan.com',\n\t'1fsdfdsfsdf.tk',\n\t'1pad.de',\n\t'1zhuan.com',\n\t'20email.eu',\n\t'20mail.eu',\n\t'20mail.it',\n\t'20minutemail.com',\n\t'21cn.com',\n\t'2fdgdfgdfgdf.tk',\n\t'2prong.com',\n\t'30minutemail.com',\n\t'33mail.com',\n\t'3d-painting.com',\n\t'3trtretgfrfe.tk',\n\t'4gfdsgfdgfd.tk',\n\t'4warding.com',\n\t'4warding.net',\n\t'4warding.org',\n\t'5ghgfhfghfgh.tk',\n\t'60minutemail.com',\n\t'675hosting.com',\n\t'675hosting.net',\n\t'675hosting.org',\n\t'6hjgjhgkilkj.tk',\n\t'6ip.us',\n\t'6paq.com',\n\t'6url.com',\n\t'75hosting.com',\n\t'75hosting.net',\n\t'75hosting.org',\n\t'7days-printing.com',\n\t'7tags.com',\n\t'99experts.com',\n\t'9ox.net',\n\t'a-bc.net',\n\t'a45.in',\n\t'abcmail.email',\n\t'abyssmail.com',\n\t'acentri.com',\n\t'advantimo.com',\n\t'afrobacon.com',\n\t'ag.us.to',\n\t'agedmail.com',\n\t'ahk.jp',\n\t'ajaxapp.net',\n\t'alivance.com',\n\t'ama-trade.de',\n\t'amail.com',\n\t'amilegit.com',\n\t'amiri.net',\n\t'amiriindustries.com',\n\t'anappthat.com',\n\t'ano-mail.net',\n\t'anonbox.net',\n\t'anonmails.de',\n\t'anonymail.dk',\n\t'anonymbox.com',\n\t'antichef.com',\n\t'antichef.net',\n\t'antireg.ru',\n\t'antispam.de',\n\t'antispammail.de',\n\t'appixie.com',\n\t'armyspy.com',\n\t'artman-conception.com',\n\t'aver.com',\n\t'azmeil.tk',\n\t'baxomale.ht.cx',\n\t'beddly.com',\n\t'beefmilk.com',\n\t'bigprofessor.so',\n\t'bigstring.com',\n\t'binkmail.com',\n\t'bio-muesli.net',\n\t'blogmyway.org',\n\t'bobmail.info',\n\t'bofthew.com',\n\t'bootybay.de',\n\t'boun.cr',\n\t'bouncr.com',\n\t'boxformail.in',\n\t'breakthru.com',\n\t'brefmail.com',\n\t'brennendesreich.de',\n\t'broadbandninja.com',\n\t'bsnow.net',\n\t'bspamfree.org',\n\t'bu.mintemail.com',\n\t'buffemail.com',\n\t'bugmenot.com',\n\t'bumpymail.com',\n\t'bund.us',\n\t'bundes-li.ga',\n\t'burnthespam.info',\n\t'burstmail.info',\n\t'buymoreplays.com',\n\t'buyusedlibrarybooks.org',\n\t'byom.de',\n\t'c2.hu',\n\t'cachedot.net',\n\t'card.zp.ua',\n\t'casualdx.com',\n\t'cbair.com',\n\t'cek.pm',\n\t'cellurl.com',\n\t'centermail.com',\n\t'centermail.net',\n\t'chammy.info',\n\t'cheatmail.de',\n\t'childsavetrust.org',\n\t'chogmail.com',\n\t'choicemail1.com',\n\t'chong-mail.com',\n\t'chong-mail.net',\n\t'chong-mail.org',\n\t'clixser.com',\n\t'cmail.com',\n\t'cmail.net',\n\t'cmail.org',\n\t'coldemail.info',\n\t'consumerriot.com',\n\t'cool.fr.nf',\n\t'correo.blogos.net',\n\t'cosmorph.com',\n\t'courriel.fr.nf',\n\t'courrieltemporaire.com',\n\t'crapmail.org',\n\t'crazymailing.com',\n\t'cubiclink.com',\n\t'curryworld.de',\n\t'cust.in',\n\t'cuvox.de',\n\t'd3p.dk',\n\t'dacoolest.com',\n\t'daintly.com',\n\t'dandikmail.com',\n\t'dayrep.com',\n\t'dbunker.com',\n\t'dcemail.com',\n\t'deadaddress.com',\n\t'deadspam.com',\n\t'deagot.com',\n\t'dealja.com',\n\t'delikkt.de',\n\t'despam.it',\n\t'despammed.com',\n\t'devnullmail.com',\n\t'dfgh.net',\n\t'digitalsanctuary.com',\n\t'dingbone.com',\n\t'discard.email',\n\t'discardmail.com',\n\t'discardmail.de',\n\t'disposableaddress.com',\n\t'disposableemailaddresses.com',\n\t'disposableemailaddresses.emailmiser.com',\n\t'disposableinbox.com',\n\t'dispose.it',\n\t'disposeamail.com',\n\t'disposemail.com',\n\t'dispostable.com',\n\t'dlemail.ru',\n\t'dm.w3internet.co.uk',\n\t'dm.w3internet.co.ukexample.com',\n\t'dodgeit.com',\n\t'dodgit.com',\n\t'dodgit.org',\n\t'doiea.com',\n\t'domozmail.com',\n\t'donemail.ru',\n\t'dontreg.com',\n\t'dontsendmespam.de',\n\t'dotmsg.com',\n\t'drdrb.com',\n\t'drdrb.net',\n\t'droplar.com',\n\t'dropmail.me',\n\t'dt.com',\n\t'duam.net',\n\t'dudmail.com',\n\t'dump-email.info',\n\t'dumpandjunk.com',\n\t'dumpmail.de',\n\t'dumpyemail.com',\n\t'duskmail.com',\n\t'e-mail.com',\n\t'e-mail.org',\n\t'e4ward.com',\n\t'easytrashmail.com',\n\t'einmalmail.de',\n\t'einrot.com',\n\t'einrot.de',\n\t'eintagsmail.de',\n\t'email60.com',\n\t'emaildienst.de',\n\t'emailgo.de',\n\t'emailias.com',\n\t'emailigo.de',\n\t'emailinfive.com',\n\t'emaillime.com',\n\t'emailmiser.com',\n\t'emailproxsy.com',\n\t'emailsensei.com',\n\t'emailtemporanea.com',\n\t'emailtemporanea.net',\n\t'emailtemporar.ro',\n\t'emailtemporario.com.br',\n\t'emailthe.net',\n\t'emailtmp.com',\n\t'emailto.de',\n\t'emailwarden.com',\n\t'emailx.at.hm',\n\t'emailxfer.com',\n\t'emeil.in',\n\t'emeil.ir',\n\t'emil.com',\n\t'emz.net',\n\t'enterto.com',\n\t'ephemail.net',\n\t'ero-tube.org',\n\t'etranquil.com',\n\t'etranquil.net',\n\t'etranquil.org',\n\t'evopo.com',\n\t'explodemail.com',\n\t'express.net.ua',\n\t'eyepaste.com',\n\t'fakeinbox.com',\n\t'fakeinformation.com',\n\t'fakemail.fr',\n\t'fakemailz.com',\n\t'fammix.com',\n\t'fansworldwide.de',\n\t'fantasymail.de',\n\t'fastacura.com',\n\t'fastchevy.com',\n\t'fastchrysler.com',\n\t'fastkawasaki.com',\n\t'fastmazda.com',\n\t'fastmitsubishi.com',\n\t'fastnissan.com',\n\t'fastsubaru.com',\n\t'fastsuzuki.com',\n\t'fasttoyota.com',\n\t'fastyamaha.com',\n\t'fatflap.com',\n\t'fdfdsfds.com',\n\t'fightallspam.com',\n\t'figjs.com',\n\t'fiifke.de',\n\t'filzmail.com',\n\t'fivemail.de',\n\t'fixmail.tk',\n\t'fizmail.com',\n\t'fleckens.hu',\n\t'flemail.ru',\n\t'flyspam.com',\n\t'footard.com',\n\t'forgetmail.com',\n\t'fr33mail.info',\n\t'frapmail.com',\n\t'freundin.ru',\n\t'friendlymail.co.uk',\n\t'front14.org',\n\t'fuckingduh.com',\n\t'fudgerub.com',\n\t'fux0ringduh.com',\n\t'fyii.de',\n\t'garliclife.com',\n\t'gehensiemirnichtaufdensack.de',\n\t'gelitik.in',\n\t'get1mail.com',\n\t'get2mail.fr',\n\t'getairmail.com',\n\t'getmails.eu',\n\t'getonemail.com',\n\t'getonemail.net',\n\t'ghosttexter.de',\n\t'giantmail.de',\n\t'girlsundertheinfluence.com',\n\t'gishpuppy.com',\n\t'gmial.com',\n\t'goemailgo.com',\n\t'gorillaswithdirtyarmpits.com',\n\t'gotmail.com',\n\t'gotmail.net',\n\t'gotmail.org',\n\t'gotti.otherinbox.com',\n\t'gowikibooks.com',\n\t'gowikicampus.com',\n\t'gowikicars.com',\n\t'gowikifilms.com',\n\t'gowikigames.com',\n\t'gowikimusic.com',\n\t'gowikimusic.great-host.in',\n\t'gowikinetwork.com',\n\t'gowikitravel.com',\n\t'gowikitv.com',\n\t'grandmamail.com',\n\t'grandmasmail.com',\n\t'great-host.in',\n\t'greensloth.com',\n\t'grr.la',\n\t'gsrv.co.uk',\n\t'guerillamail.biz',\n\t'guerillamail.com',\n\t'guerillamail.net',\n\t'guerillamail.org',\n\t'guerrillamail.biz',\n\t'guerrillamail.com',\n\t'guerrillamail.de',\n\t'guerrillamail.info',\n\t'guerrillamail.net',\n\t'guerrillamail.org',\n\t'guerrillamailblock.com',\n\t'gustr.com',\n\t'h.mintemail.com',\n\t'h8s.org',\n\t'hacccc.com',\n\t'haltospam.com',\n\t'harakirimail.com',\n\t'hartbot.de',\n\t'hat-geld.de',\n\t'hatespam.org',\n\t'hellodream.mobi',\n\t'herp.in',\n\t'hidemail.de',\n\t'hidzz.com',\n\t'hmamail.com',\n\t'hochsitze.com',\n\t'hopemail.biz',\n\t'hotpop.com',\n\t'hulapla.de',\n\t'iaoss.com',\n\t'ieatspam.eu',\n\t'ieatspam.info',\n\t'ieh-mail.de',\n\t'ihateyoualot.info',\n\t'iheartspam.org',\n\t'ikbenspamvrij.nl',\n\t'imails.info',\n\t'imgof.com',\n\t'imstations.com',\n\t'inbax.tk',\n\t'inbox.si',\n\t'inboxalias.com',\n\t'inboxclean.com',\n\t'inboxclean.org',\n\t'inboxproxy.com',\n\t'incognitomail.com',\n\t'incognitomail.net',\n\t'incognitomail.org',\n\t'infocom.zp.ua',\n\t'inoutmail.de',\n\t'inoutmail.eu',\n\t'inoutmail.info',\n\t'inoutmail.net',\n\t'insorg-mail.info',\n\t'instant-mail.de',\n\t'ip6.li',\n\t'ipoo.org',\n\t'irish2me.com',\n\t'iwi.net',\n\t'jamit.com.au',\n\t'jetable.com',\n\t'jetable.fr.nf',\n\t'jetable.net',\n\t'jetable.org',\n\t'jnxjn.com',\n\t'jourrapide.com',\n\t'jsrsolutions.com',\n\t'junk1e.com',\n\t'kasmail.com',\n\t'kaspop.com',\n\t'keepmymail.com',\n\t'killmail.com',\n\t'killmail.net',\n\t'kimsdisk.com',\n\t'kingsq.ga',\n\t'kir.ch.tc',\n\t'klassmaster.com',\n\t'klassmaster.net',\n\t'klzlk.com',\n\t'kook.ml',\n\t'koszmail.pl',\n\t'kulturbetrieb.info',\n\t'kurzepost.de',\n\t'l33r.eu',\n\t'lackmail.net',\n\t'lags.us',\n\t'lawlita.com',\n\t'lazyinbox.com',\n\t'letthemeatspam.com',\n\t'lhsdv.com',\n\t'lifebyfood.com',\n\t'link2mail.net',\n\t'litedrop.com',\n\t'loadby.us',\n\t'login-email.ml',\n\t'lol.ovpn.to',\n\t'lolfreak.net',\n\t'lookugly.com',\n\t'lopl.co.cc',\n\t'lortemail.dk',\n\t'lovemeleaveme.com',\n\t'lr78.com',\n\t'lroid.com',\n\t'lukop.dk',\n\t'm21.cc',\n\t'm4ilweb.info',\n\t'maboard.com',\n\t'mail-filter.com',\n\t'mail-temporaire.fr',\n\t'mail.by',\n\t'mail.mezimages.net',\n\t'mail.zp.ua',\n\t'mail114.net',\n\t'mail1a.de',\n\t'mail21.cc',\n\t'mail2rss.org',\n\t'mail333.com',\n\t'mail4trash.com',\n\t'mailbidon.com',\n\t'mailbiz.biz',\n\t'mailblocks.com',\n\t'mailbucket.org',\n\t'mailcat.biz',\n\t'mailcatch.com',\n\t'mailde.de',\n\t'mailde.info',\n\t'maildrop.cc',\n\t'maildx.com',\n\t'maileater.com',\n\t'mailed.ro',\n\t'maileimer.de',\n\t'mailexpire.com',\n\t'mailfa.tk',\n\t'mailforspam.com',\n\t'mailfreeonline.com',\n\t'mailfs.com',\n\t'mailguard.me',\n\t'mailimate.com',\n\t'mailin8r.com',\n\t'mailinater.com',\n\t'mailinator.com',\n\t'mailinator.net',\n\t'mailinator.org',\n\t'mailinator.us',\n\t'mailinator2.com',\n\t'mailincubator.com',\n\t'mailismagic.com',\n\t'mailmate.com',\n\t'mailme.ir',\n\t'mailme.lv',\n\t'mailme24.com',\n\t'mailmetrash.com',\n\t'mailmetrash.comilzilla.org',\n\t'mailmoat.com',\n\t'mailms.com',\n\t'mailnator.com',\n\t'mailnesia.com',\n\t'mailnull.com',\n\t'mailorg.org',\n\t'mailpick.biz',\n\t'mailproxsy.com',\n\t'mailquack.com',\n\t'mailrock.biz',\n\t'mailscrap.com',\n\t'mailshell.com',\n\t'mailsiphon.com',\n\t'mailslapping.com',\n\t'mailslite.com',\n\t'mailtemp.info',\n\t'mailtome.de',\n\t'mailtothis.com',\n\t'mailtrash.net',\n\t'mailtv.net',\n\t'mailtv.tv',\n\t'mailzilla.com',\n\t'mailzilla.org',\n\t'mailzilla.orgmbx.cc',\n\t'makemetheking.com',\n\t'manifestgenerator.com',\n\t'manybrain.com',\n\t'mbx.cc',\n\t'mega.zik.dj',\n\t'meinspamschutz.de',\n\t'meltmail.com',\n\t'messagebeamer.de',\n\t'mezimages.net',\n\t'mierdamail.com',\n\t'migumail.com',\n\t'ministry-of-silly-walks.de',\n\t'mintemail.com',\n\t'misterpinball.de',\n\t'mjukglass.nu',\n\t'mmailinater.com',\n\t'moakt.com',\n\t'mobi.web.id',\n\t'mobileninja.co.uk',\n\t'moburl.com',\n\t'mohmal.com',\n\t'moncourrier.fr.nf',\n\t'monemail.fr.nf',\n\t'monmail.fr.nf',\n\t'monumentmail.com',\n\t'msa.minsmail.com',\n\t'mt2009.com',\n\t'mt2014.com',\n\t'mx0.wwwnew.eu',\n\t'my10minutemail.com',\n\t'mycard.net.ua',\n\t'mycleaninbox.net',\n\t'myemailboxy.com',\n\t'mymail-in.net',\n\t'mymailoasis.com',\n\t'mynetstore.de',\n\t'mypacks.net',\n\t'mypartyclip.de',\n\t'myphantomemail.com',\n\t'mysamp.de',\n\t'myspaceinc.com',\n\t'myspaceinc.net',\n\t'myspaceinc.org',\n\t'myspacepimpedup.com',\n\t'myspamless.com',\n\t'mytemp.email',\n\t'mytempemail.com',\n\t'mytempmail.com',\n\t'mytrashmail.com',\n\t'nabuma.com',\n\t'neomailbox.com',\n\t'nepwk.com',\n\t'nervmich.net',\n\t'nervtmich.net',\n\t'netmails.com',\n\t'netmails.net',\n\t'netzidiot.de',\n\t'neverbox.com',\n\t'nice-4u.com',\n\t'nincsmail.com',\n\t'nincsmail.hu',\n\t'nnh.com',\n\t'no-spam.ws',\n\t'noblepioneer.com',\n\t'nobulk.com',\n\t'noclickemail.com',\n\t'nogmailspam.info',\n\t'nomail.pw',\n\t'nomail.xl.cx',\n\t'nomail2me.com',\n\t'nomorespamemails.com',\n\t'nonspam.eu',\n\t'nonspammer.de',\n\t'noref.in',\n\t'nospam.ze.tc',\n\t'nospam4.us',\n\t'nospamfor.us',\n\t'nospammail.net',\n\t'nospamthanks.info',\n\t'notmailinator.com',\n\t'notsharingmy.info',\n\t'nowhere.org',\n\t'nowmymail.com',\n\t'nurfuerspam.de',\n\t'nus.edu.sg',\n\t'nwldx.com',\n\t'objectmail.com',\n\t'obobbo.com',\n\t'odaymail.com',\n\t'odnorazovoe.ru',\n\t'one-time.email',\n\t'oneoffemail.com',\n\t'oneoffmail.com',\n\t'one2mail.info',\n\t'onewaymail.com',\n\t'onlatedotcom.info',\n\t'online.ms',\n\t'oopi.org',\n\t'opayq.com',\n\t'ordinaryamerican.net',\n\t'otherinbox.codupmyspace.com',\n\t'otherinbox.com',\n\t'ourklips.com',\n\t'outlawspam.com',\n\t'ovpn.to',\n\t'owlpic.com',\n\t'pancakemail.com',\n\t'paplease.com',\n\t'pcusers.otherinbox.com',\n\t'pepbot.com',\n\t'pfui.ru',\n\t'pimpedupmyspace.com',\n\t'pjjkp.com',\n\t'plexolan.de',\n\t'poczta.onet.pl',\n\t'politikerclub.de',\n\t'pooae.com',\n\t'poofy.org',\n\t'pookmail.com',\n\t'privacy.net',\n\t'privatdemail.net',\n\t'privy-mail.com',\n\t'privymail.de',\n\t'proxymail.eu',\n\t'prtnx.com',\n\t'prtz.eu',\n\t'punkass.com',\n\t'putthisinyourspamdatabase.com',\n\t'pwrby.com',\n\t'quickinbox.com',\n\t'quickmail.nl',\n\t'rcpt.at',\n\t'reallymymail.com',\n\t'realtyalerts.ca',\n\t'recode.me',\n\t'recursor.net',\n\t'recyclemail.dk',\n\t'regbypass.com',\n\t'regbypass.comsafe-mail.net',\n\t'rejectmail.com',\n\t'reliable-mail.com',\n\t'rhyta.com',\n\t'rklips.com',\n\t'rmqkr.net',\n\t'royal.net',\n\t'rppkn.com',\n\t'rtrtr.com',\n\t's0ny.net',\n\t'safe-mail.net',\n\t'safersignup.de',\n\t'safetymail.info',\n\t'safetypost.de',\n\t'sandelf.de',\n\t'saynotospams.com',\n\t'schafmail.de',\n\t'schrott-email.de',\n\t'secretemail.de',\n\t'secure-mail.biz',\n\t'selfdestructingmail.com',\n\t'selfdestructingmail.org',\n\t'sendspamhere.com',\n\t'sendspamhere.com',\n\t'senseless-entertainment.com',\n\t'services391.com',\n\t'sharedmailbox.org',\n\t'sharklasers.com',\n\t'shieldedmail.com',\n\t'shieldemail.com',\n\t'shiftmail.com',\n\t'shitmail.me',\n\t'shitmail.org',\n\t'shitware.nl',\n\t'shmeriously.com',\n\t'shortmail.net',\n\t'shotmail.ru',\n\t'showslow.de',\n\t'sibmail.com',\n\t'sinnlos-mail.de',\n\t'siteposter.net',\n\t'skeefmail.com',\n\t'slapsfromlastnight.com',\n\t'slaskpost.se',\n\t'slipry.net',\n\t'slopsbox.com',\n\t'slushmail.com',\n\t'smashmail.de',\n\t'smellfear.com',\n\t'smellrear.com',\n\t'snakemail.com',\n\t'sneakemail.com',\n\t'sneakmail.de',\n\t'snkmail.com',\n\t'sofimail.com',\n\t'sofort-mail.de',\n\t'softpls.asia',\n\t'sogetthis.com',\n\t'sohu.com',\n\t'solvemail.info',\n\t'soodonims.com',\n\t'spa.com',\n\t'spaereplease.com',\n\t'spam.la',\n\t'spam.su',\n\t'spam4.me',\n\t'spamail.de',\n\t'spamarrest.com',\n\t'spamavert.com',\n\t'spambob.com',\n\t'spambob.net',\n\t'spambob.org',\n\t'spambog.com',\n\t'spambog.de',\n\t'spambog.net',\n\t'spambog.ru',\n\t'spambox.info',\n\t'spambox.irishspringrealty.com',\n\t'spambox.us',\n\t'spamcannon.com',\n\t'spamcannon.net',\n\t'spamcero.com',\n\t'spamcon.org',\n\t'spamcorptastic.com',\n\t'spamcowboy.com',\n\t'spamcowboy.net',\n\t'spamcowboy.org',\n\t'spamday.com',\n\t'spamex.com',\n\t'spamfree.eu',\n\t'spamfree24.com',\n\t'spamfree24.de',\n\t'spamfree24.eu',\n\t'spamfree24.info',\n\t'spamfree24.net',\n\t'spamfree24.org',\n\t'spamgoes.in',\n\t'spamgourmet.com',\n\t'spamgourmet.net',\n\t'spamgourmet.org',\n\t'spamherelots.com',\n\t'spamhereplease.com',\n\t'spamhole.com',\n\t'spamify.com',\n\t'spaminator.de',\n\t'spamkill.info',\n\t'spaml.com',\n\t'spaml.de',\n\t'spammotel.com',\n\t'spamobox.com',\n\t'spamoff.de',\n\t'spamsalad.in',\n\t'spamslicer.com',\n\t'spamspot.com',\n\t'spamstack.net',\n\t'spamthis.co.uk',\n\t'spamthisplease.com',\n\t'spamtrail.com',\n\t'spamtroll.net',\n\t'speed.1s.fr',\n\t'spikio.com',\n\t'spoofmail.de',\n\t'squizzy.de',\n\t'ssoia.com',\n\t'startkeys.com',\n\t'stinkefinger.net',\n\t'stop-my-spam.com',\n\t'stuffmail.de',\n\t'super-auswahl.de',\n\t'supergreatmail.com',\n\t'supermailer.jp',\n\t'superrito.com',\n\t'superstachel.de',\n\t'suremail.info',\n\t'svk.jp',\n\t'sweetxxx.de',\n\t'tagyourself.com',\n\t'talkinator.com',\n\t'tapchicuoihoi.com',\n\t'teewars.org',\n\t'teleosaurs.xyz',\n\t'teleworm.com',\n\t'teleworm.us',\n\t'temp-mail.org',\n\t'temp-mail.ru',\n\t'temp.emeraldwebmail.com',\n\t'temp.headstrong.de',\n\t'tempalias.com',\n\t'tempe-mail.com',\n\t'tempemail.biz',\n\t'tempemail.co.za',\n\t'tempemail.com',\n\t'tempemail.net',\n\t'tempemail.net',\n\t'tempinbox.co.uk',\n\t'tempinbox.com',\n\t'tempmail.eu',\n\t'tempmail.it',\n\t'tempmail2.com',\n\t'tempmaildemo.com',\n\t'tempmailer.com',\n\t'tempmailer.de',\n\t'tempomail.fr',\n\t'temporarily.de',\n\t'temporarioemail.com.br',\n\t'temporaryemail.net',\n\t'temporaryemail.us',\n\t'temporaryforwarding.com',\n\t'temporaryinbox.com',\n\t'temporarymailaddress.com',\n\t'tempsky.com',\n\t'tempthe.net',\n\t'tempymail.com',\n\t'thanksnospam.info',\n\t'thankyou2010.com',\n\t'thc.st',\n\t'thecloudindex.com',\n\t'thelimestones.com',\n\t'thisisnotmyrealemail.com',\n\t'thismail.net',\n\t'thrma.com',\n\t'throwawayemailaddress.com',\n\t'tilien.com',\n\t'tittbit.in',\n\t'tizi.com',\n\t'tmail.ws',\n\t'tmailinator.com',\n\t'toiea.com',\n\t'toomail.biz',\n\t'topranklist.de',\n\t'tradermail.info',\n\t'trash-amil.com',\n\t'trash-mail.at',\n\t'trash-mail.com',\n\t'trash-mail.de',\n\t'trash2009.com',\n\t'trash2010.com',\n\t'trash2011.com',\n\t'trashdevil.com',\n\t'trashdevil.de',\n\t'trashemail.de',\n\t'trashmail.at',\n\t'trashmail.com',\n\t'trashmail.de',\n\t'trashmail.me',\n\t'trashmail.net',\n\t'trashmail.org',\n\t'trashmail.ws',\n\t'trashmailer.com',\n\t'trashymail.com',\n\t'trashymail.net',\n\t'trbvm.com',\n\t'trbvn.com',\n\t'trialmail.de',\n\t'trillianpro.com',\n\t'tryalert.com',\n\t'turual.com',\n\t'twinmail.de',\n\t'twoweirdtricks.com',\n\t'tyldd.com',\n\t'uggsrock.com',\n\t'umail.net',\n\t'upliftnow.com',\n\t'uplipht.com',\n\t'uroid.com',\n\t'us.af',\n\t'username.e4ward.com',\n\t'venompen.com',\n\t'veryrealemail.com',\n\t'vidchart.com',\n\t'viditag.com',\n\t'viewcastmedia.com',\n\t'viewcastmedia.net',\n\t'viewcastmedia.org',\n\t'viewcastmediae',\n\t'viralplays.com',\n\t'vkcode.ru',\n\t'vomoto.com',\n\t'vpn.st',\n\t'vsimcard.com',\n\t'vubby.com',\n\t'walala.org',\n\t'walkmail.net',\n\t'walkmail.ru',\n\t'wasteland.rfc822.org',\n\t'webemail.me',\n\t'webm4il.info',\n\t'webuser.in',\n\t'wee.my',\n\t'weg-werf-email.de',\n\t'wegwerf-email-addressen.de',\n\t'wegwerf-emails.de',\n\t'wegwerfadresse.de',\n\t'wegwerfemail.com',\n\t'wegwerfemail.de',\n\t'wegwerfmail.de',\n\t'wegwerfmail.info',\n\t'wegwerfmail.net',\n\t'wegwerfmail.org',\n\t'wetrainbayarea.com',\n\t'wetrainbayarea.org',\n\t'wh4f.org',\n\t'whatiaas.com',\n\t'whatpaas.com',\n\t'whatsaas.com',\n\t'whopy.com',\n\t'whtjddn.33mail.com',\n\t'whyspam.me',\n\t'wilemail.com',\n\t'willhackforfood.biz',\n\t'willselfdestruct.com',\n\t'winemaven.info',\n\t'wronghead.com',\n\t'wuzup.net',\n\t'wuzupmail.net',\n\t'www.e4ward.com',\n\t'www.gishpuppy.com',\n\t'www.mailinator.com',\n\t'wwwnew.eu',\n\t'x.ip6.li',\n\t'xagloo.com',\n\t'xemaps.com',\n\t'xents.com',\n\t'xmaily.com',\n\t'xoxy.net',\n\t'xyzfree.net',\n\t'yapped.net',\n\t'yeah.net',\n\t'yep.it',\n\t'yogamaven.com',\n\t'yomail.info',\n\t'yopmail.com',\n\t'yopmail.fr',\n\t'yopmail.net',\n\t'yourdomain.com',\n\t'ypmail.webarnak.fr.eu.org',\n\t'yuurok.com',\n\t'z1p.biz',\n\t'za.com',\n\t'zehnminuten.de',\n\t'zehnminutenmail.de',\n\t'zetmail.com',\n\t'zippymail.info',\n\t'zoaxe.com',\n\t'zoemail.com',\n\t'zoemail.net',\n\t'zoemail.org',\n\t'zomg.info',\n\t'zxcv.com',\n\t'zxcvbnm.com',\n\t'zzz.com',\n];\n\n","import IMAP from 'imap';\nimport POP3 from 'poplib';\nimport { simpleParser } from 'mailparser';\n\nexport class IMAPIntercepter {\n\tconstructor() {\n\t\tthis.imap = new IMAP({\n\t\t\tuser: RocketChat.settings.get('Direct_Reply_Username'),\n\t\t\tpassword: RocketChat.settings.get('Direct_Reply_Password'),\n\t\t\thost: RocketChat.settings.get('Direct_Reply_Host'),\n\t\t\tport: RocketChat.settings.get('Direct_Reply_Port'),\n\t\t\tdebug: RocketChat.settings.get('Direct_Reply_Debug') ? console.log : false,\n\t\t\ttls: !RocketChat.settings.get('Direct_Reply_IgnoreTLS'),\n\t\t\tconnTimeout: 30000,\n\t\t\tkeepalive: true,\n\t\t});\n\n\t\tthis.delete = RocketChat.settings.get('Direct_Reply_Delete') ? RocketChat.settings.get('Direct_Reply_Delete') : true;\n\n\t\t// On successfully connected.\n\t\tthis.imap.on('ready', Meteor.bindEnvironment(() => {\n\t\t\tif (this.imap.state !== 'disconnected') {\n\t\t\t\tthis.openInbox(Meteor.bindEnvironment((err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tthrow err;\n\t\t\t\t\t}\n\t\t\t\t\t// fetch new emails & wait [IDLE]\n\t\t\t\t\tthis.getEmails();\n\n\t\t\t\t\t// If new message arrived, fetch them\n\t\t\t\t\tthis.imap.on('mail', Meteor.bindEnvironment(() => {\n\t\t\t\t\t\tthis.getEmails();\n\t\t\t\t\t}));\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\tconsole.log('IMAP didnot connected.');\n\t\t\t\tthis.imap.end();\n\t\t\t}\n\t\t}));\n\n\t\tthis.imap.on('error', (err) => {\n\t\t\tconsole.log('Error occurred ...');\n\t\t\tthrow err;\n\t\t});\n\t}\n\n\topenInbox(cb) {\n\t\tthis.imap.openBox('INBOX', false, cb);\n\t}\n\n\tstart() {\n\t\tthis.imap.connect();\n\t}\n\n\tisActive() {\n\t\tif (this.imap && this.imap.state && this.imap.state === 'disconnected') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tstop(callback = new Function) {\n\t\tthis.imap.end();\n\t\tthis.imap.once('end', callback);\n\t}\n\n\trestart() {\n\t\tthis.stop(() => {\n\t\t\tconsole.log('Restarting IMAP ....');\n\t\t\tthis.start();\n\t\t});\n\t}\n\n\t// Fetch all UNSEEN messages and pass them for further processing\n\tgetEmails() {\n\t\tthis.imap.search(['UNSEEN'], Meteor.bindEnvironment((err, newEmails) => {\n\t\t\tif (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\tthrow err;\n\t\t\t}\n\n\t\t\t// newEmails => array containing serials of unseen messages\n\t\t\tif (newEmails.length > 0) {\n\t\t\t\tconst f = this.imap.fetch(newEmails, {\n\t\t\t\t\t// fetch headers & first body part.\n\t\t\t\t\tbodies: ['HEADER.FIELDS (FROM TO DATE MESSAGE-ID)', '1'],\n\t\t\t\t\tstruct: true,\n\t\t\t\t\tmarkSeen: true,\n\t\t\t\t});\n\n\t\t\t\tf.on('message', Meteor.bindEnvironment((msg, seqno) => {\n\t\t\t\t\tconst email = {};\n\n\t\t\t\t\tmsg.on('body', (stream, info) => {\n\t\t\t\t\t\tlet headerBuffer = '';\n\t\t\t\t\t\tlet bodyBuffer = '';\n\n\t\t\t\t\t\tstream.on('data', (chunk) => {\n\t\t\t\t\t\t\tif (info.which === '1') {\n\t\t\t\t\t\t\t\tbodyBuffer += chunk.toString('utf8');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\theaderBuffer += chunk.toString('utf8');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tstream.once('end', () => {\n\t\t\t\t\t\t\tif (info.which === '1') {\n\t\t\t\t\t\t\t\temail.body = bodyBuffer;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// parse headers\n\t\t\t\t\t\t\t\temail.headers = IMAP.parseHeader(headerBuffer);\n\n\t\t\t\t\t\t\t\temail.headers.to = email.headers.to[0];\n\t\t\t\t\t\t\t\temail.headers.date = email.headers.date[0];\n\t\t\t\t\t\t\t\temail.headers.from = email.headers.from[0];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t// On fetched each message, pass it further\n\t\t\t\t\tmsg.once('end', Meteor.bindEnvironment(() => {\n\t\t\t\t\t\t// delete message from inbox\n\t\t\t\t\t\tif (this.delete) {\n\t\t\t\t\t\t\tthis.imap.seq.addFlags(seqno, 'Deleted', (err) => {\n\t\t\t\t\t\t\t\tif (err) { console.log(`Mark deleted error: ${ err }`); }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tRocketChat.processDirectEmail(email);\n\t\t\t\t\t}));\n\t\t\t\t}));\n\t\t\t\tf.once('error', (err) => {\n\t\t\t\t\tconsole.log(`Fetch error: ${ err }`);\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\t}\n}\n\nexport class POP3Intercepter {\n\tconstructor() {\n\t\tthis.pop3 = new POP3(RocketChat.settings.get('Direct_Reply_Port'), RocketChat.settings.get('Direct_Reply_Host'), {\n\t\t\tenabletls: !RocketChat.settings.get('Direct_Reply_IgnoreTLS'),\n\t\t\tdebug: RocketChat.settings.get('Direct_Reply_Debug') ? console.log : false,\n\t\t});\n\n\t\tthis.totalMsgCount = 0;\n\t\tthis.currentMsgCount = 0;\n\n\t\tthis.pop3.on('connect', Meteor.bindEnvironment(() => {\n\t\t\tthis.pop3.login(RocketChat.settings.get('Direct_Reply_Username'), RocketChat.settings.get('Direct_Reply_Password'));\n\t\t}));\n\n\t\tthis.pop3.on('login', Meteor.bindEnvironment((status) => {\n\t\t\tif (status) {\n\t\t\t\t// run on start\n\t\t\t\tthis.pop3.list();\n\t\t\t} else {\n\t\t\t\tconsole.log('Unable to Log-in ....');\n\t\t\t}\n\t\t}));\n\n\t\t// on getting list of all emails\n\t\tthis.pop3.on('list', Meteor.bindEnvironment((status, msgcount) => {\n\t\t\tif (status) {\n\t\t\t\tif (msgcount > 0) {\n\t\t\t\t\tthis.totalMsgCount = msgcount;\n\t\t\t\t\tthis.currentMsgCount = 1;\n\t\t\t\t\t// Retrieve email\n\t\t\t\t\tthis.pop3.retr(this.currentMsgCount);\n\t\t\t\t} else {\n\t\t\t\t\tthis.pop3.quit();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.log('Cannot Get Emails ....');\n\t\t\t}\n\t\t}));\n\n\t\t// on retrieved email\n\t\tthis.pop3.on('retr', Meteor.bindEnvironment((status, msgnumber, data) => {\n\t\t\tif (status) {\n\t\t\t\t// parse raw email data to  JSON object\n\t\t\t\tsimpleParser(data, Meteor.bindEnvironment((err, mail) => {\n\t\t\t\t\tthis.initialProcess(mail);\n\t\t\t\t}));\n\n\t\t\t\tthis.currentMsgCount += 1;\n\n\t\t\t\t// delete email\n\t\t\t\tthis.pop3.dele(msgnumber);\n\t\t\t} else {\n\t\t\t\tconsole.log('Cannot Retrieve Message ....');\n\t\t\t}\n\t\t}));\n\n\t\t// on email deleted\n\t\tthis.pop3.on('dele', Meteor.bindEnvironment((status) => {\n\t\t\tif (status) {\n\t\t\t\t// get next email\n\t\t\t\tif (this.currentMsgCount <= this.totalMsgCount) {\n\t\t\t\t\tthis.pop3.retr(this.currentMsgCount);\n\t\t\t\t} else {\n\t\t\t\t\t// parsed all messages.. so quitting\n\t\t\t\t\tthis.pop3.quit();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.log('Cannot Delete Message....');\n\t\t\t}\n\t\t}));\n\n\t\t// invalid server state\n\t\tthis.pop3.on('invalid-state', function(cmd) {\n\t\t\tconsole.log(`Invalid state. You tried calling ${ cmd }`);\n\t\t});\n\n\t\t// locked => command already running, not finished yet\n\t\tthis.pop3.on('locked', function(cmd) {\n\t\t\tconsole.log(`Current command has not finished yet. You tried calling ${ cmd }`);\n\t\t});\n\t}\n\n\tinitialProcess(mail) {\n\t\tconst email = {\n\t\t\theaders: {\n\t\t\t\tfrom: mail.from.text,\n\t\t\t\tto: mail.to.text,\n\t\t\t\tdate: mail.date,\n\t\t\t\t'message-id': mail.messageId,\n\t\t\t},\n\t\t\tbody: mail.text,\n\t\t};\n\n\t\tRocketChat.processDirectEmail(email);\n\t}\n}\n\nexport class POP3Helper {\n\tconstructor() {\n\t\tthis.running = false;\n\t}\n\n\tstart() {\n\t\t// run every x-minutes\n\t\tif (RocketChat.settings.get('Direct_Reply_Frequency')) {\n\t\t\tRocketChat.POP3 = new POP3Intercepter();\n\n\t\t\tthis.running = Meteor.setInterval(() => {\n\t\t\t\t// get new emails and process\n\t\t\t\tRocketChat.POP3 = new POP3Intercepter();\n\t\t\t}, Math.max(RocketChat.settings.get('Direct_Reply_Frequency') * 60 * 1000, 2 * 60 * 1000));\n\t\t}\n\t}\n\n\tisActive() {\n\t\treturn this.running;\n\t}\n\n\tstop(callback = new Function) {\n\t\tif (this.isActive()) {\n\t\t\tMeteor.clearInterval(this.running);\n\t\t}\n\t\tcallback();\n\t}\n}\n","// Do not disclose if user exists when password is invalid\nconst { _runLoginHandlers } = Accounts;\nAccounts._runLoginHandlers = function(methodInvocation, options) {\n\tconst result = _runLoginHandlers.call(Accounts, methodInvocation, options);\n\n\tif (result.error && result.error.reason === 'Incorrect password') {\n\t\tresult.error = new Meteor.Error(403, 'User not found');\n\t}\n\n\treturn result;\n};\n","import _ from 'underscore';\nimport s from 'underscore.string';\nimport moment from 'moment';\n\n/**\n * Chechs if a messages contains a user highlight\n *\n * @param {string} message\n * @param {array|undefined} highlights\n *\n * @returns {boolean}\n */\n\nexport function messageContainsHighlight(message, highlights) {\n\tif (! highlights || highlights.length === 0) { return false; }\n\n\treturn highlights.some(function(highlight) {\n\t\tconst regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\treturn regexp.test(message.msg);\n\t});\n}\n\nfunction notifyUsersOnMessage(message, room) {\n\t// skips this callback if the message was edited and increments it if the edit was way in the past (aka imported)\n\tif (message.editedAt && Math.abs(moment(message.editedAt).diff()) > 60000) {\n\t\t// TODO: Review as I am not sure how else to get around this as the incrementing of the msgs count shouldn't be in this callback\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t} else if (message.editedAt) {\n\n\t\t// only updates last message if it was edited (skip rest of callback)\n\t\tif (RocketChat.settings.get('Store_Last_Message') && (!room.lastMessage || room.lastMessage._id === message._id)) {\n\t\t\tRocketChat.models.Rooms.setLastMessageById(message.rid, message);\n\t\t}\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t}\n\n\tif (room != null) {\n\t\tlet toAll = false;\n\t\tlet toHere = false;\n\t\tconst mentionIds = [];\n\t\tconst highlightsIds = [];\n\t\tconst highlights = RocketChat.models.Subscriptions.findByRoomWithUserHighlights(room._id, { fields: { userHighlights: 1, 'u._id': 1 } }).fetch();\n\t\tif (message.mentions != null) {\n\t\t\tmessage.mentions.forEach(function(mention) {\n\t\t\t\tif (!toAll && mention._id === 'all') {\n\t\t\t\t\ttoAll = true;\n\t\t\t\t}\n\t\t\t\tif (!toHere && mention._id === 'here') {\n\t\t\t\t\ttoHere = true;\n\t\t\t\t}\n\t\t\t\tif (mention._id !== message.u._id) {\n\t\t\t\t\tmentionIds.push(mention._id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\thighlights.forEach(function(subscription) {\n\t\t\tif (subscription.userHighlights && messageContainsHighlight(message, subscription.userHighlights)) {\n\t\t\t\tif (subscription.u._id !== message.u._id) {\n\t\t\t\t\thighlightsIds.push(subscription.u._id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (room.t === 'd') {\n\t\t\tconst unreadCountDM = RocketChat.settings.get('Unread_Count_DM');\n\n\t\t\tif (unreadCountDM === 'all_messages') {\n\t\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdExcludingUserId(room._id, message.u._id);\n\t\t\t} else if (toAll || toHere) {\n\t\t\t\tRocketChat.models.Subscriptions.incGroupMentionsAndUnreadForRoomIdExcludingUserId(room._id, message.u._id, 1, 1);\n\t\t\t} else if ((mentionIds && mentionIds.length > 0) || (highlightsIds && highlightsIds.length > 0)) {\n\t\t\t\tRocketChat.models.Subscriptions.incUserMentionsAndUnreadForRoomIdAndUserIds(room._id, _.compact(_.unique(mentionIds.concat(highlightsIds))), 1, 1);\n\t\t\t}\n\t\t} else {\n\t\t\tconst unreadCount = RocketChat.settings.get('Unread_Count');\n\n\t\t\tif (toAll || toHere) {\n\t\t\t\tlet incUnread = 0;\n\t\t\t\tif (['all_messages', 'group_mentions_only', 'user_and_group_mentions_only'].includes(unreadCount)) {\n\t\t\t\t\tincUnread = 1;\n\t\t\t\t}\n\t\t\t\tRocketChat.models.Subscriptions.incGroupMentionsAndUnreadForRoomIdExcludingUserId(room._id, message.u._id, 1, incUnread);\n\n\t\t\t} else if ((mentionIds && mentionIds.length > 0) || (highlightsIds && highlightsIds.length > 0)) {\n\t\t\t\tlet incUnread = 0;\n\t\t\t\tif (['all_messages', 'user_mentions_only', 'user_and_group_mentions_only'].includes(unreadCount)) {\n\t\t\t\t\tincUnread = 1;\n\t\t\t\t}\n\t\t\t\tRocketChat.models.Subscriptions.incUserMentionsAndUnreadForRoomIdAndUserIds(room._id, _.compact(_.unique(mentionIds.concat(highlightsIds))), 1, incUnread);\n\t\t\t} else if (unreadCount === 'all_messages') {\n\t\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdExcludingUserId(room._id, message.u._id);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Update all the room activity tracker fields\n\t// This method take so long to execute on gient rooms cuz it will trugger the cache rebuild for the releations of that room\n\tRocketChat.models.Rooms.incMsgCountAndSetLastMessageById(message.rid, 1, message.ts, RocketChat.settings.get('Store_Last_Message') && message);\n\t// Update all other subscriptions to alert their owners but witout incrementing\n\t// the unread counter, as it is only for mentions and direct messages\n\t// We now set alert and open properties in two separate update commands. This proved to be more efficient on MongoDB - because it uses a more efficient index.\n\tRocketChat.models.Subscriptions.setAlertForRoomIdExcludingUserId(message.rid, message.u._id);\n\tRocketChat.models.Subscriptions.setOpenForRoomIdExcludingUserId(message.rid, message.u._id);\n\n\treturn message;\n}\n\nRocketChat.callbacks.add('afterSaveMessage', notifyUsersOnMessage, RocketChat.callbacks.priority.LOW, 'notifyUsersOnMessage');\n","import { EmailReplyParser as reply } from 'emailreplyparser';\nimport moment from 'moment';\n\nRocketChat.processDirectEmail = function(email) {\n\tfunction sendMessage(email) {\n\t\tconst message = {\n\t\t\tts: new Date(email.headers.date),\n\t\t\tmsg: email.body,\n\t\t\tsentByEmail: true,\n\t\t\tgroupable: false,\n\t\t};\n\n\t\tif (message.ts) {\n\t\t\tconst tsDiff = Math.abs(moment(message.ts).diff());\n\t\t\tif (tsDiff > 10000) {\n\t\t\t\tmessage.ts = new Date();\n\t\t\t}\n\t\t} else {\n\t\t\tmessage.ts = new Date();\n\t\t}\n\n\t\tif (message.msg && message.msg.length > RocketChat.settings.get('Message_MaxAllowedSize')) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// reduce new lines in multiline message\n\t\tmessage.msg = message.msg.split('\\n\\n').join('\\n');\n\n\t\tconst user = RocketChat.models.Users.findOneByEmailAddress(email.headers.from, {\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\tname: 1,\n\t\t\t},\n\t\t});\n\t\tif (!user) {\n\t\t\t// user not found\n\t\t\treturn false;\n\t\t}\n\n\t\tconst prevMessage = RocketChat.models.Messages.findOneById(email.headers.mid, {\n\t\t\trid: 1,\n\t\t\tu: 1,\n\t\t});\n\t\tif (!prevMessage) {\n\t\t\t// message doesn't exist anymore\n\t\t\treturn false;\n\t\t}\n\t\tmessage.rid = prevMessage.rid;\n\n\t\tconst room = Meteor.call('canAccessRoom', message.rid, user._id);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst roomInfo = RocketChat.models.Rooms.findOneById(message.rid, {\n\t\t\tt: 1,\n\t\t\tname: 1,\n\t\t});\n\n\t\t// check mention\n\t\tif (message.msg.indexOf(`@${ prevMessage.u.username }`) === -1 && roomInfo.t !== 'd') {\n\t\t\tmessage.msg = `@${ prevMessage.u.username } ${ message.msg }`;\n\t\t}\n\n\t\t// reply message link\n\t\tlet prevMessageLink = `[ ](${ Meteor.absoluteUrl().replace(/\\/$/, '') }`;\n\t\tif (roomInfo.t === 'c') {\n\t\t\tprevMessageLink += `/channel/${ roomInfo.name }?msg=${ email.headers.mid }) `;\n\t\t} else if (roomInfo.t === 'd') {\n\t\t\tprevMessageLink += `/direct/${ prevMessage.u.username }?msg=${ email.headers.mid }) `;\n\t\t} else if (roomInfo.t === 'p') {\n\t\t\tprevMessageLink += `/group/${ roomInfo.name }?msg=${ email.headers.mid }) `;\n\t\t}\n\t\t// add reply message link\n\t\tmessage.msg = prevMessageLink + message.msg;\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(message.rid, user._id);\n\t\tif (subscription && (subscription.blocked || subscription.blocker)) {\n\t\t\t// room is blocked\n\t\t\treturn false;\n\t\t}\n\n\t\tif ((room.muted || []).includes(user.username)) {\n\t\t\t// room is muted\n\t\t\treturn false;\n\t\t}\n\n\t\tif (message.alias == null && RocketChat.settings.get('Message_SetNameToAliasEnabled')) {\n\t\t\tmessage.alias = user.name;\n\t\t}\n\n\t\tRocketChat.metrics.messagesSent.inc(); // TODO This line needs to be moved to it's proper place. See the comments on: https://github.com/RocketChat/Rocket.Chat/pull/5736\n\n\t\treturn RocketChat.sendMessage(user, message, room);\n\t}\n\n\t// Extract/parse reply from email body\n\temail.body = reply.parse_reply(email.body);\n\n\t// if 'To' email format is \"Name <username@domain>\"\n\tif (email.headers.to.indexOf('<') >= 0 && email.headers.to.indexOf('>') >= 0) {\n\t\temail.headers.to = email.headers.to.split('<')[1].split('>')[0];\n\t}\n\n\t// if 'From' email format is \"Name <username@domain>\"\n\tif (email.headers.from.indexOf('<') >= 0 && email.headers.from.indexOf('>') >= 0) {\n\t\temail.headers.from = email.headers.from.split('<')[1].split('>')[0];\n\t}\n\n\t// 'To' email format \"username+messageId@domain\"\n\tif (email.headers.to.indexOf('+') >= 0) {\n\t\t// Valid 'To' format\n\t\temail.headers.mid = email.headers.to.split('@')[0].split('+')[1];\n\t\tsendMessage(email);\n\t} else {\n\t\tconsole.log('Invalid Email....If not. Please report it.');\n\t}\n};\n","import { RoomTypesCommon } from '../../lib/RoomTypesCommon';\n\nRocketChat.roomTypes = new class roomTypesServer extends RoomTypesCommon {\n\t/**\n\t * Add a publish for a room type\n\t *\n\t * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))\n\t * @param {function} callback function that will return the publish's data\n\t*/\n\tsetPublish(roomType, callback) {\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].publish != null) {\n\t\t\tthrow new Meteor.Error('route-publish-exists', 'Publish for the given type already exists');\n\t\t}\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\tthis.roomTypes[roomType] = {};\n\t\t}\n\t\treturn this.roomTypes[roomType].publish = callback;\n\t}\n\n\tsetRoomFind(roomType, callback) {\n\t\tif (this.roomTypes[roomType] && this.roomTypes[roomType].roomFind != null) {\n\t\t\tthrow new Meteor.Error('room-find-exists', 'Room find for the given type already exists');\n\t\t}\n\t\tif (this.roomTypes[roomType] == null) {\n\t\t\tthis.roomTypes[roomType] = {};\n\t\t}\n\t\treturn this.roomTypes[roomType].roomFind = callback;\n\t}\n\n\tgetRoomFind(roomType) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].roomFind;\n\t}\n\n\tgetRoomName(roomType, roomData) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].roomName && this.roomTypes[roomType].roomName(roomData);\n\t}\n\n\t/**\n\t * Run the publish for a room type\n\t *\n\t * @param scope Meteor publish scope\n\t * @param {string} roomType room type (e.g.: c (for channels), d (for direct channels))\n\t * @param identifier identifier of the room\n\t*/\n\trunPublish(scope, roomType, identifier) {\n\t\treturn this.roomTypes[roomType] && this.roomTypes[roomType].publish && this.roomTypes[roomType].publish.call(scope, identifier);\n\t}\n\n};\n","import moment from 'moment';\n\nimport { callJoinRoom, messageContainsHighlight, parseMessageTextPerUser, replaceMentionedUsernamesWithFullNames } from '../functions/notifications/';\nimport { sendEmail, shouldNotifyEmail } from '../functions/notifications/email';\nimport { sendSinglePush, shouldNotifyMobile } from '../functions/notifications/mobile';\nimport { notifyDesktopUser, shouldNotifyDesktop } from '../functions/notifications/desktop';\nimport { notifyAudioUser, shouldNotifyAudio } from '../functions/notifications/audio';\n\nconst sendNotification = ({\n\tsubscription,\n\tsender,\n\thasMentionToAll,\n\thasMentionToHere,\n\tmessage,\n\tnotificationMessage,\n\troom,\n\tmentionIds,\n\tdisableAllMessageNotifications,\n}) => {\n\n\t// don't notify the sender\n\tif (subscription.u._id === sender._id) {\n\t\treturn;\n\t}\n\n\t// notifications disabled\n\tif (subscription.disableNotifications) {\n\t\treturn;\n\t}\n\n\t// dont send notification to users who ignored the sender\n\tif (Array.isArray(subscription.ignored) && subscription.ignored.includes(sender._id)) {\n\t\treturn;\n\t}\n\n\tconst hasMentionToUser = mentionIds.includes(subscription.u._id);\n\n\t// mute group notifications (@here and @all) if not directly mentioned as well\n\tif (!hasMentionToUser && subscription.muteGroupMentions && (hasMentionToAll || hasMentionToHere)) {\n\t\treturn;\n\t}\n\n\tconst receiver = RocketChat.models.Users.findOneById(subscription.u._id);\n\n\tif (!receiver || !receiver.active) {\n\t\treturn;\n\t}\n\n\tconst roomType = room.t;\n\t// If the user doesn't have permission to view direct messages, don't send notification of direct messages.\n\tif (roomType === 'd' && !RocketChat.authz.hasPermission(subscription.u._id, 'view-d-room')) {\n\t\treturn;\n\t}\n\n\tnotificationMessage = parseMessageTextPerUser(notificationMessage, message, receiver);\n\n\tconst isHighlighted = messageContainsHighlight(message, subscription.userHighlights);\n\n\n\tconst {\n\t\taudioNotifications,\n\t\tdesktopNotifications,\n\t\tmobilePushNotifications,\n\t\temailNotifications,\n\t} = subscription;\n\n\tlet notificationSent = false;\n\n\t// busy users don't receive audio notification\n\tif (shouldNotifyAudio({\n\t\tdisableAllMessageNotifications,\n\t\tstatus: receiver.status,\n\t\taudioNotifications,\n\t\thasMentionToAll,\n\t\thasMentionToHere,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\troomType,\n\t})) {\n\t\tnotifyAudioUser(subscription.u._id, message, room);\n\t}\n\n\t// busy users don't receive desktop notification\n\tif (shouldNotifyDesktop({\n\t\tdisableAllMessageNotifications,\n\t\tstatus: receiver.status,\n\t\tdesktopNotifications,\n\t\thasMentionToAll,\n\t\thasMentionToHere,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\troomType,\n\t})) {\n\t\tnotificationSent = true;\n\t\tnotifyDesktopUser({\n\t\t\tnotificationMessage,\n\t\t\tuserId: subscription.u._id,\n\t\t\tuser: sender,\n\t\t\tmessage,\n\t\t\troom,\n\t\t\tduration: subscription.desktopNotificationDuration,\n\t\t});\n\t}\n\n\tif (shouldNotifyMobile({\n\t\tdisableAllMessageNotifications,\n\t\tmobilePushNotifications,\n\t\thasMentionToAll,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\tstatusConnection: receiver.statusConnection,\n\t\troomType,\n\t})) {\n\t\tnotificationSent = true;\n\n\t\tsendSinglePush({\n\t\t\tnotificationMessage,\n\t\t\troom,\n\t\t\tmessage,\n\t\t\tuserId: subscription.u._id,\n\t\t\tsenderUsername: sender.username,\n\t\t\tsenderName: sender.name,\n\t\t\treceiverUsername: receiver.username,\n\t\t});\n\t}\n\n\tif (receiver.emails && shouldNotifyEmail({\n\t\tdisableAllMessageNotifications,\n\t\tstatusConnection: receiver.statusConnection,\n\t\temailNotifications,\n\t\tisHighlighted,\n\t\thasMentionToUser,\n\t\thasMentionToAll,\n\t\troomType,\n\t})) {\n\t\treceiver.emails.some((email) => {\n\t\t\tif (email.verified) {\n\t\t\t\tsendEmail({ message, receiver, subscription, room, emailAddress: email.address, hasMentionToUser });\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tif (notificationSent) {\n\t\tRocketChat.Sandstorm.notify(message, [subscription.u._id], `@${ sender.username }: ${ message.msg }`, room.t === 'p' ? 'privateMessage' : 'message');\n\t}\n};\n\nfunction sendAllNotifications(message, room) {\n\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\treturn message;\n\t}\n\n\tif (!room || room.t == null) {\n\t\treturn message;\n\t}\n\n\tconst sender = RocketChat.roomTypes.getConfig(room.t).getMsgSender(message.u._id);\n\tif (!sender) {\n\t\treturn message;\n\t}\n\n\tconst mentionIds = (message.mentions || []).map(({ _id }) => _id);\n\tconst mentionIdsWithoutGroups = mentionIds.filter((_id) => _id !== 'all' && _id !== 'here');\n\tconst hasMentionToAll = mentionIds.includes('all');\n\tconst hasMentionToHere = mentionIds.includes('here');\n\n\tlet notificationMessage = RocketChat.callbacks.run('beforeSendMessageNotifications', message.msg);\n\tif (mentionIds.length > 0 && RocketChat.settings.get('UI_Use_Real_Name')) {\n\t\tnotificationMessage = replaceMentionedUsernamesWithFullNames(message.msg, message.mentions);\n\t}\n\n\t// Don't fetch all users if room exceeds max members\n\tconst maxMembersForNotification = RocketChat.settings.get('Notifications_Max_Room_Members');\n\tconst roomMembersCount = RocketChat.models.Subscriptions.findByRoomId(room._id).count();\n\tconst disableAllMessageNotifications = roomMembersCount > maxMembersForNotification && maxMembersForNotification !== 0;\n\n\tconst query = {\n\t\trid: room._id,\n\t\t$or: [{\n\t\t\t'userHighlights.0': { $exists: 1 },\n\t\t}],\n\t};\n\n\t['audio', 'desktop', 'mobile', 'email'].forEach((kind) => {\n\t\tconst notificationField = `${ kind === 'mobile' ? 'mobilePush' : kind }Notifications`;\n\n\t\tconst filter = { [notificationField]: 'all' };\n\n\t\tif (disableAllMessageNotifications) {\n\t\t\tfilter[`${ kind }PrefOrigin`] = { $ne: 'user' };\n\t\t}\n\n\t\tquery.$or.push(filter);\n\n\t\tif (mentionIdsWithoutGroups.length > 0) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: 'mentions',\n\t\t\t\t'u._id': { $in: mentionIdsWithoutGroups },\n\t\t\t});\n\t\t} else if (!disableAllMessageNotifications && (hasMentionToAll || hasMentionToHere)) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: 'mentions',\n\t\t\t});\n\t\t}\n\n\t\tconst serverField = kind === 'email' ? 'emailNotificationMode' : `${ kind }Notifications`;\n\t\tconst serverPreference = RocketChat.settings.get(`Accounts_Default_User_Preferences_${ serverField }`);\n\t\tif ((room.t === 'd' && serverPreference !== 'nothing') || (!disableAllMessageNotifications && (serverPreference === 'all' || hasMentionToAll || hasMentionToHere))) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: { $exists: false },\n\t\t\t});\n\t\t} else if (serverPreference === 'mentions' && mentionIdsWithoutGroups.length) {\n\t\t\tquery.$or.push({\n\t\t\t\t[notificationField]: { $exists: false },\n\t\t\t\t'u._id': { $in: mentionIdsWithoutGroups },\n\t\t\t});\n\t\t}\n\t});\n\n\t// the find bellow is crucial. all subscription records returned will receive at least one kind of notification.\n\t// the query is defined by the server's default values and Notifications_Max_Room_Members setting.\n\tconst subscriptions = RocketChat.models.Subscriptions.findNotificationPreferencesByRoom(query);\n\tsubscriptions.forEach((subscription) => sendNotification({\n\t\tsubscription,\n\t\tsender,\n\t\thasMentionToAll,\n\t\thasMentionToHere,\n\t\tmessage,\n\t\tnotificationMessage,\n\t\troom,\n\t\tmentionIds,\n\t\tdisableAllMessageNotifications,\n\t}));\n\n\t// on public channels, if a mentioned user is not member of the channel yet, he will first join the channel and then be notified based on his preferences.\n\tif (room.t === 'c') {\n\t\t// get subscriptions from users already in room (to not send them a notification)\n\t\tconst mentions = [...mentionIdsWithoutGroups];\n\t\tRocketChat.models.Subscriptions.findByRoomIdAndUserIds(room._id, mentionIdsWithoutGroups, { fields: { 'u._id': 1 } }).forEach((subscription) => {\n\t\t\tconst index = mentions.indexOf(subscription.u._id);\n\t\t\tif (index !== -1) {\n\t\t\t\tmentions.splice(index, 1);\n\t\t\t}\n\t\t});\n\n\t\tPromise.all(mentions\n\t\t\t.map(async(userId) => {\n\t\t\t\tawait callJoinRoom(userId, room._id);\n\n\t\t\t\treturn userId;\n\t\t\t})\n\t\t).then((users) => {\n\t\t\tusers.forEach((userId) => {\n\t\t\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, userId);\n\n\t\t\t\tsendNotification({\n\t\t\t\t\tsubscription,\n\t\t\t\t\tsender,\n\t\t\t\t\thasMentionToAll,\n\t\t\t\t\thasMentionToHere,\n\t\t\t\t\tmessage,\n\t\t\t\t\tnotificationMessage,\n\t\t\t\t\troom,\n\t\t\t\t\tmentionIds,\n\t\t\t\t});\n\t\t\t});\n\t\t}).catch((error) => {\n\t\t\tthrow new Meteor.Error(error);\n\t\t});\n\t}\n\n\treturn message;\n}\n\nRocketChat.callbacks.add('afterSaveMessage', sendAllNotifications, RocketChat.callbacks.priority.LOW, 'sendNotificationsOnMessage');\n\nexport { sendNotification };\n","import _ from 'underscore';\nimport dns from 'dns';\n\nlet emailDomainBlackList = [];\nlet emailDomainWhiteList = [];\nlet useDefaultBlackList = false;\nlet useDNSDomainCheck = false;\n\nRocketChat.settings.get('Accounts_BlockedDomainsList', function(key, value) {\n\temailDomainBlackList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_AllowedDomainsList', function(key, value) {\n\temailDomainWhiteList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_UseDefaultBlockedDomainsList', function(key, value) {\n\tuseDefaultBlackList = value;\n});\nRocketChat.settings.get('Accounts_UseDNSDomainCheck', function(key, value) {\n\tuseDNSDomainCheck = value;\n});\n\nRocketChat.validateEmailDomain = function(email) {\n\tconst emailValidation = /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\tif (!emailValidation.test(email)) {\n\t\tthrow new Meteor.Error('error-invalid-email', `Invalid email ${ email }`, { function: 'RocketChat.validateEmailDomain', email });\n\t}\n\n\tconst emailDomain = email.substr(email.lastIndexOf('@') + 1);\n\n\t// if not in whitelist\n\tif (emailDomainWhiteList.indexOf(emailDomain) === -1) {\n\t\tif (emailDomainBlackList.indexOf(emailDomain) !== -1 || (useDefaultBlackList && RocketChat.emailDomainDefaultBlackList.indexOf(emailDomain) !== -1)) {\n\t\t\tthrow new Meteor.Error('error-email-domain-blacklisted', 'The email domain is blacklisted', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n\n\tif (useDNSDomainCheck) {\n\t\ttry {\n\t\t\tMeteor.wrapAsync(dns.resolveMx)(emailDomain);\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-domain', 'Invalid domain', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n};\n","import PasswordPolicy from './PasswordPolicyClass';\n\nRocketChat.passwordPolicy = new PasswordPolicy();\n\nRocketChat.settings.get('Accounts_Password_Policy_Enabled', (key, value) => RocketChat.passwordPolicy.enabled = value);\nRocketChat.settings.get('Accounts_Password_Policy_MinLength', (key, value) => RocketChat.passwordPolicy.minLength = value);\nRocketChat.settings.get('Accounts_Password_Policy_MaxLength', (key, value) => RocketChat.passwordPolicy.maxLength = value);\nRocketChat.settings.get('Accounts_Password_Policy_ForbidRepeatingCharacters', (key, value) => RocketChat.passwordPolicy.forbidRepeatingCharacters = value);\nRocketChat.settings.get('Accounts_Password_Policy_ForbidRepeatingCharactersCount', (key, value) => RocketChat.passwordPolicy.forbidRepeatingCharactersCount = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneLowercase', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneLowercase = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneUppercase', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneUppercase = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneNumber', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneNumber = value);\nRocketChat.settings.get('Accounts_Password_Policy_AtLeastOneSpecialCharacter', (key, value) => RocketChat.passwordPolicy.mustContainAtLeastOneSpecialCharacter = value);\n","/*\n\tWhat is this file? Great question! To make Rocket.Chat more \"modular\"\n\tand to make the \"rocketchat:lib\" package more of a core package\n\twith the libraries, this index file contains the exported members\n\tfor the *server* pieces of code which does include the shared\n\tlibrary files.\n*/\n\nimport { RoomSettingsEnum, RoomTypeConfig, RoomTypeRouteConfig } from '../../lib/RoomTypeConfig';\nimport { sendNotification } from './sendNotificationsOnMessage.js';\n\nexport {\n\tRoomSettingsEnum,\n\tRoomTypeConfig,\n\tRoomTypeRouteConfig,\n\tsendNotification,\n};\n","class PasswordPolicy {\n\tconstructor({\n\t\tenabled = false,\n\t\tminLength = -1,\n\t\tmaxLength = -1,\n\t\tforbidRepeatingCharacters = false,\n\t\tforbidRepeatingCharactersCount = 3, // the regex is this number minus one\n\t\tmustContainAtLeastOneLowercase = false, // /[A-Z]{3,}/ could do this instead of at least one\n\t\tmustContainAtLeastOneUppercase = false,\n\t\tmustContainAtLeastOneNumber = false,\n\t\tmustContainAtLeastOneSpecialCharacter = false,\n\t\tthrowError = true,\n\t} = {}) {\n\t\tthis.regex = {\n\t\t\tmustContainAtLeastOneLowercase: new RegExp('[a-z]'),\n\t\t\tmustContainAtLeastOneUppercase: new RegExp('[A-Z]'),\n\t\t\tmustContainAtLeastOneNumber: new RegExp('[0-9]'),\n\t\t\tmustContainAtLeastOneSpecialCharacter: new RegExp('[^A-Za-z0-9 ]'),\n\t\t};\n\n\t\tthis.enabled = enabled;\n\t\tthis.minLength = minLength;\n\t\tthis.maxLength = maxLength;\n\t\tthis.forbidRepeatingCharacters = forbidRepeatingCharacters;\n\t\tthis.forbidRepeatingCharactersCount = forbidRepeatingCharactersCount;\n\t\tthis.mustContainAtLeastOneLowercase = mustContainAtLeastOneLowercase;\n\t\tthis.mustContainAtLeastOneUppercase = mustContainAtLeastOneUppercase;\n\t\tthis.mustContainAtLeastOneNumber = mustContainAtLeastOneNumber;\n\t\tthis.mustContainAtLeastOneSpecialCharacter = mustContainAtLeastOneSpecialCharacter;\n\t\tthis.throwError = throwError;\n\t}\n\n\tset forbidRepeatingCharactersCount(value) {\n\t\tthis._forbidRepeatingCharactersCount = value;\n\t\tthis.regex.forbiddingRepeatingCharacters = new RegExp(`(.)\\\\1{${ this.forbidRepeatingCharactersCount },}`);\n\t}\n\n\tget forbidRepeatingCharactersCount() {\n\t\treturn this._forbidRepeatingCharactersCount;\n\t}\n\n\terror(error, message) {\n\t\tif (this.throwError) {\n\t\t\tthrow new Meteor.Error(error, message);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvalidate(password) {\n\t\tif (!this.enabled) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!password || typeof password !== 'string' || !password.length) {\n\t\t\treturn this.error('error-password-policy-not-met', 'The password provided does not meet the server\\'s password policy.');\n\t\t}\n\n\t\tif (this.minLength >= 1 && password.length < this.minLength) {\n\t\t\treturn this.error('error-password-policy-not-met-minLength', 'The password does not meet the minimum length password policy.');\n\t\t}\n\n\t\tif (this.maxLength >= 1 && password.length > this.maxLength) {\n\t\t\treturn this.error('error-password-policy-not-met-maxLength', 'The password does not meet the maximum length password policy.');\n\t\t}\n\n\t\tif (this.forbidRepeatingCharacters && this.regex.forbiddingRepeatingCharacters.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-repeatingCharacters', 'The password contains repeating characters which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneLowercase && !this.regex.mustContainAtLeastOneLowercase.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneLowercase', 'The password does not contain at least one lowercase character which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneUppercase && !this.regex.mustContainAtLeastOneUppercase.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneUppercase', 'The password does not contain at least one uppercase character which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneNumber && !this.regex.mustContainAtLeastOneNumber.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneNumber', 'The password does not contain at least one numerical character which is against the password policy.');\n\t\t}\n\n\t\tif (this.mustContainAtLeastOneSpecialCharacter && !this.regex.mustContainAtLeastOneSpecialCharacter.test(password)) {\n\t\t\treturn this.error('error-password-policy-not-met-oneSpecial', 'The password does not contain at least one special character which is against the password policy.');\n\t\t}\n\n\t\treturn true;\n\t}\n}\n\nexport default PasswordPolicy;\n","import fs from 'fs';\n\nfunction hasDockerEnv() {\n\ttry {\n\t\tfs.statSync('/.dockerenv');\n\t\treturn true;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction hasDockerCGroup() {\n\ttry {\n\t\treturn fs.readFileSync('/proc/self/cgroup', 'utf8').indexOf('docker') !== -1;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction check() {\n\treturn hasDockerEnv() || hasDockerCGroup();\n}\n\nlet isDocker;\nRocketChat.isDocker = function() {\n\tif (isDocker === undefined) {\n\t\tisDocker = check();\n\t}\n\n\treturn isDocker;\n};\n","RocketChat.addUserToDefaultChannels = function(user, silenced) {\n\tRocketChat.callbacks.run('beforeJoinDefaultChannels', user);\n\tconst defaultRooms = RocketChat.models.Rooms.findByDefaultAndTypes(true, ['c', 'p'], { fields: { usernames: 0 } }).fetch();\n\tdefaultRooms.forEach((room) => {\n\n\t\t// put user in default rooms\n\t\tconst muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\t\tif (muted) {\n\t\t\tRocketChat.models.Rooms.muteUsernameByRoomId(room._id, user.username);\n\t\t}\n\n\t\tif (!RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, user._id)) {\n\n\t\t\t// Add a subscription to this user\n\t\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\t\t\tts: new Date(),\n\t\t\t\topen: true,\n\t\t\t\talert: true,\n\t\t\t\tunread: 1,\n\t\t\t\tuserMentions: 1,\n\t\t\t\tgroupMentions: 0,\n\t\t\t});\n\n\t\t\t// Insert user joined message\n\t\t\tif (!silenced) {\n\t\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(room._id, user);\n\t\t\t}\n\t\t}\n\t});\n};\n","RocketChat.addUserToRoom = function(rid, user, inviter, silenced) {\n\tconst now = new Date();\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t// Check if user is already in room\n\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, user._id);\n\tif (subscription) {\n\t\treturn;\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tRocketChat.callbacks.run('beforeJoinRoom', user, room);\n\t}\n\n\tconst muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\tif (muted) {\n\t\tRocketChat.models.Rooms.muteUsernameByRoomId(rid, user.username);\n\t}\n\n\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\tts: now,\n\t\topen: true,\n\t\talert: true,\n\t\tunread: 1,\n\t\tuserMentions: 1,\n\t\tgroupMentions: 0,\n\t});\n\n\tif (!silenced) {\n\t\tif (inviter) {\n\t\t\tRocketChat.models.Messages.createUserAddedWithRoomIdAndUser(rid, user, {\n\t\t\t\tts: now,\n\t\t\t\tu: {\n\t\t\t\t\t_id: inviter._id,\n\t\t\t\t\tusername: inviter.username,\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(rid, user, { ts: now });\n\t\t}\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterJoinRoom', user, room);\n\t\t});\n\t}\n\n\treturn true;\n};\n","RocketChat.archiveRoom = function(rid) {\n\tRocketChat.models.Rooms.archiveById(rid);\n\tRocketChat.models.Subscriptions.archiveByRoomId(rid);\n\n\tRocketChat.callbacks.run('afterRoomArchived', RocketChat.models.Rooms.findOneById(rid), Meteor.user());\n};\n","import s from 'underscore.string';\n\n\nlet usernameBlackList = [];\n\nconst toRegExp = (username) => new RegExp(`^${ s.escapeRegExp(username).trim() }$`, 'i');\n\nRocketChat.settings.get('Accounts_BlockedUsernameList', (key, value) => {\n\tusernameBlackList = value.split(',').map(toRegExp);\n});\n\nconst usernameIsBlocked = (username, usernameBlackList) => usernameBlackList.length\n\t&& usernameBlackList.some((restrictedUsername) => restrictedUsername.test(s.trim(s.escapeRegExp(username))));\n\nRocketChat.checkUsernameAvailability = function(username) {\n\n\tif (usernameIsBlocked(username, usernameBlackList)) {\n\t\treturn false;\n\t}\n\n\treturn !Meteor.users.findOne({\n\t\tusername: {\n\t\t\t$regex: toRegExp(username),\n\t\t},\n\t}, { fields: { _id: 1 } });\n};\n","import s from 'underscore.string';\n\nRocketChat.checkEmailAvailability = function(email) {\n\treturn !Meteor.users.findOne({ 'emails.address': { $regex : new RegExp(`^${ s.trim(s.escapeRegExp(email)) }$`, 'i') } });\n};\n","/* globals RocketChat */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.createRoom = function(type, name, owner, members, readOnly, extraData = {}) {\n\tname = s.trim(name);\n\towner = s.trim(owner);\n\tmembers = [].concat(members);\n\n\tif (!name) {\n\t\tthrow new Meteor.Error('error-invalid-name', 'Invalid name', { function: 'RocketChat.createRoom' });\n\t}\n\n\towner = RocketChat.models.Users.findOneByUsername(owner, { fields: { username: 1 } });\n\tif (!owner) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: 'RocketChat.createRoom' });\n\t}\n\n\tif (!_.contains(members, owner.username)) {\n\t\tmembers.push(owner.username);\n\t}\n\n\tif (extraData.broadcast) {\n\t\treadOnly = true;\n\t\tdelete extraData.reactWhenReadOnly;\n\t}\n\n\tconst now = new Date();\n\tlet room = Object.assign({\n\t\tname: RocketChat.getValidRoomName(name),\n\t\tfname: name,\n\t\tt: type,\n\t\tmsgs: 0,\n\t\tusersCount: 0,\n\t\tu: {\n\t\t\t_id: owner._id,\n\t\t\tusername: owner.username,\n\t\t},\n\t}, extraData, {\n\t\tts: now,\n\t\tro: readOnly === true,\n\t\tsysMes: readOnly !== true,\n\t});\n\n\tif (type === 'd') {\n\t\troom.usernames = members;\n\t}\n\n\tif (Apps && Apps.isLoaded()) {\n\t\tconst prevent = Promise.await(Apps.getBridges().getListenerBridge().roomEvent('IPreRoomCreatePrevent', room));\n\t\tif (prevent) {\n\t\t\tthrow new Meteor.Error('error-app-prevented-creation', 'A Rocket.Chat App prevented the room creation.');\n\t\t}\n\n\t\tlet result;\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().roomEvent('IPreRoomCreateExtend', room));\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().roomEvent('IPreRoomCreateModify', result));\n\n\t\tif (typeof result === 'object') {\n\t\t\troom = Object.assign(room, result);\n\t\t}\n\t}\n\n\tif (type === 'c') {\n\t\tRocketChat.callbacks.run('beforeCreateChannel', owner, room);\n\t}\n\n\troom = RocketChat.models.Rooms.createWithFullRoomData(room);\n\n\tfor (const username of members) {\n\t\tconst member = RocketChat.models.Users.findOneByUsername(username, { fields: { username: 1, 'settings.preferences': 1 } });\n\t\tconst isTheOwner = username === owner.username;\n\t\tif (!member) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// make all room members (Except the owner) muted by default, unless they have the post-readonly permission\n\t\tif (readOnly === true && !RocketChat.authz.hasPermission(member._id, 'post-readonly') && !isTheOwner) {\n\t\t\tRocketChat.models.Rooms.muteUsernameByRoomId(room._id, username);\n\t\t}\n\n\t\tconst extra = { open: true };\n\n\t\tif (username === owner.username) {\n\t\t\textra.ls = now;\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, member, extra);\n\t}\n\n\tRocketChat.authz.addUserRoles(owner._id, ['owner'], room._id);\n\n\tif (type === 'c') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreateChannel', owner, room);\n\t\t});\n\t} else if (type === 'p') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreatePrivateGroup', owner, room);\n\t\t});\n\t}\n\tMeteor.defer(() => {\n\t\tRocketChat.callbacks.run('afterCreateRoom', owner, room);\n\t});\n\n\tif (Apps && Apps.isLoaded()) {\n\t\t// This returns a promise, but it won't mutate anything about the message\n\t\t// so, we don't really care if it is successful or fails\n\t\tApps.getBridges().getListenerBridge().roomEvent('IPostRoomCreate', room);\n\t}\n\n\treturn {\n\t\trid: room._id,\n\t\tname: room.name,\n\t};\n};\n","RocketChat.cleanRoomHistory = function({ rid, latest = new Date(), oldest = new Date('0001-01-01T00:00:00Z'), inclusive = true, limit = 0, excludePinned = true, filesOnly = false, fromUsers = [] }) {\n\tconst gt = inclusive ? '$gte' : '$gt';\n\tconst lt = inclusive ? '$lte' : '$lt';\n\n\tconst ts = { [gt]: oldest, [lt]: latest };\n\n\tconst text = `_${ TAPi18n.__('File_removed_by_prune') }_`;\n\n\tlet fileCount = 0;\n\tRocketChat.models.Messages.findFilesByRoomIdPinnedTimestampAndUsers(\n\t\trid,\n\t\texcludePinned,\n\t\tts,\n\t\tfromUsers,\n\t\t{ fields: { 'file._id': 1, pinned: 1 }, limit }\n\t).forEach((document) => {\n\t\tFileUpload.getStore('Uploads').deleteById(document.file._id);\n\t\tfileCount++;\n\t\tif (filesOnly) {\n\t\t\tRocketChat.models.Messages.update({ _id: document._id }, { $unset: { file: 1 }, $set: { attachments: [{ color: '#FD745E', text }] } });\n\t\t}\n\t});\n\tif (filesOnly) {\n\t\treturn fileCount;\n\t}\n\n\tconst count = limit ? RocketChat.models.Messages.removeByIdPinnedTimestampLimitAndUsers(rid, excludePinned, ts, limit, fromUsers) : RocketChat.models.Messages.removeByIdPinnedTimestampAndUsers(rid, excludePinned, ts, fromUsers);\n\n\tif (count) {\n\t\tRocketChat.models.Rooms.resetLastMessageById(rid);\n\t\tRocketChat.Notifications.notifyRoom(rid, 'deleteMessageBulk', {\n\t\t\trid,\n\t\t\texcludePinned,\n\t\t\tts,\n\t\t\tusers: fromUsers,\n\t\t});\n\t}\n\treturn count;\n};\n","/* globals FileUpload */\nRocketChat.deleteMessage = function(message, user) {\n\tconst keepHistory = RocketChat.settings.get('Message_KeepHistory');\n\tconst showDeletedStatus = RocketChat.settings.get('Message_ShowDeletedStatus');\n\tconst deletedMsg = RocketChat.models.Messages.findOneById(message._id);\n\n\tif (deletedMsg && Apps && Apps.isLoaded()) {\n\t\tconst prevent = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageDeletePrevent', deletedMsg));\n\t\tif (prevent) {\n\t\t\tthrow new Meteor.Error('error-app-prevented-deleting', 'A Rocket.Chat App prevented the message deleting.');\n\t\t}\n\t}\n\n\tif (keepHistory) {\n\t\tif (showDeletedStatus) {\n\t\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t\t} else {\n\t\t\tRocketChat.models.Messages.setHiddenById(message._id, true);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tRocketChat.models.Uploads.update(message.file._id, { $set: { _hidden: true } });\n\t\t}\n\t} else {\n\t\tif (!showDeletedStatus) {\n\t\t\tRocketChat.models.Messages.removeById(message._id);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tFileUpload.getStore('Uploads').deleteById(message.file._id);\n\t\t}\n\t}\n\n\tMeteor.defer(function() {\n\t\tRocketChat.callbacks.run('afterDeleteMessage', deletedMsg);\n\t});\n\n\t// update last message\n\tif (RocketChat.settings.get('Store_Last_Message')) {\n\t\tconst room = RocketChat.models.Rooms.findOneById(message.rid, { fields: { lastMessage: 1 } });\n\t\tif (!room.lastMessage || room.lastMessage._id === message._id) {\n\t\t\tRocketChat.models.Rooms.resetLastMessageById(message.rid);\n\t\t}\n\t}\n\n\tif (showDeletedStatus) {\n\t\tRocketChat.models.Messages.setAsDeletedByIdAndUser(message._id, user);\n\t} else {\n\t\tRocketChat.Notifications.notifyRoom(message.rid, 'deleteMessage', { _id: message._id });\n\t}\n\n\tif (Apps && Apps.isLoaded()) {\n\t\tApps.getBridges().getListenerBridge().messageEvent('IPostMessageDeleted', deletedMsg);\n\t}\n};\n","RocketChat.deleteUser = function(userId) {\n\tconst user = RocketChat.models.Users.findOneById(userId, {\n\t\tfields: { username: 1, avatarOrigin: 1 },\n\t});\n\n\t// Users without username can't do anything, so there is nothing to remove\n\tif (user.username != null) {\n\t\tconst roomCache = [];\n\n\t\t// Iterate through all the rooms the user is subscribed to, to check if they are the last owner of any of them.\n\t\tRocketChat.models.Subscriptions.db.findByUserId(userId).forEach((subscription) => {\n\t\t\tconst roomData = {\n\t\t\t\trid: subscription.rid,\n\t\t\t\tt: subscription.t,\n\t\t\t\tsubscribers: null,\n\t\t\t};\n\n\t\t\t// DMs can always be deleted, so let's ignore it on this check\n\t\t\tif (roomData.t !== 'd') {\n\t\t\t\t// If the user is an owner on this room\n\t\t\t\tif (RocketChat.authz.hasRole(user._id, 'owner', subscription.rid)) {\n\t\t\t\t\t// Fetch the number of owners\n\t\t\t\t\tconst numOwners = RocketChat.authz.getUsersInRole('owner', subscription.rid).fetch().length;\n\t\t\t\t\t// If it's only one, then this user is the only owner.\n\t\t\t\t\tif (numOwners === 1) {\n\t\t\t\t\t\t// If the user is the last owner of a public channel, then we need to abort the deletion\n\t\t\t\t\t\tif (roomData.t === 'c') {\n\t\t\t\t\t\t\tthrow new Meteor.Error('error-user-is-last-owner', `To delete this user you'll need to set a new owner to the following room: ${ subscription.name }.`, {\n\t\t\t\t\t\t\t\tmethod: 'deleteUser',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// For private groups, let's check how many subscribers it has. If the user is the only subscriber, then it will be eliminated and doesn't need to abort the deletion\n\t\t\t\t\t\troomData.subscribers = RocketChat.models.Subscriptions.findByRoomId(subscription.rid).count();\n\n\t\t\t\t\t\tif (roomData.subscribers > 1) {\n\t\t\t\t\t\t\tthrow new Meteor.Error('error-user-is-last-owner', `To delete this user you'll need to set a new owner to the following room: ${ subscription.name }.`, {\n\t\t\t\t\t\t\t\tmethod: 'deleteUser',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\troomCache.push(roomData);\n\t\t});\n\n\t\tconst messageErasureType = RocketChat.settings.get('Message_ErasureType');\n\t\tswitch (messageErasureType) {\n\t\t\tcase 'Delete':\n\t\t\t\tconst store = FileUpload.getStore('Uploads');\n\t\t\t\tRocketChat.models.Messages.findFilesByUserId(userId).forEach(function({ file }) {\n\t\t\t\t\tstore.deleteById(file._id);\n\t\t\t\t});\n\t\t\t\tRocketChat.models.Messages.removeByUserId(userId);\n\t\t\t\tbreak;\n\t\t\tcase 'Unlink':\n\t\t\t\tconst rocketCat = RocketChat.models.Users.findOneById('rocket.cat');\n\t\t\t\tconst nameAlias = TAPi18n.__('Removed_User');\n\t\t\t\tRocketChat.models.Messages.unlinkUserId(userId, rocketCat._id, rocketCat.username, nameAlias);\n\t\t\t\tbreak;\n\t\t}\n\n\t\troomCache.forEach((roomData) => {\n\t\t\tif (roomData.subscribers === null && roomData.t !== 'd' && roomData.t !== 'c') {\n\t\t\t\troomData.subscribers = RocketChat.models.Subscriptions.findByRoomId(roomData.rid).count();\n\t\t\t}\n\n\t\t\t// Remove DMs and non-channel rooms with only 1 user (the one being deleted)\n\t\t\tif (roomData.t === 'd' || (roomData.t !== 'c' && roomData.subscribers === 1)) {\n\t\t\t\tRocketChat.models.Subscriptions.removeByRoomId(roomData.rid);\n\t\t\t\tRocketChat.models.Messages.removeFilesByRoomId(roomData.rid);\n\t\t\t\tRocketChat.models.Messages.removeByRoomId(roomData.rid);\n\t\t\t\tRocketChat.models.Rooms.removeById(roomData.rid);\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models.Subscriptions.removeByUserId(userId); // Remove user subscriptions\n\t\tRocketChat.models.Rooms.removeDirectRoomContainingUsername(user.username); // Remove direct rooms with the user\n\n\t\t// removes user's avatar\n\t\tif (user.avatarOrigin === 'upload' || user.avatarOrigin === 'url') {\n\t\t\tFileUpload.getStore('Avatars').deleteByName(user.username);\n\t\t}\n\n\t\tRocketChat.models.Integrations.disableByUserId(userId); // Disables all the integrations which rely on the user being deleted.\n\t\tRocketChat.Notifications.notifyLogged('Users:Deleted', { userId });\n\t}\n\n\tRocketChat.models.Users.removeById(userId); // Remove user from users database\n};\n","/* globals RocketChat */\nimport s from 'underscore.string';\n\nconst logger = new Logger('getFullUserData');\n\nconst defaultFields = {\n\tname: 1,\n\tusername: 1,\n\tstatus: 1,\n\tutcOffset: 1,\n\ttype: 1,\n\tactive: 1,\n\treason: 1,\n};\n\nconst fullFields = {\n\temails: 1,\n\tphone: 1,\n\tstatusConnection: 1,\n\tcreatedAt: 1,\n\tlastLogin: 1,\n\tservices: 1,\n\trequirePasswordChange: 1,\n\trequirePasswordChangeReason: 1,\n\troles: 1,\n};\n\nlet publicCustomFields = {};\nlet customFields = {};\n\nRocketChat.settings.get('Accounts_CustomFields', (key, value) => {\n\tpublicCustomFields = {};\n\tcustomFields = {};\n\n\tif (!value.trim()) {\n\t\treturn;\n\t}\n\n\ttry {\n\t\tconst customFieldsOnServer = JSON.parse(value.trim());\n\t\tObject.keys(customFieldsOnServer).forEach((key) => {\n\t\t\tconst element = customFieldsOnServer[key];\n\t\t\tif (element.public) {\n\t\t\t\tpublicCustomFields[`customFields.${ key }`] = 1;\n\t\t\t}\n\t\t\tcustomFields[`customFields.${ key }`] = 1;\n\t\t});\n\t} catch (e) {\n\t\tlogger.warn(`The JSON specified for \"Accounts_CustomFields\" is invalid. The following error was thrown: ${ e }`);\n\t}\n});\n\nRocketChat.getFullUserData = function({ userId, filter, limit: l }) {\n\tconst username = s.trim(filter);\n\tconst userToRetrieveFullUserData = RocketChat.models.Users.findOneByUsername(username);\n\tconst isMyOwnInfo = userToRetrieveFullUserData && userToRetrieveFullUserData._id === userId;\n\tconst viewFullOtherUserInfo = RocketChat.authz.hasPermission(userId, 'view-full-other-user-info');\n\tconst limit = !viewFullOtherUserInfo ? 1 : l;\n\n\tif (!username && limit <= 1) {\n\t\treturn undefined;\n\t}\n\n\tconst _customFields = isMyOwnInfo || viewFullOtherUserInfo ? customFields : publicCustomFields;\n\n\tconst fields = viewFullOtherUserInfo ? { ...defaultFields, ...fullFields, ..._customFields } : { ...defaultFields, ..._customFields };\n\n\tconst options = {\n\t\tfields,\n\t\tlimit,\n\t\tsort: { username: 1 },\n\t};\n\n\tif (!username) {\n\t\treturn RocketChat.models.Users.find({}, options);\n\t}\n\tif (limit === 1) {\n\t\treturn RocketChat.models.Users.findByUsername(username, options);\n\t}\n\tconst usernameReg = new RegExp(s.escapeRegExp(username), 'i');\n\treturn RocketChat.models.Users.findByUsernameNameOrEmailAddress(usernameReg, options);\n};\n","/* globals RocketChat */\nimport _ from 'underscore';\n\nRocketChat.getRoomByNameOrIdWithOptionToJoin = function _getRoomByNameOrIdWithOptionToJoin({ currentUserId, nameOrId, type = '', tryDirectByUserIdOnly = false, joinChannel = true, errorOnEmpty = true }) {\n\tlet room;\n\n\t// If the nameOrId starts with #, then let's try to find a channel or group\n\tif (nameOrId.startsWith('#')) {\n\t\tnameOrId = nameOrId.substring(1);\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t} else if (nameOrId.startsWith('@') || type === 'd') {\n\t\t// If the nameOrId starts with @ OR type is 'd', then let's try just a direct message\n\t\tnameOrId = nameOrId.replace('@', '');\n\n\t\tlet roomUser;\n\t\tif (tryDirectByUserIdOnly) {\n\t\t\troomUser = RocketChat.models.Users.findOneById(nameOrId);\n\t\t} else {\n\t\t\troomUser = RocketChat.models.Users.findOne({\n\t\t\t\t$or: [{ _id: nameOrId }, { username: nameOrId }],\n\t\t\t});\n\t\t}\n\n\t\tconst rid = _.isObject(roomUser) ? [currentUserId, roomUser._id].sort().join('') : nameOrId;\n\t\troom = RocketChat.models.Rooms.findOneById(rid);\n\n\t\t// If the room hasn't been found yet, let's try some more\n\t\tif (!_.isObject(room)) {\n\t\t\t// If the roomUser wasn't found, then there's no destination to point towards\n\t\t\t// so return out based upon errorOnEmpty\n\t\t\tif (!_.isObject(roomUser)) {\n\t\t\t\tif (errorOnEmpty) {\n\t\t\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\troom = Meteor.runAsUser(currentUserId, function() {\n\t\t\t\tconst { rid } = Meteor.call('createDirectMessage', roomUser.username);\n\t\t\t\treturn RocketChat.models.Rooms.findOneById(rid);\n\t\t\t});\n\t\t}\n\t} else {\n\t\t// Otherwise, we'll treat this as a channel or group.\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t}\n\n\t// If no room was found, handle the room return based upon errorOnEmpty\n\tif (!room && errorOnEmpty) {\n\t\tthrow new Meteor.Error('invalid-channel');\n\t} else if (!room) {\n\t\treturn;\n\t}\n\n\t// If a room was found and they provided a type to search, then check\n\t// and if the type found isn't what we're looking for then handle\n\t// the return based upon errorOnEmpty\n\tif (type && room.t !== type) {\n\t\tif (errorOnEmpty) {\n\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t// If the room type is channel and joinChannel has been passed, try to join them\n\t// if they can't join the room, this will error out!\n\tif (room.t === 'c' && joinChannel) {\n\t\tconst sub = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, currentUserId);\n\n\t\tif (!sub) {\n\t\t\tMeteor.runAsUser(currentUserId, function() {\n\t\t\t\treturn Meteor.call('joinRoom', room._id);\n\t\t\t});\n\t\t}\n\t}\n\n\treturn room;\n};\n","import _ from 'underscore';\n\nconst hideMessagesOfType = [];\n\nRocketChat.settings.get(/Message_HideType_.+/, function(key, value) {\n\tconst type = key.replace('Message_HideType_', '');\n\tconst types = type === 'mute_unmute' ? ['user-muted', 'user-unmuted'] : [type];\n\n\treturn types.forEach((type) => {\n\t\tconst index = hideMessagesOfType.indexOf(type);\n\n\t\tif (value === true && index === -1) {\n\t\t\treturn hideMessagesOfType.push(type);\n\t\t}\n\n\t\tif (index > -1) {\n\t\t\treturn hideMessagesOfType.splice(index, 1);\n\t\t}\n\t});\n});\n\nRocketChat.loadMessageHistory = function loadMessageHistory({ userId, rid, end, limit = 20, ls }) {\n\tconst options = {\n\t\tsort: {\n\t\t\tts: -1,\n\t\t},\n\t\tlimit,\n\t};\n\n\tif (!RocketChat.settings.get('Message_ShowEditedStatus')) {\n\t\toptions.fields = {\n\t\t\teditedAt: 0,\n\t\t};\n\t}\n\n\tlet records;\n\tif (end != null) {\n\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestampNotContainingTypes(rid, end, hideMessagesOfType, options).fetch();\n\t} else {\n\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdNotContainingTypes(rid, hideMessagesOfType, options).fetch();\n\t}\n\n\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\tconst messages = records.map((message) => {\n\t\tmessage.starred = _.findWhere(message.starred, {\n\t\t\t_id: userId,\n\t\t});\n\t\tif (message.u && message.u._id && UI_Use_Real_Name) {\n\t\t\tconst user = RocketChat.models.Users.findOneById(message.u._id);\n\t\t\tmessage.u.name = user && user.name;\n\t\t}\n\t\tif (message.mentions && message.mentions.length && UI_Use_Real_Name) {\n\t\t\tmessage.mentions.forEach((mention) => {\n\t\t\t\tconst user = RocketChat.models.Users.findOneById(mention._id);\n\t\t\t\tmention.name = user && user.name;\n\t\t\t});\n\t\t}\n\t\treturn message;\n\t});\n\n\tlet unreadNotLoaded = 0;\n\tlet firstUnread;\n\n\tif (ls != null) {\n\t\tconst firstMessage = messages[messages.length - 1];\n\n\t\tif ((firstMessage != null ? firstMessage.ts : undefined) > ls) {\n\t\t\tdelete options.limit;\n\n\t\t\tconst unreadMessages = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestampsNotContainingTypes(rid, ls, firstMessage.ts, hideMessagesOfType, {\n\t\t\t\tlimit: 1,\n\t\t\t\tsort: {\n\t\t\t\t\tts: 1,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tfirstUnread = unreadMessages.fetch()[0];\n\t\t\tunreadNotLoaded = unreadMessages.count();\n\t\t}\n\t}\n\n\treturn {\n\t\tmessages,\n\t\tfirstUnread,\n\t\tunreadNotLoaded,\n\t};\n};\n","RocketChat.removeUserFromRoom = function(rid, user) {\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\tif (room) {\n\t\tRocketChat.callbacks.run('beforeLeaveRoom', user, room);\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, user._id, { fields: { _id: 1 } });\n\n\t\tif (subscription) {\n\t\t\tconst removedUser = user;\n\t\t\tRocketChat.models.Messages.createUserLeaveWithRoomIdAndUser(rid, removedUser);\n\t\t}\n\n\t\tif (room.t === 'l') {\n\t\t\tRocketChat.models.Messages.createCommandWithRoomIdAndUser('survey', rid, user);\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.removeByRoomIdAndUserId(rid, user._id);\n\n\t\tMeteor.defer(function() {\n\t\t\t// TODO: CACHE: maybe a queue?\n\t\t\tRocketChat.callbacks.run('afterLeaveRoom', user, room);\n\t\t});\n\t}\n};\n","/* globals Gravatar */\nimport _ from 'underscore';\nimport s from 'underscore.string';\nimport * as Mailer from 'meteor/rocketchat:mailer';\nlet html = '';\nMeteor.startup(() => {\n\tMailer.getTemplate('Accounts_UserAddedEmail_Email', (template) => {\n\t\thtml = template;\n\t});\n});\n\nfunction validateUserData(userId, userData) {\n\tconst existingRoles = _.pluck(RocketChat.authz.getRoles(), '_id');\n\n\tif (userData._id && userId !== userData._id && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing user is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Editing_user',\n\t\t});\n\t}\n\n\tif (!userData._id && !RocketChat.authz.hasPermission(userId, 'create-user')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding user is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Adding_user',\n\t\t});\n\t}\n\n\tif (userData.roles && _.difference(userData.roles, existingRoles).length > 0) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'The field Roles consist invalid role name', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Assign_role',\n\t\t});\n\t}\n\n\tif (userData.roles && _.indexOf(userData.roles, 'admin') >= 0 && !RocketChat.authz.hasPermission(userId, 'assign-admin-role')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Assigning admin is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Assign_admin',\n\t\t});\n\t}\n\n\tif (!userData._id && !s.trim(userData.name)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Name is required', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tfield: 'Name',\n\t\t});\n\t}\n\n\tif (!userData._id && !s.trim(userData.username)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Username is required', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tfield: 'Username',\n\t\t});\n\t}\n\n\tlet nameValidation;\n\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (e) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\n\tif (userData.username && !nameValidation.test(userData.username)) {\n\t\tthrow new Meteor.Error('error-input-is-not-a-valid-field', `${ _.escape(userData.username) } is not a valid username`, {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tinput: userData.username,\n\t\t\tfield: 'Username',\n\t\t});\n\t}\n\n\tif (!userData._id && !userData.password) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Password is required', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\tfield: 'Password',\n\t\t});\n\t}\n\n\tif (!userData._id) {\n\t\tif (!RocketChat.checkUsernameAvailability(userData.username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${ _.escape(userData.username) } is already in use :(`, {\n\t\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\t\tfield: userData.username,\n\t\t\t});\n\t\t}\n\n\t\tif (userData.email && !RocketChat.checkEmailAvailability(userData.email)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${ _.escape(userData.email) } is already in use :(`, {\n\t\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\t\tfield: userData.email,\n\t\t\t});\n\t\t}\n\t}\n}\n\nRocketChat.saveUser = function(userId, userData) {\n\tvalidateUserData(userId, userData);\n\n\tif (!userData._id) {\n\t\tRocketChat.validateEmailDomain(userData.email);\n\n\t\t// insert user\n\t\tconst createUser = {\n\t\t\tusername: userData.username,\n\t\t\tpassword: userData.password,\n\t\t\tjoinDefaultChannels: userData.joinDefaultChannels,\n\t\t};\n\t\tif (userData.email) {\n\t\t\tcreateUser.email = userData.email;\n\t\t}\n\n\t\tconst _id = Accounts.createUser(createUser);\n\n\t\tconst updateUser = {\n\t\t\t$set: {\n\t\t\t\tname: userData.name,\n\t\t\t\troles: userData.roles || ['user'],\n\t\t\t\tsettings: userData.settings || {},\n\t\t\t},\n\t\t};\n\n\t\tif (typeof userData.requirePasswordChange !== 'undefined') {\n\t\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t\t}\n\n\t\tif (typeof userData.verified === 'boolean') {\n\t\t\tupdateUser.$set['emails.0.verified'] = userData.verified;\n\t\t}\n\n\t\tMeteor.users.update({ _id }, updateUser);\n\n\t\tif (userData.sendWelcomeEmail) {\n\t\t\tconst subject = RocketChat.settings.get('Accounts_UserAddedEmail_Subject');\n\n\t\t\tconst email = {\n\t\t\t\tto: userData.email,\n\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\tsubject,\n\t\t\t\thtml,\n\t\t\t\tdata: {\n\t\t\t\t\tname: s.escapeHTML(userData.name),\n\t\t\t\t\temail: s.escapeHTML(userData.email),\n\t\t\t\t\tpassword: s.escapeHTML(userData.password),\n\t\t\t\t},\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tMailer.send(email);\n\t\t\t} catch (error) {\n\t\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ error.message }`, {\n\t\t\t\t\tfunction: 'RocketChat.saveUser',\n\t\t\t\t\tmessage: error.message,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tuserData._id = _id;\n\n\t\tif (RocketChat.settings.get('Accounts_SetDefaultAvatar') === true && userData.email) {\n\t\t\tconst gravatarUrl = Gravatar.imageUrl(userData.email, { default: '404', size: 200, secure: true });\n\n\t\t\ttry {\n\t\t\t\tRocketChat.setUserAvatar(userData, gravatarUrl, '', 'url');\n\t\t\t} catch (e) {\n\t\t\t\t// Ignore this error for now, as it not being successful isn't bad\n\t\t\t}\n\t\t}\n\n\t\treturn _id;\n\t}\n\tif (!RocketChat.settings.get('Accounts_AllowUserProfileChange') && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info') && !RocketChat.authz.hasPermission(userId, 'edit-other-user-password')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Edit user profile is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Update_user',\n\t\t});\n\t}\n\n\tif (userData.username && !RocketChat.settings.get('Accounts_AllowUsernameChange') && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Edit username is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Update_user',\n\t\t});\n\t}\n\n\tif (userData.name && !RocketChat.settings.get('Accounts_AllowRealNameChange') && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Edit user real name is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Update_user',\n\t\t});\n\t}\n\n\tif (userData.email && !RocketChat.settings.get('Accounts_AllowEmailChange') && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Edit user email is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Update_user',\n\t\t});\n\t}\n\n\tif (userData.password && !RocketChat.settings.get('Accounts_AllowPasswordChange') && !RocketChat.authz.hasPermission(userId, 'edit-other-user-password')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Edit user password is not allowed', {\n\t\t\tmethod: 'insertOrUpdateUser',\n\t\t\taction: 'Update_user',\n\t\t});\n\t}\n\n\t// update user\n\tif (userData.username) {\n\t\tRocketChat.setUsername(userData._id, userData.username);\n\t}\n\n\tif (userData.name) {\n\t\tRocketChat.setRealName(userData._id, userData.name);\n\t}\n\n\tif (userData.email) {\n\t\tconst shouldSendVerificationEmailToUser = userData.verified !== true;\n\t\tRocketChat.setEmail(userData._id, userData.email, shouldSendVerificationEmailToUser);\n\t}\n\n\tif (userData.password && userData.password.trim() && RocketChat.authz.hasPermission(userId, 'edit-other-user-password') && RocketChat.passwordPolicy.validate(userData.password)) {\n\t\tAccounts.setPassword(userData._id, userData.password.trim());\n\t}\n\n\tconst updateUser = {\n\t\t$set: {},\n\t};\n\n\tif (userData.roles) {\n\t\tupdateUser.$set.roles = userData.roles;\n\t}\n\n\tif (userData.settings) {\n\t\tupdateUser.$set.settings = { preferences: userData.settings.preferences };\n\t}\n\n\tif (typeof userData.requirePasswordChange !== 'undefined') {\n\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t}\n\n\tif (typeof userData.verified === 'boolean') {\n\t\tupdateUser.$set['emails.0.verified'] = userData.verified;\n\t}\n\n\tMeteor.users.update({ _id: userData._id }, updateUser);\n\n\treturn true;\n};\n","import s from 'underscore.string';\n\nRocketChat.saveCustomFields = function(userId, formData) {\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) !== '') {\n\t\tRocketChat.validateCustomFields(formData);\n\t\treturn RocketChat.saveCustomFieldsWithoutValidation(userId, formData);\n\t}\n};\n","import s from 'underscore.string';\n\nRocketChat.saveCustomFieldsWithoutValidation = function(userId, formData) {\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) !== '') {\n\t\tlet customFieldsMeta;\n\t\ttry {\n\t\t\tcustomFieldsMeta = JSON.parse(RocketChat.settings.get('Accounts_CustomFields'));\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-customfield-json', 'Invalid JSON for Custom Fields');\n\t\t}\n\n\t\tconst customFields = {};\n\t\tObject.keys(customFieldsMeta).forEach((key) => customFields[key] = formData[key]);\n\t\tRocketChat.models.Users.setCustomFields(userId, customFields);\n\n\t\t// Update customFields of all Direct Messages' Rooms for userId\n\t\tRocketChat.models.Subscriptions.setCustomFieldsDirectMessagesByUserId(userId, customFields);\n\n\t\tObject.keys(customFields).forEach((fieldName) => {\n\t\t\tif (!customFieldsMeta[fieldName].modifyRecordField) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { modifyRecordField } = customFieldsMeta[fieldName];\n\t\t\tconst update = {};\n\t\t\tif (modifyRecordField.array) {\n\t\t\t\tupdate.$addToSet = {};\n\t\t\t\tupdate.$addToSet[modifyRecordField.field] = customFields[fieldName];\n\t\t\t} else {\n\t\t\t\tupdate.$set = {};\n\t\t\t\tupdate.$set[modifyRecordField.field] = customFields[fieldName];\n\t\t\t}\n\n\t\t\tRocketChat.models.Users.update(userId, update);\n\t\t});\n\t}\n};\n","const objectMaybeIncluding = (types) => Match.Where((value) => {\n\tObject.keys(types).forEach((field) => {\n\t\tif (value[field] != null) {\n\t\t\ttry {\n\t\t\t\tcheck(value[field], types[field]);\n\t\t\t} catch (error) {\n\t\t\t\terror.path = field;\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t});\n\n\treturn true;\n});\n\nconst validateAttachmentsFields = (attachmentField) => {\n\tcheck(attachmentField, objectMaybeIncluding({\n\t\tshort: Boolean,\n\t\ttitle: String,\n\t\tvalue: Match.OneOf(String, Match.Integer, Boolean),\n\t}));\n\n\tif (typeof attachmentField.value !== 'undefined') {\n\t\tattachmentField.value = String(attachmentField.value);\n\t}\n\n};\n\nconst validateAttachmentsActions = (attachmentActions) => {\n\tcheck(attachmentActions, objectMaybeIncluding({\n\t\ttype: String,\n\t\ttext: String,\n\t\turl: String,\n\t\timage_url: String,\n\t\tis_webview: Boolean,\n\t\twebview_height_ratio: String,\n\t\tmsg: String,\n\t\tmsg_in_chat_window: Boolean,\n\t}));\n};\n\nconst validateAttachment = (attachment) => {\n\tcheck(attachment, objectMaybeIncluding({\n\t\tcolor: String,\n\t\ttext: String,\n\t\tts: Match.OneOf(String, Match.Integer),\n\t\tthumb_url: String,\n\t\tbutton_alignment: String,\n\t\tactions: [Match.Any],\n\t\tmessage_link: String,\n\t\tcollapsed: Boolean,\n\t\tauthor_name: String,\n\t\tauthor_link: String,\n\t\tauthor_icon: String,\n\t\ttitle: String,\n\t\ttitle_link: String,\n\t\ttitle_link_download: Boolean,\n\t\timage_url: String,\n\t\taudio_url: String,\n\t\tvideo_url: String,\n\t\tfields: [Match.Any],\n\t}));\n\n\tif (attachment.fields && attachment.fields.length) {\n\t\tattachment.fields.map(validateAttachmentsFields);\n\t}\n\n\tif (attachment.actions && attachment.actions.length) {\n\t\tattachment.actions.map(validateAttachmentsActions);\n\t}\n};\n\nconst validateBodyAttachments = (attachments) => attachments.map(validateAttachment);\n\nRocketChat.sendMessage = function(user, message, room, upsert = false) {\n\tif (!user || !message || !room._id) {\n\t\treturn false;\n\t}\n\n\tcheck(message, objectMaybeIncluding({\n\t\t_id: String,\n\t\tmsg: String,\n\t\ttext: String,\n\t\talias: String,\n\t\temoji: String,\n\t\tavatar: String,\n\t\tattachments: [Match.Any],\n\t}));\n\n\tif (Array.isArray(message.attachments) && message.attachments.length) {\n\t\tvalidateBodyAttachments(message.attachments);\n\t}\n\n\tif (!message.ts) {\n\t\tmessage.ts = new Date();\n\t}\n\tconst { _id, username, name } = user;\n\tmessage.u = {\n\t\t_id,\n\t\tusername,\n\t\tname,\n\t};\n\tmessage.rid = room._id;\n\n\tif (!Match.test(message.msg, String)) {\n\t\tmessage.msg = '';\n\t}\n\n\tif (message.ts == null) {\n\t\tmessage.ts = new Date();\n\t}\n\n\tif (RocketChat.settings.get('Message_Read_Receipt_Enabled')) {\n\t\tmessage.unread = true;\n\t}\n\n\t// For the Rocket.Chat Apps :)\n\tif (message && Apps && Apps.isLoaded()) {\n\t\tconst prevent = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageSentPrevent', message));\n\t\tif (prevent) {\n\t\t\tthrow new Meteor.Error('error-app-prevented-sending', 'A Rocket.Chat App prevented the message sending.');\n\t\t}\n\n\t\tlet result;\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageSentExtend', message));\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageSentModify', result));\n\n\t\tif (typeof result === 'object') {\n\t\t\tmessage = Object.assign(message, result);\n\t\t}\n\t}\n\n\tif (message.parseUrls !== false) {\n\t\tmessage.html = message.msg;\n\t\tmessage = RocketChat.Markdown.code(message);\n\n\t\tconst urls = message.html.match(/([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\(\\)\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g);\n\t\tif (urls) {\n\t\t\tmessage.urls = urls.map((url) => ({ url }));\n\t\t}\n\n\t\tmessage = RocketChat.Markdown.mountTokensBack(message, false);\n\t\tmessage.msg = message.html;\n\t\tdelete message.html;\n\t\tdelete message.tokens;\n\t}\n\n\tmessage = RocketChat.callbacks.run('beforeSaveMessage', message);\n\tif (message) {\n\t\t// Avoid saving sandstormSessionId to the database\n\t\tlet sandstormSessionId = null;\n\t\tif (message.sandstormSessionId) {\n\t\t\tsandstormSessionId = message.sandstormSessionId;\n\t\t\tdelete message.sandstormSessionId;\n\t\t}\n\n\t\tif (message._id && upsert) {\n\t\t\tconst { _id } = message;\n\t\t\tdelete message._id;\n\t\t\tRocketChat.models.Messages.upsert({\n\t\t\t\t_id,\n\t\t\t\t'u._id': message.u._id,\n\t\t\t}, message);\n\t\t\tmessage._id = _id;\n\t\t} else {\n\t\t\tmessage._id = RocketChat.models.Messages.insert(message);\n\t\t}\n\n\t\tif (Apps && Apps.isLoaded()) {\n\t\t\t// This returns a promise, but it won't mutate anything about the message\n\t\t\t// so, we don't really care if it is successful or fails\n\t\t\tApps.getBridges().getListenerBridge().messageEvent('IPostMessageSent', message);\n\t\t}\n\n\t\t/*\n\t\tDefer other updates as their return is not interesting to the user\n\t\t*/\n\t\tMeteor.defer(() => {\n\t\t\t// Execute all callbacks\n\t\t\tmessage.sandstormSessionId = sandstormSessionId;\n\t\t\treturn RocketChat.callbacks.run('afterSaveMessage', message, room, user._id);\n\t\t});\n\t\treturn message;\n\t}\n};\n","import _ from 'underscore';\n\nconst blockedSettings = {};\n\nif (process.env.SETTINGS_BLOCKED) {\n\tprocess.env.SETTINGS_BLOCKED.split(',').forEach((settingId) => blockedSettings[settingId] = 1);\n}\n\nconst hiddenSettings = {};\nif (process.env.SETTINGS_HIDDEN) {\n\tprocess.env.SETTINGS_HIDDEN.split(',').forEach((settingId) => hiddenSettings[settingId] = 1);\n}\n\nRocketChat.settings._sorter = {};\n\n\n/*\n* Add a setting\n* @param {String} _id\n* @param {Mixed} value\n* @param {Object} setting\n*/\n\nRocketChat.settings.add = function(_id, value, options = {}) {\n\tif (options == null) {\n\t\toptions = {};\n\t}\n\tif (!_id || value == null) {\n\t\treturn false;\n\t}\n\tif (RocketChat.settings._sorter[options.group] == null) {\n\t\tRocketChat.settings._sorter[options.group] = 0;\n\t}\n\toptions.packageValue = value;\n\toptions.valueSource = 'packageValue';\n\toptions.hidden = options.hidden || false;\n\toptions.blocked = options.blocked || false;\n\tif (options.sorter == null) {\n\t\toptions.sorter = RocketChat.settings._sorter[options.group]++;\n\t}\n\tif (options.enableQuery != null) {\n\t\toptions.enableQuery = JSON.stringify(options.enableQuery);\n\t}\n\tif (options.i18nDefaultQuery != null) {\n\t\toptions.i18nDefaultQuery = JSON.stringify(options.i18nDefaultQuery);\n\t}\n\tif (typeof process !== 'undefined' && process.env && process.env[_id]) {\n\t\tvalue = process.env[_id];\n\t\tif (value.toLowerCase() === 'true') {\n\t\t\tvalue = true;\n\t\t} else if (value.toLowerCase() === 'false') {\n\t\t\tvalue = false;\n\t\t}\n\t\toptions.processEnvValue = value;\n\t\toptions.valueSource = 'processEnvValue';\n\t} else if (Meteor.settings && typeof Meteor.settings[_id] !== 'undefined') {\n\t\tif (Meteor.settings[_id] == null) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvalue = Meteor.settings[_id];\n\t\toptions.meteorSettingsValue = value;\n\t\toptions.valueSource = 'meteorSettingsValue';\n\t}\n\tif (options.i18nLabel == null) {\n\t\toptions.i18nLabel = _id;\n\t}\n\tif (options.i18nDescription == null) {\n\t\toptions.i18nDescription = `${ _id }_Description`;\n\t}\n\tif (blockedSettings[_id] != null) {\n\t\toptions.blocked = true;\n\t}\n\tif (hiddenSettings[_id] != null) {\n\t\toptions.hidden = true;\n\t}\n\tif (options.autocomplete == null) {\n\t\toptions.autocomplete = true;\n\t}\n\tif (typeof process !== 'undefined' && process.env && process.env[`OVERWRITE_SETTING_${ _id }`]) {\n\t\tlet value = process.env[`OVERWRITE_SETTING_${ _id }`];\n\t\tif (value.toLowerCase() === 'true') {\n\t\t\tvalue = true;\n\t\t} else if (value.toLowerCase() === 'false') {\n\t\t\tvalue = false;\n\t\t}\n\t\toptions.value = value;\n\t\toptions.processEnvValue = value;\n\t\toptions.valueSource = 'processEnvValue';\n\t}\n\tconst updateOperations = {\n\t\t$set: options,\n\t\t$setOnInsert: {\n\t\t\tcreatedAt: new Date,\n\t\t},\n\t};\n\tif (options.editor != null) {\n\t\tupdateOperations.$setOnInsert.editor = options.editor;\n\t\tdelete options.editor;\n\t}\n\tif (options.value == null) {\n\t\tif (options.force === true) {\n\t\t\tupdateOperations.$set.value = options.packageValue;\n\t\t} else {\n\t\t\tupdateOperations.$setOnInsert.value = value;\n\t\t}\n\t}\n\tconst query = _.extend({\n\t\t_id,\n\t}, updateOperations.$set);\n\tif (options.section == null) {\n\t\tupdateOperations.$unset = {\n\t\t\tsection: 1,\n\t\t};\n\t\tquery.section = {\n\t\t\t$exists: false,\n\t\t};\n\t}\n\tconst existantSetting = RocketChat.models.Settings.db.findOne(query);\n\tif (existantSetting != null) {\n\t\tif (existantSetting.editor == null && updateOperations.$setOnInsert.editor != null) {\n\t\t\tupdateOperations.$set.editor = updateOperations.$setOnInsert.editor;\n\t\t\tdelete updateOperations.$setOnInsert.editor;\n\t\t}\n\t} else {\n\t\tupdateOperations.$set.ts = new Date;\n\t}\n\treturn RocketChat.models.Settings.upsert({\n\t\t_id,\n\t}, updateOperations);\n};\n\n\n/*\n* Add a setting group\n* @param {String} _id\n*/\n\nRocketChat.settings.addGroup = function(_id, options = {}, cb) {\n\tif (!_id) {\n\t\treturn false;\n\t}\n\tif (_.isFunction(options)) {\n\t\tcb = options;\n\t\toptions = {};\n\t}\n\tif (options.i18nLabel == null) {\n\t\toptions.i18nLabel = _id;\n\t}\n\tif (options.i18nDescription == null) {\n\t\toptions.i18nDescription = `${ _id }_Description`;\n\t}\n\toptions.ts = new Date;\n\toptions.blocked = false;\n\toptions.hidden = false;\n\tif (blockedSettings[_id] != null) {\n\t\toptions.blocked = true;\n\t}\n\tif (hiddenSettings[_id] != null) {\n\t\toptions.hidden = true;\n\t}\n\tRocketChat.models.Settings.upsert({\n\t\t_id,\n\t}, {\n\t\t$set: options,\n\t\t$setOnInsert: {\n\t\t\ttype: 'group',\n\t\t\tcreatedAt: new Date,\n\t\t},\n\t});\n\tif (cb != null) {\n\t\tcb.call({\n\t\t\tadd(id, value, options) {\n\t\t\t\tif (options == null) {\n\t\t\t\t\toptions = {};\n\t\t\t\t}\n\t\t\t\toptions.group = _id;\n\t\t\t\treturn RocketChat.settings.add(id, value, options);\n\t\t\t},\n\t\t\tsection(section, cb) {\n\t\t\t\treturn cb.call({\n\t\t\t\t\tadd(id, value, options) {\n\t\t\t\t\t\tif (options == null) {\n\t\t\t\t\t\t\toptions = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions.group = _id;\n\t\t\t\t\t\toptions.section = section;\n\t\t\t\t\t\treturn RocketChat.settings.add(id, value, options);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n};\n\n\n/*\n* Remove a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.removeById = function(_id) {\n\tif (!_id) {\n\t\treturn false;\n\t}\n\treturn RocketChat.models.Settings.removeById(_id);\n};\n\n\n/*\n* Update a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.updateById = function(_id, value, editor) {\n\tif (!_id || value == null) {\n\t\treturn false;\n\t}\n\tif (editor != null) {\n\t\treturn RocketChat.models.Settings.updateValueAndEditorById(_id, value, editor);\n\t}\n\treturn RocketChat.models.Settings.updateValueById(_id, value);\n};\n\n\n/*\n* Update options of a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.updateOptionsById = function(_id, options) {\n\tif (!_id || options == null) {\n\t\treturn false;\n\t}\n\treturn RocketChat.models.Settings.updateOptionsById(_id, options);\n};\n\n\n/*\n* Update a setting by id\n* @param {String} _id\n*/\n\nRocketChat.settings.clearById = function(_id) {\n\tif (_id == null) {\n\t\treturn false;\n\t}\n\treturn RocketChat.models.Settings.updateValueById(_id, undefined);\n};\n\n\n/*\n* Update a setting by id\n*/\n\nRocketChat.settings.init = function() {\n\tRocketChat.settings.initialLoad = true;\n\tRocketChat.models.Settings.find().observe({\n\t\tadded(record) {\n\t\t\tMeteor.settings[record._id] = record.value;\n\t\t\tif (record.env === true) {\n\t\t\t\tprocess.env[record._id] = record.value;\n\t\t\t}\n\t\t\treturn RocketChat.settings.load(record._id, record.value, RocketChat.settings.initialLoad);\n\t\t},\n\t\tchanged(record) {\n\t\t\tMeteor.settings[record._id] = record.value;\n\t\t\tif (record.env === true) {\n\t\t\t\tprocess.env[record._id] = record.value;\n\t\t\t}\n\t\t\treturn RocketChat.settings.load(record._id, record.value, RocketChat.settings.initialLoad);\n\t\t},\n\t\tremoved(record) {\n\t\t\tdelete Meteor.settings[record._id];\n\t\t\tif (record.env === true) {\n\t\t\t\tdelete process.env[record._id];\n\t\t\t}\n\t\t\treturn RocketChat.settings.load(record._id, undefined, RocketChat.settings.initialLoad);\n\t\t},\n\t});\n\tRocketChat.settings.initialLoad = false;\n\tRocketChat.settings.afterInitialLoad.forEach((fn) => fn(Meteor.settings));\n};\n\nRocketChat.settings.afterInitialLoad = [];\n\nRocketChat.settings.onAfterInitialLoad = function(fn) {\n\tRocketChat.settings.afterInitialLoad.push(fn);\n\tif (RocketChat.settings.initialLoad === false) {\n\t\treturn fn(Meteor.settings);\n\t}\n};\n","RocketChat.setUserAvatar = function(user, dataURI, contentType, service) {\n\tlet encoding;\n\tlet image;\n\n\tif (service === 'initials') {\n\t\treturn RocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t} else if (service === 'url') {\n\t\tlet result = null;\n\n\t\ttry {\n\t\t\tresult = HTTP.get(dataURI, { npmRequestOptions: { encoding: 'binary' } });\n\t\t} catch (error) {\n\t\t\tif (!error.response || error.response.statusCode !== 404) {\n\t\t\t\tconsole.log(`Error while handling the setting of the avatar from a url (${ dataURI }) for ${ user.username }:`, error);\n\t\t\t\tthrow new Meteor.Error('error-avatar-url-handling', `Error while handling avatar setting from a URL (${ dataURI }) for ${ user.username }`, { function: 'RocketChat.setUserAvatar', url: dataURI, username: user.username });\n\t\t\t}\n\t\t}\n\n\t\tif (result.statusCode !== 200) {\n\t\t\tconsole.log(`Not a valid response, ${ result.statusCode }, from the avatar url: ${ dataURI }`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${ dataURI }`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tif (!/image\\/.+/.test(result.headers['content-type'])) {\n\t\t\tconsole.log(`Not a valid content-type from the provided url, ${ result.headers['content-type'] }, from the avatar url: ${ dataURI }`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${ dataURI }`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tencoding = 'binary';\n\t\timage = result.content;\n\t\tcontentType = result.headers['content-type'];\n\t} else if (service === 'rest') {\n\t\tencoding = 'binary';\n\t\timage = dataURI;\n\t} else {\n\t\tconst fileData = RocketChatFile.dataURIParse(dataURI);\n\t\tencoding = 'base64';\n\t\timage = fileData.image;\n\t\tcontentType = fileData.contentType;\n\t}\n\n\tconst buffer = new Buffer(image, encoding);\n\tconst fileStore = FileUpload.getStore('Avatars');\n\tfileStore.deleteByName(user.username);\n\n\tconst file = {\n\t\tuserId: user._id,\n\t\ttype: contentType,\n\t\tsize: buffer.length,\n\t};\n\n\tfileStore.insert(file, buffer, () => {\n\t\tMeteor.setTimeout(function() {\n\t\t\tRocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t\t\tRocketChat.Notifications.notifyLogged('updateAvatar', { username: user.username });\n\t\t}, 500);\n\t});\n};\n","import s from 'underscore.string';\n\nRocketChat._setUsername = function(userId, u) {\n\tconst username = s.trim(u);\n\tif (!userId || !username) {\n\t\treturn false;\n\t}\n\tlet nameValidation;\n\ttry {\n\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t} catch (error) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\tif (!nameValidation.test(username)) {\n\t\treturn false;\n\t}\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\t// User already has desired username, return\n\tif (user.username === username) {\n\t\treturn user;\n\t}\n\tconst previousUsername = user.username;\n\t// Check username availability or if the user already owns a different casing of the name\n\tif (!previousUsername || !(username.toLowerCase() === previousUsername.toLowerCase())) {\n\t\tif (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\t// If first time setting username, send Enrollment Email\n\ttry {\n\t\tif (!previousUsername && user.emails && user.emails.length > 0 && RocketChat.settings.get('Accounts_Enrollment_Email')) {\n\t\t\tAccounts.sendEnrollmentEmail(user._id);\n\t\t}\n\t} catch (e) {\n\t\tconsole.error(e);\n\t}\n\t/* globals getAvatarSuggestionForUser */\n\tuser.username = username;\n\tif (!previousUsername && RocketChat.settings.get('Accounts_SetDefaultAvatar') === true) {\n\t\tconst avatarSuggestions = getAvatarSuggestionForUser(user);\n\t\tlet gravatar;\n\t\tObject.keys(avatarSuggestions).some((service) => {\n\t\t\tconst avatarData = avatarSuggestions[service];\n\t\t\tif (service !== 'gravatar') {\n\t\t\t\tRocketChat.setUserAvatar(user, avatarData.blob, avatarData.contentType, service);\n\t\t\t\tgravatar = null;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tgravatar = avatarData;\n\t\t\treturn false;\n\t\t});\n\t\tif (gravatar != null) {\n\t\t\tRocketChat.setUserAvatar(user, gravatar.blob, gravatar.contentType, 'gravatar');\n\t\t}\n\t}\n\t// Username is available; if coming from old username, update all references\n\tif (previousUsername) {\n\t\tRocketChat.models.Messages.updateAllUsernamesByUserId(user._id, username);\n\t\tRocketChat.models.Messages.updateUsernameOfEditByUserId(user._id, username);\n\t\tRocketChat.models.Messages.findByMention(previousUsername).forEach(function(msg) {\n\t\t\tconst updatedMsg = msg.msg.replace(new RegExp(`@${ previousUsername }`, 'ig'), `@${ username }`);\n\t\t\treturn RocketChat.models.Messages.updateUsernameAndMessageOfMentionByIdAndOldUsername(msg._id, previousUsername, username, updatedMsg);\n\t\t});\n\t\tRocketChat.models.Rooms.replaceUsername(previousUsername, username);\n\t\tRocketChat.models.Rooms.replaceMutedUsername(previousUsername, username);\n\t\tRocketChat.models.Rooms.replaceUsernameOfUserByUserId(user._id, username);\n\t\tRocketChat.models.Subscriptions.setUserUsernameByUserId(user._id, username);\n\t\tRocketChat.models.Subscriptions.setNameForDirectRoomsWithOldName(previousUsername, username);\n\t\tRocketChat.models.LivechatDepartmentAgents.replaceUsernameOfAgentByUserId(user._id, username);\n\n\t\tconst fileStore = FileUpload.getStore('Avatars');\n\t\tconst file = fileStore.model.findOneByName(previousUsername);\n\t\tif (file) {\n\t\t\tfileStore.model.updateFileNameById(file._id, username);\n\t\t}\n\t}\n\t// Set new username*\n\tRocketChat.models.Users.setUsername(user._id, username);\n\treturn user;\n};\n\nRocketChat.setUsername = RocketChat.RateLimiter.limitFunction(RocketChat._setUsername, 1, 60000, {\n\t[0](userId) {\n\t\treturn !userId || !RocketChat.authz.hasPermission(userId, 'edit-other-user-info');\n\t},\n});\n","import s from 'underscore.string';\n\nRocketChat._setRealName = function(userId, name) {\n\tname = s.trim(name);\n\tif (!userId || !name) {\n\t\treturn false;\n\t}\n\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// User already has desired name, return\n\tif (user.name === name) {\n\t\treturn user;\n\t}\n\n\t// Set new name\n\tRocketChat.models.Users.setName(user._id, name);\n\tuser.name = name;\n\n\tRocketChat.models.Subscriptions.updateDirectFNameByName(user.username, name);\n\n\tif (RocketChat.settings.get('UI_Use_Real_Name') === true) {\n\t\tRocketChat.Notifications.notifyLogged('Users:NameChanged', {\n\t\t\t_id: user._id,\n\t\t\tname: user.name,\n\t\t\tusername: user.username,\n\t\t});\n\t}\n\n\treturn user;\n};\n\nRocketChat.setRealName = RocketChat.RateLimiter.limitFunction(RocketChat._setRealName, 1, 60000, {\n\t0() { return !Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info'); }, // Administrators have permission to change others names, so don't limit those\n});\n","import s from 'underscore.string';\n\nRocketChat._setEmail = function(userId, email, shouldSendVerificationEmail = true) {\n\temail = s.trim(email);\n\tif (!userId) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: '_setEmail' });\n\t}\n\n\tif (!email) {\n\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email', { function: '_setEmail' });\n\t}\n\n\tRocketChat.validateEmailDomain(email);\n\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// User already has desired username, return\n\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\treturn user;\n\t}\n\n\t// Check email availability\n\tif (!RocketChat.checkEmailAvailability(email)) {\n\t\tthrow new Meteor.Error('error-field-unavailable', `${ email } is already in use :(`, { function: '_setEmail', field: email });\n\t}\n\n\t// Set new email\n\tRocketChat.models.Users.setEmail(user._id, email);\n\tuser.email = email;\n\tif (shouldSendVerificationEmail === true) {\n\t\tMeteor.call('sendConfirmationEmail', user.email);\n\t}\n\treturn user;\n};\n\nRocketChat.setEmail = RocketChat.RateLimiter.limitFunction(RocketChat._setEmail, 1, 60000, {\n\t0() { return !Meteor.userId() || !RocketChat.authz.hasPermission(Meteor.userId(), 'edit-other-user-info'); }, // Administrators have permission to change others emails, so don't limit those\n});\n","RocketChat.unarchiveRoom = function(rid) {\n\tRocketChat.models.Rooms.unarchiveById(rid);\n\tRocketChat.models.Subscriptions.unarchiveByRoomId(rid);\n};\n","RocketChat.updateMessage = function(message, user, originalMessage) {\n\tif (!originalMessage) {\n\t\toriginalMessage = RocketChat.models.Messages.findOneById(message._id);\n\t}\n\n\t// For the Rocket.Chat Apps :)\n\tif (message && Apps && Apps.isLoaded()) {\n\t\tconst appMessage = Object.assign({}, originalMessage, message);\n\n\t\tconst prevent = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageUpdatedPrevent', appMessage));\n\t\tif (prevent) {\n\t\t\tthrow new Meteor.Error('error-app-prevented-updating', 'A Rocket.Chat App prevented the message updating.');\n\t\t}\n\n\t\tlet result;\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageUpdatedExtend', appMessage));\n\t\tresult = Promise.await(Apps.getBridges().getListenerBridge().messageEvent('IPreMessageUpdatedModify', result));\n\n\t\tif (typeof result === 'object') {\n\t\t\tmessage = Object.assign(appMessage, result);\n\t\t}\n\t}\n\n\t// If we keep history of edits, insert a new message to store history information\n\tif (RocketChat.settings.get('Message_KeepHistory')) {\n\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t}\n\n\tmessage.editedAt = new Date();\n\tmessage.editedBy = {\n\t\t_id: user._id,\n\t\tusername: user.username,\n\t};\n\n\tconst urls = message.msg.match(/([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g) || [];\n\tmessage.urls = urls.map((url) => ({ url }));\n\n\tmessage = RocketChat.callbacks.run('beforeSaveMessage', message);\n\n\tconst tempid = message._id;\n\tdelete message._id;\n\n\tRocketChat.models.Messages.update({ _id: tempid }, { $set: message });\n\n\tconst room = RocketChat.models.Rooms.findOneById(message.rid);\n\n\tif (Apps && Apps.isLoaded()) {\n\t\t// This returns a promise, but it won't mutate anything about the message\n\t\t// so, we don't really care if it is successful or fails\n\t\tApps.getBridges().getListenerBridge().messageEvent('IPostMessageUpdated', message);\n\t}\n\n\tMeteor.defer(function() {\n\t\tRocketChat.callbacks.run('afterSaveMessage', RocketChat.models.Messages.findOneById(tempid), room, user._id);\n\t});\n};\n","import s from 'underscore.string';\n\nRocketChat.validateCustomFields = function(fields) {\n\t// Special Case:\n\t// If an admin didn't set any custom fields there's nothing to validate against so consider any customFields valid\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) === '') {\n\t\treturn;\n\t}\n\n\tlet customFieldsMeta;\n\ttry {\n\t\tcustomFieldsMeta = JSON.parse(RocketChat.settings.get('Accounts_CustomFields'));\n\t} catch (e) {\n\t\tthrow new Meteor.Error('error-invalid-customfield-json', 'Invalid JSON for Custom Fields');\n\t}\n\n\tconst customFields = {};\n\n\tObject.keys(customFieldsMeta).forEach((fieldName) => {\n\t\tconst field = customFieldsMeta[fieldName];\n\n\t\tcustomFields[fieldName] = fields[fieldName];\n\t\tconst fieldValue = s.trim(fields[fieldName]);\n\n\t\tif (field.required && fieldValue === '') {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Field ${ fieldName } is required`, { method: 'registerUser' });\n\t\t}\n\n\t\tif (field.type === 'select' && field.options.indexOf(fields[fieldName]) === -1) {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Value for field ${ fieldName } is invalid`, { method: 'registerUser' });\n\t\t}\n\n\t\tif (field.maxLength && fieldValue.length > field.maxLength) {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Max length of field ${ fieldName } ${ field.maxLength }`, { method: 'registerUser' });\n\t\t}\n\n\t\tif (field.minLength && fieldValue.length < field.minLength) {\n\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Min length of field ${ fieldName } ${ field.minLength }`, { method: 'registerUser' });\n\t\t}\n\t});\n};\n","RocketChat.Notifications = new class {\n\tconstructor() {\n\t\tthis.debug = false;\n\t\tthis.streamAll = new Meteor.Streamer('notify-all');\n\t\tthis.streamLogged = new Meteor.Streamer('notify-logged');\n\t\tthis.streamRoom = new Meteor.Streamer('notify-room');\n\t\tthis.streamRoomUsers = new Meteor.Streamer('notify-room-users');\n\t\tthis.streamUser = new Meteor.Streamer('notify-user');\n\t\tthis.streamAll.allowWrite('none');\n\t\tthis.streamLogged.allowWrite('none');\n\t\tthis.streamRoom.allowWrite('none');\n\t\tthis.streamRoomUsers.allowWrite(function(eventName, ...args) {\n\t\t\tconst [roomId, e] = eventName.split('/');\n\t\t\t// const user = Meteor.users.findOne(this.userId, {\n\t\t\t// \tfields: {\n\t\t\t// \t\tusername: 1\n\t\t\t// \t}\n\t\t\t// });\n\t\t\tif (RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(roomId, this.userId) != null) {\n\t\t\t\tconst subscriptions = RocketChat.models.Subscriptions.findByRoomIdAndNotUserId(roomId, this.userId).fetch();\n\t\t\t\tsubscriptions.forEach((subscription) => RocketChat.Notifications.notifyUser(subscription.u._id, e, ...args));\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tthis.streamUser.allowWrite('logged');\n\t\tthis.streamAll.allowRead('all');\n\t\tthis.streamLogged.allowRead('logged');\n\t\tthis.streamRoom.allowRead(function(eventName, extraData) {\n\t\t\tconst [roomId] = eventName.split('/');\n\t\t\tconst room = RocketChat.models.Rooms.findOneById(roomId);\n\t\t\tif (!room) {\n\t\t\t\tconsole.warn(`Invalid streamRoom eventName: \"${ eventName }\"`);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (room.t === 'l' && extraData && extraData.token && room.v.token === extraData.token) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (this.userId == null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(roomId, this.userId, { fields: { _id: 1 } });\n\t\t\treturn subscription != null;\n\t\t});\n\t\tthis.streamRoomUsers.allowRead('none');\n\t\tthis.streamUser.allowRead(function(eventName) {\n\t\t\tconst [userId] = eventName.split('/');\n\t\t\treturn (this.userId != null) && this.userId === userId;\n\t\t});\n\t}\n\n\tnotifyAll(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyAll', [eventName, ...args]);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamAll.emit.apply(this.streamAll, args);\n\t}\n\n\tnotifyLogged(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyLogged', [eventName, ...args]);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamLogged.emit.apply(this.streamLogged, args);\n\t}\n\n\tnotifyRoom(room, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyRoom', [room, eventName, ...args]);\n\t\t}\n\t\targs.unshift(`${ room }/${ eventName }`);\n\t\treturn this.streamRoom.emit.apply(this.streamRoom, args);\n\t}\n\n\tnotifyUser(userId, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyUser', [userId, eventName, ...args]);\n\t\t}\n\t\targs.unshift(`${ userId }/${ eventName }`);\n\t\treturn this.streamUser.emit.apply(this.streamUser, args);\n\t}\n\n\tnotifyAllInThisInstance(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyAll', [eventName, ...args]);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamAll.emitWithoutBroadcast.apply(this.streamAll, args);\n\t}\n\n\tnotifyLoggedInThisInstance(eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyLogged', [eventName, ...args]);\n\t\t}\n\t\targs.unshift(eventName);\n\t\treturn this.streamLogged.emitWithoutBroadcast.apply(this.streamLogged, args);\n\t}\n\n\tnotifyRoomInThisInstance(room, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyRoomAndBroadcast', [room, eventName, ...args]);\n\t\t}\n\t\targs.unshift(`${ room }/${ eventName }`);\n\t\treturn this.streamRoom.emitWithoutBroadcast.apply(this.streamRoom, args);\n\t}\n\n\tnotifyUserInThisInstance(userId, eventName, ...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log('notifyUserAndBroadcast', [userId, eventName, ...args]);\n\t\t}\n\t\targs.unshift(`${ userId }/${ eventName }`);\n\t\treturn this.streamUser.emitWithoutBroadcast.apply(this.streamUser, args);\n\t}\n};\n\nRocketChat.Notifications.streamRoom.allowWrite(function(eventName, username, typing, extraData) {\n\tconst [roomId, e] = eventName.split('/');\n\n\tif (e === 'webrtc') {\n\t\treturn true;\n\t}\n\tif (e === 'typing') {\n\t\tconst key = RocketChat.settings.get('UI_Use_Real_Name') ? 'name' : 'username';\n\t\t// typing from livechat widget\n\t\tif (extraData && extraData.token) {\n\t\t\tconst room = RocketChat.models.Rooms.findOneById(roomId);\n\t\t\tif (room && room.t === 'l' && room.v.token === extraData.token) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tconst user = Meteor.users.findOne(this.userId, {\n\t\t\tfields: {\n\t\t\t\t[key]: 1,\n\t\t\t},\n\t\t});\n\n\t\tif (!user) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn user[key] === username;\n\t}\n\treturn false;\n});\n","export function shouldNotifyAudio({\n\tdisableAllMessageNotifications,\n\tstatus,\n\taudioNotifications,\n\thasMentionToAll,\n\thasMentionToHere,\n\tisHighlighted,\n\thasMentionToUser,\n\troomType,\n}) {\n\tif (disableAllMessageNotifications && audioNotifications == null) {\n\t\treturn false;\n\t}\n\n\tif (status === 'busy' || audioNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\tif (!audioNotifications && RocketChat.settings.get('Accounts_Default_User_Preferences_audioNotifications') === 'all') {\n\t\treturn true;\n\t}\n\n\treturn roomType === 'd' || (!disableAllMessageNotifications && (hasMentionToAll || hasMentionToHere)) || isHighlighted || audioNotifications === 'all' || hasMentionToUser;\n}\n\nexport function notifyAudioUser(userId, message, room) {\n\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'audio' });\n\tRocketChat.Notifications.notifyUser(userId, 'audioNotification', {\n\t\tpayload: {\n\t\t\t_id: message._id,\n\t\t\trid: message.rid,\n\t\t\tsender: message.u,\n\t\t\ttype: room.t,\n\t\t\tname: room.name,\n\t\t},\n\t});\n}\n","/**\n * Send notification to user\n *\n * @param {string} userId The user to notify\n * @param {object} user The sender\n * @param {object} room The room send from\n * @param {object} message The message object\n * @param {number} duration Duration of notification\n * @param {string} notificationMessage The message text to send on notification body\n */\nexport function notifyDesktopUser({\n\tuserId,\n\tuser,\n\tmessage,\n\troom,\n\tduration,\n\tnotificationMessage,\n}) {\n\tconst { title, text } = RocketChat.roomTypes.getConfig(room.t).getNotificationDetails(room, user, notificationMessage);\n\n\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'desktop' });\n\tRocketChat.Notifications.notifyUser(userId, 'notification', {\n\t\ttitle,\n\t\ttext,\n\t\tduration,\n\t\tpayload: {\n\t\t\t_id: message._id,\n\t\t\trid: message.rid,\n\t\t\tsender: message.u,\n\t\t\ttype: room.t,\n\t\t\tname: room.name,\n\t\t\tmessage: {\n\t\t\t\tmsg: message.msg,\n\t\t\t\tt: message.t,\n\t\t\t},\n\t\t},\n\t});\n}\n\nexport function shouldNotifyDesktop({\n\tdisableAllMessageNotifications,\n\tstatus,\n\tdesktopNotifications,\n\thasMentionToAll,\n\thasMentionToHere,\n\tisHighlighted,\n\thasMentionToUser,\n\troomType,\n}) {\n\tif (disableAllMessageNotifications && desktopNotifications == null) {\n\t\treturn false;\n\t}\n\n\tif (status === 'busy' || desktopNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\tif (!desktopNotifications) {\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_desktopNotifications') === 'all') {\n\t\t\treturn true;\n\t\t}\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_desktopNotifications') === 'nothing') {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn roomType === 'd' || (!disableAllMessageNotifications && (hasMentionToAll || hasMentionToHere)) || isHighlighted || desktopNotifications === 'all' || hasMentionToUser;\n}\n","import s from 'underscore.string';\nimport * as Mailer from 'meteor/rocketchat:mailer';\n\nlet advice = '';\nlet goToMessage = '';\nMeteor.startup(() => {\n\tRocketChat.settings.get('email_style', function() {\n\t\tgoToMessage = Mailer.inlinecss('<p><a class=\\'btn\\' href=\"[room_path]\">{Offline_Link_Message}</a></p>');\n\t});\n\tMailer.getTemplate('Email_Footer_Direct_Reply', (value) => {\n\t\tadvice = value;\n\t});\n});\n\nfunction getEmailContent({ message, user, room }) {\n\tconst lng = (user && user.language) || RocketChat.settings.get('language') || 'en';\n\n\tconst roomName = s.escapeHTML(`#${ RocketChat.roomTypes.getRoomName(room.t, room) }`);\n\tconst userName = s.escapeHTML(RocketChat.settings.get('UI_Use_Real_Name') ? message.u.name || message.u.username : message.u.username);\n\n\tconst header = TAPi18n.__(room.t === 'd' ? 'User_sent_a_message_to_you' : 'User_sent_a_message_on_channel', {\n\t\tusername: userName,\n\t\tchannel: roomName,\n\t\tlng,\n\t});\n\n\tif (message.msg !== '') {\n\t\tlet messageContent = s.escapeHTML(message.msg);\n\n\t\tif (message.t === 'e2e') {\n\t\t\tmessageContent = TAPi18n.__('Encrypted_message', { lng });\n\t\t}\n\n\t\tmessage = RocketChat.callbacks.run('renderMessage', message);\n\t\tif (message.tokens && message.tokens.length > 0) {\n\t\t\tmessage.tokens.forEach((token) => {\n\t\t\t\ttoken.text = token.text.replace(/([^\\$])(\\$[^\\$])/gm, '$1$$$2');\n\t\t\t\tmessageContent = messageContent.replace(token.token, token.text);\n\t\t\t});\n\t\t}\n\t\treturn `${ header }<br/><br/>${ messageContent.replace(/\\n/gm, '<br/>') }`;\n\t}\n\n\tif (message.file) {\n\t\tconst fileHeader = TAPi18n.__(room.t === 'd' ? 'User_uploaded_a_file_to_you' : 'User_uploaded_a_file_on_channel', {\n\t\t\tusername: userName,\n\t\t\tchannel: roomName,\n\t\t\tlng,\n\t\t});\n\n\t\tlet content = `${ TAPi18n.__('Attachment_File_Uploaded') }: ${ s.escapeHTML(message.file.name) }`;\n\n\t\tif (message.attachments && message.attachments.length === 1 && message.attachments[0].description !== '') {\n\t\t\tcontent += `<br/><br/>${ s.escapeHTML(message.attachments[0].description) }`;\n\t\t}\n\n\t\treturn `${ fileHeader }<br/><br/>${ content }`;\n\t}\n\n\tif (message.attachments.length > 0) {\n\t\tconst [attachment] = message.attachments;\n\n\t\tlet content = '';\n\n\t\tif (attachment.title) {\n\t\t\tcontent += `${ s.escapeHTML(attachment.title) }<br/>`;\n\t\t}\n\t\tif (attachment.text) {\n\t\t\tcontent += `${ s.escapeHTML(attachment.text) }<br/>`;\n\t\t}\n\n\t\treturn `${ header }<br/><br/>${ content }`;\n\t}\n\n\treturn header;\n}\n\nexport function sendEmail({ message, user, subscription, room, emailAddress, hasMentionToUser }) {\n\tconst username = RocketChat.settings.get('UI_Use_Real_Name') ? message.u.name : message.u.username;\n\tlet subjectKey = 'Offline_Mention_All_Email';\n\n\tif (room.t === 'd') {\n\t\tsubjectKey = 'Offline_DM_Email';\n\t} else if (hasMentionToUser) {\n\t\tsubjectKey = 'Offline_Mention_Email';\n\t}\n\n\tconst emailSubject = Mailer.replace(RocketChat.settings.get(subjectKey), {\n\t\tuser: username,\n\t\troom: RocketChat.roomTypes.getRoomName(room.t, room),\n\t});\n\tconst content = getEmailContent({\n\t\tmessage,\n\t\tuser,\n\t\troom,\n\t});\n\n\tconst room_path = RocketChat.roomTypes.getURL(room.t, subscription);\n\n\tconst email = {\n\t\tto: emailAddress,\n\t\tsubject: emailSubject,\n\t\thtml: content + goToMessage + (RocketChat.settings.get('Direct_Reply_Enable') ? advice : ''),\n\t\tdata: {\n\t\t\troom_path,\n\t\t},\n\t};\n\n\tconst from = room.t === 'd' ? message.u.name : room.name;\t// using user full-name/channel name in from address\n\temail.from = `${ String(from).replace(/@/g, '%40').replace(/[<>,]/g, '') } <${ RocketChat.settings.get('From_Email') }>`;\n\t// If direct reply enabled, email content with headers\n\tif (RocketChat.settings.get('Direct_Reply_Enable')) {\n\t\tconst replyto = RocketChat.settings.get('Direct_Reply_ReplyTo') || RocketChat.settings.get('Direct_Reply_Username');\n\t\temail.headers = {\n\t\t\t// Reply-To header with format \"username+messageId@domain\"\n\t\t\t'Reply-To': `${ replyto.split('@')[0].split(RocketChat.settings.get('Direct_Reply_Separator'))[0] }${ RocketChat.settings.get('Direct_Reply_Separator') }${ message._id }@${ replyto.split('@')[1] }`,\n\t\t};\n\t}\n\n\tRocketChat.metrics.notificationsSent.inc({ notification_type: 'email' });\n\treturn Mailer.send(email);\n}\n\nexport function shouldNotifyEmail({\n\tdisableAllMessageNotifications,\n\tstatusConnection,\n\temailNotifications,\n\tisHighlighted,\n\thasMentionToUser,\n\thasMentionToAll,\n\troomType,\n}) {\n\n\t// use connected (don't need to send him an email)\n\tif (statusConnection === 'online') {\n\t\treturn false;\n\t}\n\n\t// user/room preference to nothing\n\tif (emailNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\t// no user or room preference\n\tif (emailNotifications == null) {\n\t\tif (disableAllMessageNotifications) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// default server preference is disabled\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_emailNotificationMode') === 'nothing') {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn roomType === 'd' || isHighlighted || emailNotifications === 'all' || hasMentionToUser || (!disableAllMessageNotifications && hasMentionToAll);\n}\n","import s from 'underscore.string';\n\n/**\n* This function returns a string ready to be shown in the notification\n*\n* @param {object} message the message to be parsed\n*/\nexport function parseMessageTextPerUser(messageText, message, receiver) {\n\tif (!message.msg && message.attachments && message.attachments[0]) {\n\t\tconst lng = receiver.language || RocketChat.settings.get('language') || 'en';\n\n\t\treturn message.attachments[0].image_type ? TAPi18n.__('User_uploaded_image', { lng }) : TAPi18n.__('User_uploaded_file', { lng });\n\t}\n\n\tif (message.msg && message.t === 'e2e') {\n\t\tconst lng = receiver.language || RocketChat.settings.get('language') || 'en';\n\n\t\treturn TAPi18n.__('Encrypted_message', { lng });\n\t}\n\n\treturn messageText;\n}\n\n/**\n * Replaces @username with full name\n *\n * @param {string} message The message to replace\n * @param {object[]} mentions Array of mentions used to make replacements\n *\n * @returns {string}\n */\nexport function replaceMentionedUsernamesWithFullNames(message, mentions) {\n\tif (!mentions || !mentions.length) {\n\t\treturn message;\n\t}\n\tmentions.forEach((mention) => {\n\t\tif (mention.name) {\n\t\t\tmessage = message.replace(new RegExp(s.escapeRegExp(`@${ mention.username }`), 'g'), mention.name);\n\t\t}\n\t});\n\treturn message;\n}\n\n/**\n * Checks if a message contains a user highlight\n *\n * @param {string} message\n * @param {array|undefined} highlights\n *\n * @returns {boolean}\n */\nexport function messageContainsHighlight(message, highlights) {\n\tif (! highlights || highlights.length === 0) { return false; }\n\n\treturn highlights.some(function(highlight) {\n\t\tconst regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\treturn regexp.test(message.msg);\n\t});\n}\n\nexport function callJoinRoom(userId, rid) {\n\treturn new Promise((resolve, reject) => {\n\t\tMeteor.runAsUser(userId, () => Meteor.call('joinRoom', rid, (error, result) => {\n\t\t\tif (error) {\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\treturn resolve(result);\n\t\t}));\n\t});\n}\n","const CATEGORY_MESSAGE = 'MESSAGE';\nconst CATEGORY_MESSAGE_NOREPLY = 'MESSAGE_NOREPLY';\n\nlet alwaysNotifyMobileBoolean;\nRocketChat.settings.get('Notifications_Always_Notify_Mobile', (key, value) => {\n\talwaysNotifyMobileBoolean = value;\n});\n\nlet SubscriptionRaw;\nMeteor.startup(() => {\n\tSubscriptionRaw = RocketChat.models.Subscriptions.model.rawCollection();\n});\n\nasync function getBadgeCount(userId) {\n\tconst [result] = await SubscriptionRaw.aggregate([\n\t\t{ $match: { 'u._id': userId } },\n\t\t{\n\t\t\t$group: {\n\t\t\t\t_id: 'total',\n\t\t\t\ttotal: { $sum: '$unread' },\n\t\t\t},\n\t\t},\n\t]).toArray();\n\n\tconst { total } = result;\n\treturn total;\n}\n\nfunction canSendMessageToRoom(room, username) {\n\treturn !((room.muted || []).includes(username));\n}\n\nexport async function sendSinglePush({ room, message, userId, receiverUsername, senderUsername, senderName, notificationMessage }) {\n\tlet username = '';\n\tif (RocketChat.settings.get('Push_show_username_room')) {\n\t\tusername = RocketChat.settings.get('UI_Use_Real_Name') === true ? senderName : senderUsername;\n\t}\n\n\tRocketChat.PushNotification.send({\n\t\troomId: message.rid,\n\t\tpayload: {\n\t\t\thost: Meteor.absoluteUrl(),\n\t\t\trid: message.rid,\n\t\t\tsender: message.u,\n\t\t\ttype: room.t,\n\t\t\tname: room.name,\n\t\t},\n\t\troomName: RocketChat.settings.get('Push_show_username_room') && room.t !== 'd' ? `#${ RocketChat.roomTypes.getRoomName(room.t, room) }` : '',\n\t\tusername,\n\t\tmessage: RocketChat.settings.get('Push_show_message') ? notificationMessage : ' ',\n\t\tbadge: await getBadgeCount(userId),\n\t\tusersTo: {\n\t\t\tuserId,\n\t\t},\n\t\tcategory: canSendMessageToRoom(room, receiverUsername) ? CATEGORY_MESSAGE : CATEGORY_MESSAGE_NOREPLY,\n\t});\n}\n\nexport function shouldNotifyMobile({\n\tdisableAllMessageNotifications,\n\tmobilePushNotifications,\n\thasMentionToAll,\n\tisHighlighted,\n\thasMentionToUser,\n\tstatusConnection,\n\troomType,\n}) {\n\tif (disableAllMessageNotifications && mobilePushNotifications == null) {\n\t\treturn false;\n\t}\n\n\tif (mobilePushNotifications === 'nothing') {\n\t\treturn false;\n\t}\n\n\tif (!alwaysNotifyMobileBoolean && statusConnection === 'online') {\n\t\treturn false;\n\t}\n\n\tif (!mobilePushNotifications) {\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_mobileNotifications') === 'all') {\n\t\t\treturn true;\n\t\t}\n\t\tif (RocketChat.settings.get('Accounts_Default_User_Preferences_mobileNotifications') === 'nothing') {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn roomType === 'd' || (!disableAllMessageNotifications && hasMentionToAll) || isHighlighted || mobilePushNotifications === 'all' || hasMentionToUser;\n}\n","import ModelsBaseDb from './_BaseDb';\nimport objectPath from 'object-path';\nimport _ from 'underscore';\n\nclass ModelsBase {\n\tconstructor(nameOrModel) {\n\t\tthis._db = new ModelsBaseDb(nameOrModel, this);\n\t\tthis.model = this._db.model;\n\t\tthis.collectionName = this._db.collectionName;\n\t\tthis.name = this._db.name;\n\n\t\tthis.on = this._db.on.bind(this._db);\n\t\tthis.emit = this._db.emit.bind(this._db);\n\n\t\tthis.db = this;\n\t}\n\n\tget origin() {\n\t\treturn '_db';\n\t}\n\n\tarrayToCursor(data) {\n\t\treturn {\n\t\t\tfetch() {\n\t\t\t\treturn data;\n\t\t\t},\n\t\t\tcount() {\n\t\t\t\treturn data.length;\n\t\t\t},\n\t\t\tforEach(fn) {\n\t\t\t\treturn data.forEach(fn);\n\t\t\t},\n\t\t};\n\t}\n\n\tsetUpdatedAt(...args/* record, checkQuery, query*/) {\n\t\treturn this._db.setUpdatedAt(...args);\n\t}\n\n\tfind(...args) {\n\t\ttry {\n\t\t\treturn this[this.origin].find(...args);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...args);\n\t\t}\n\t}\n\n\tfindOne(...args) {\n\t\ttry {\n\t\t\treturn this[this.origin].findOne(...args);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...args);\n\t\t}\n\t}\n\n\tfindOneById(...args) {\n\t\ttry {\n\t\t\treturn this[this.origin].findOneById(...args);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...args);\n\t\t}\n\t}\n\n\tfindOneByIds(ids, options, ...args) {\n\t\tcheck(ids, [String]);\n\n\t\ttry {\n\t\t\treturn this[this.origin].findOneByIds(ids, options);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, [ids, options, ...args]);\n\t\t}\n\t}\n\n\tinsert(...args/* record*/) {\n\t\treturn this._db.insert(...args);\n\t}\n\n\tupdate(...args/* query, update, options*/) {\n\t\treturn this._db.update(...args);\n\t}\n\n\tupsert(...args/* query, update*/) {\n\t\treturn this._db.upsert(...args);\n\t}\n\n\tremove(...args/* query*/) {\n\t\treturn this._db.remove(...args);\n\t}\n\n\tinsertOrUpsert(...args) {\n\t\treturn this._db.insertOrUpsert(...args);\n\t}\n\n\tallow(...args) {\n\t\treturn this._db.allow(...args);\n\t}\n\n\tdeny(...args) {\n\t\treturn this._db.deny(...args);\n\t}\n\n\tensureIndex(...args) {\n\t\treturn this._db.ensureIndex(...args);\n\t}\n\n\tdropIndex(...args) {\n\t\treturn this._db.dropIndex(...args);\n\t}\n\n\ttryEnsureIndex(...args) {\n\t\treturn this._db.tryEnsureIndex(...args);\n\t}\n\n\ttryDropIndex(...args) {\n\t\treturn this._db.tryDropIndex(...args);\n\t}\n\n\ttrashFind(...args/* query, options*/) {\n\t\treturn this._db.trashFind(...args);\n\t}\n\n\ttrashFindOneById(...args/* _id, options*/) {\n\t\treturn this._db.trashFindOneById(...args);\n\t}\n\n\ttrashFindDeletedAfter(...args/* deletedAt, query, options*/) {\n\t\treturn this._db.trashFindDeletedAfter(...args);\n\t}\n\n\tprocessQueryOptionsOnResult(result, options = {}) {\n\t\tif (result === undefined || result === null) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (Array.isArray(result)) {\n\t\t\tif (options.sort) {\n\t\t\t\tresult = result.sort((a, b) => {\n\t\t\t\t\tlet r = 0;\n\t\t\t\t\tfor (const field in options.sort) {\n\t\t\t\t\t\tif (options.sort.hasOwnProperty(field)) {\n\t\t\t\t\t\t\tconst direction = options.sort[field];\n\t\t\t\t\t\t\tlet valueA;\n\t\t\t\t\t\t\tlet valueB;\n\t\t\t\t\t\t\tif (field.indexOf('.') > -1) {\n\t\t\t\t\t\t\t\tvalueA = objectPath.get(a, field);\n\t\t\t\t\t\t\t\tvalueB = objectPath.get(b, field);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalueA = a[field];\n\t\t\t\t\t\t\t\tvalueB = b[field];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA > valueB) {\n\t\t\t\t\t\t\t\tr = direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA < valueB) {\n\t\t\t\t\t\t\t\tr = -direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn r;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (typeof options.skip === 'number') {\n\t\t\t\tresult.splice(0, options.skip);\n\t\t\t}\n\n\t\t\tif (typeof options.limit === 'number' && options.limit !== 0) {\n\t\t\t\tresult.splice(options.limit);\n\t\t\t}\n\t\t}\n\n\t\tif (!options.fields) {\n\t\t\toptions.fields = {};\n\t\t}\n\n\t\tconst fieldsToRemove = [];\n\t\tconst fieldsToGet = [];\n\n\t\tfor (const field in options.fields) {\n\t\t\tif (options.fields.hasOwnProperty(field)) {\n\t\t\t\tif (options.fields[field] === 0) {\n\t\t\t\t\tfieldsToRemove.push(field);\n\t\t\t\t} else if (options.fields[field] === 1) {\n\t\t\t\t\tfieldsToGet.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (fieldsToRemove.length > 0 && fieldsToGet.length > 0) {\n\t\t\tconsole.warn('Can\\'t mix remove and get fields');\n\t\t\tfieldsToRemove.splice(0, fieldsToRemove.length);\n\t\t}\n\n\t\tif (fieldsToGet.length > 0 && fieldsToGet.indexOf('_id') === -1) {\n\t\t\tfieldsToGet.push('_id');\n\t\t}\n\n\t\tconst pickFields = (obj, fields) => {\n\t\t\tconst picked = {};\n\t\t\tfields.forEach((field) => {\n\t\t\t\tif (field.indexOf('.') !== -1) {\n\t\t\t\t\tobjectPath.set(picked, field, objectPath.get(obj, field));\n\t\t\t\t} else {\n\t\t\t\t\tpicked[field] = obj[field];\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn picked;\n\t\t};\n\n\t\tif (fieldsToRemove.length > 0 || fieldsToGet.length > 0) {\n\t\t\tif (Array.isArray(result)) {\n\t\t\t\tresult = result.map((record) => {\n\t\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\t\treturn _.omit(record, ...fieldsToRemove);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\t\treturn pickFields(record, fieldsToGet);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\treturn _.omit(result, ...fieldsToRemove);\n\t\t\t\t}\n\n\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\treturn pickFields(result, fieldsToGet);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t// dinamicTrashFindAfter(method, deletedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}) => {\n\t// \t\t\treturn this.trashFindDeletedAfter(deletedAt, query, { fields: {_id: 1, _deletedAt: 1} });\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindAfter(method, updatedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}, options) => {\n\t// \t\t\tquery._updatedAt = {\n\t// \t\t\t\t$gt: updatedAt\n\t// \t\t\t};\n\n\t// \t\t\treturn this.find(query, options);\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindChangesAfter(method, updatedAt, ...args) {\n\t// \treturn {\n\t// \t\tupdate: this.dinamicFindAfter(method, updatedAt, ...args).fetch(),\n\t// \t\tremove: this.dinamicTrashFindAfter(method, updatedAt, ...args).fetch()\n\t// \t};\n\t// }\n\n}\n\nRocketChat.models._Base = ModelsBase;\n","/* globals InstanceStatus */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.models.Avatars = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('avatars');\n\n\t\tthis.model.before.insert((userId, doc) => {\n\t\t\tdoc.instanceId = InstanceStatus.id();\n\t\t});\n\n\t\tthis.tryEnsureIndex({ name: 1 });\n\t}\n\n\tinsertAvatarFileInit(name, userId, store, file, extra) {\n\t\tconst fileData = {\n\t\t\t_id: name,\n\t\t\tname,\n\t\t\tuserId,\n\t\t\tstore,\n\t\t\tcomplete: false,\n\t\t\tuploading: true,\n\t\t\tprogress: 0,\n\t\t\textension: s.strRightBack(file.name, '.'),\n\t\t\tuploadedAt: new Date(),\n\t\t};\n\n\t\t_.extend(fileData, file, extra);\n\n\t\treturn this.insertOrUpsert(fileData);\n\t}\n\n\tupdateFileComplete(fileId, userId, file) {\n\t\tif (!fileId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filter = {\n\t\t\t_id: fileId,\n\t\t\tuserId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcomplete: true,\n\t\t\t\tuploading: false,\n\t\t\t\tprogress: 1,\n\t\t\t},\n\t\t};\n\n\t\tupdate.$set = _.extend(file, update.$set);\n\n\t\tif (this.model.direct && this.model.direct.update) {\n\t\t\treturn this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\treturn this.update(filter, update);\n\t\t}\n\t}\n\n\tfindOneByName(name) {\n\t\treturn this.findOne({ name });\n\t}\n\n\tupdateFileNameById(fileId, name) {\n\t\tconst filter = { _id: fileId };\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname,\n\t\t\t},\n\t\t};\n\t\tif (this.model.direct && this.model.direct.update) {\n\t\t\treturn this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\treturn this.update(filter, update);\n\t\t}\n\t}\n\n\t// @TODO deprecated\n\tupdateFileCompleteByNameAndUserId(name, userId, url) {\n\t\tif (!name) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filter = {\n\t\t\tname,\n\t\t\tuserId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcomplete: true,\n\t\t\t\tuploading: false,\n\t\t\t\tprogress: 1,\n\t\t\t\turl,\n\t\t\t},\n\t\t};\n\n\t\tif (this.model.direct && this.model.direct.update) {\n\t\t\treturn this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\treturn this.update(filter, update);\n\t\t}\n\t}\n\n\tdeleteFile(fileId) {\n\t\tif (this.model.direct && this.model.direct.remove) {\n\t\t\treturn this.model.direct.remove({ _id: fileId });\n\t\t} else {\n\t\t\treturn this.remove({ _id: fileId });\n\t\t}\n\t}\n};\n","import _ from 'underscore';\n\nRocketChat.models.Messages = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('message');\n\n\t\tthis.tryEnsureIndex({ rid: 1, ts: 1 });\n\t\tthis.tryEnsureIndex({ ts: 1 });\n\t\tthis.tryEnsureIndex({ 'u._id': 1 });\n\t\tthis.tryEnsureIndex({ editedAt: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'editedBy._id': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ rid: 1, t: 1, 'u._id': 1 });\n\t\tthis.tryEnsureIndex({ expireAt: 1 }, { expireAfterSeconds: 0 });\n\t\tthis.tryEnsureIndex({ msg: 'text' });\n\t\tthis.tryEnsureIndex({ 'file._id': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'mentions.username': 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ pinned: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ snippeted: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ location: '2dsphere' });\n\t\tthis.tryEnsureIndex({ slackBotId: 1, slackTs: 1 }, { sparse: 1 });\n\t}\n\n\tcountVisibleByRoomIdBetweenTimestampsInclusive(roomId, afterTimestamp, beforeTimestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gte: afterTimestamp,\n\t\t\t\t$lte: beforeTimestamp,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options).count();\n\t}\n\n\t// FIND\n\tfindByMention(username, options) {\n\t\tconst query =\t{ 'mentions.username': username };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindFilesByUserId(userId, options = {}) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\t'file._id': { $exists: true },\n\t\t};\n\t\treturn this.find(query, { fields: { 'file._id': 1 }, ...options });\n\t}\n\n\tfindFilesByRoomIdPinnedTimestampAndUsers(rid, excludePinned, ts, users = [], options = {}) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\tts,\n\t\t\t'file._id': { $exists: true },\n\t\t};\n\n\t\tif (excludePinned) {\n\t\t\tquery.pinned = { $ne: true };\n\t\t}\n\n\t\tif (users.length) {\n\t\t\tquery['u.username'] = { $in: users };\n\t\t}\n\n\t\treturn this.find(query, { fields: { 'file._id': 1 }, ...options });\n\t}\n\tfindVisibleByMentionAndRoomId(username, rid, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\t'mentions.username': username,\n\t\t\trid,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomId(roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\n\t\t\trid: roomId,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdNotContainingTypes(roomId, types, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\n\t\t\trid: roomId,\n\t\t};\n\n\t\tif (Match.test(types, [String]) && (types.length > 0)) {\n\t\t\tquery.t =\n\t\t\t{ $nin: types };\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindInvisibleByRoomId(roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: true,\n\t\t\trid: roomId,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdAfterTimestamp(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gt: timestamp,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindForUpdates(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: timestamp,\n\t\t\t},\n\t\t};\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBeforeTimestamp(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$lt: timestamp,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBeforeTimestampInclusive(roomId, timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$lte: timestamp,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBetweenTimestamps(roomId, afterTimestamp, beforeTimestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gt: afterTimestamp,\n\t\t\t\t$lt: beforeTimestamp,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBetweenTimestampsInclusive(roomId, afterTimestamp, beforeTimestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gte: afterTimestamp,\n\t\t\t\t$lte: beforeTimestamp,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBeforeTimestampNotContainingTypes(roomId, timestamp, types, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$lt: timestamp,\n\t\t\t},\n\t\t};\n\n\t\tif (Match.test(types, [String]) && (types.length > 0)) {\n\t\t\tquery.t =\n\t\t\t{ $nin: types };\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleByRoomIdBetweenTimestampsNotContainingTypes(roomId, afterTimestamp, beforeTimestamp, types, options) {\n\t\tconst query = {\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t\trid: roomId,\n\t\t\tts: {\n\t\t\t\t$gt: afterTimestamp,\n\t\t\t\t$lt: beforeTimestamp,\n\t\t\t},\n\t\t};\n\n\t\tif (Match.test(types, [String]) && (types.length > 0)) {\n\t\t\tquery.t =\n\t\t\t{ $nin: types };\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindVisibleCreatedOrEditedAfterTimestamp(timestamp, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\t$or: [{\n\t\t\t\tts: {\n\t\t\t\t\t$gt: timestamp,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\teditedAt: {\n\t\t\t\t\t$gt: timestamp,\n\t\t\t\t},\n\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindStarredByUserAtRoom(userId, roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\t'starred._id': userId,\n\t\t\trid: roomId,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindPinnedByRoom(roomId, options) {\n\t\tconst query = {\n\t\t\tt: { $ne: 'rm' },\n\t\t\t_hidden: { $ne: true },\n\t\t\tpinned: true,\n\t\t\trid: roomId,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindSnippetedByRoom(roomId, options) {\n\t\tconst query = {\n\t\t\t_hidden: { $ne: true },\n\t\t\tsnippeted: true,\n\t\t\trid: roomId,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastTimestamp(options) {\n\t\tif (options == null) { options = {}; }\n\t\tconst query = { ts: { $exists: 1 } };\n\t\toptions.sort = { ts: -1 };\n\t\toptions.limit = 1;\n\t\tconst [message] = this.find(query, options).fetch();\n\t\treturn message && message.ts;\n\t}\n\n\tfindByRoomIdAndMessageIds(rid, messageIds, options) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t_id: {\n\t\t\t\t$in: messageIds,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindOneBySlackBotIdAndSlackTs(slackBotId, slackTs) {\n\t\tconst query = {\n\t\t\tslackBotId,\n\t\t\tslackTs,\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindOneBySlackTs(slackTs) {\n\t\tconst query = { slackTs };\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindByRoomIdAndType(roomId, type, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\tt: type,\n\t\t};\n\n\t\tif (options == null) { options = {}; }\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomId(roomId, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastVisibleMessageSentWithNoTypeByRoomId(rid, messageId) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t_hidden: { $ne: true },\n\t\t\tt: { $exists: false },\n\t\t};\n\n\t\tif (messageId) {\n\t\t\tquery._id = { $ne: messageId };\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\tts: -1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tcloneAndSaveAsHistoryById(_id) {\n\t\tconst me = RocketChat.models.Users.findOneById(Meteor.userId());\n\t\tconst record = this.findOneById(_id);\n\t\trecord._hidden = true;\n\t\trecord.parent = record._id;\n\t\trecord.editedAt = new Date;\n\t\trecord.editedBy = {\n\t\t\t_id: Meteor.userId(),\n\t\t\tusername: me.username,\n\t\t};\n\t\tdelete record._id;\n\t\treturn this.insert(record);\n\t}\n\n\t// UPDATE\n\tsetHiddenById(_id, hidden) {\n\t\tif (hidden == null) { hidden = true; }\n\t\tconst query =\t{ _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t_hidden: hidden,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAsDeletedByIdAndUser(_id, user) {\n\t\tconst query =\t{ _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tmsg: '',\n\t\t\t\tt: 'rm',\n\t\t\t\turls: [],\n\t\t\t\tmentions: [],\n\t\t\t\tattachments: [],\n\t\t\t\treactions: [],\n\t\t\t\teditedAt: new Date(),\n\t\t\t\teditedBy: {\n\t\t\t\t\t_id: user._id,\n\t\t\t\t\tusername: user.username,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetPinnedByIdAndUserId(_id, pinnedBy, pinned, pinnedAt) {\n\t\tif (pinned == null) { pinned = true; }\n\t\tif (pinnedAt == null) { pinnedAt = 0; }\n\t\tconst query =\t{ _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tpinned,\n\t\t\t\tpinnedAt: pinnedAt || new Date,\n\t\t\t\tpinnedBy,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetSnippetedByIdAndUserId(message, snippetName, snippetedBy, snippeted, snippetedAt) {\n\t\tif (snippeted == null) { snippeted = true; }\n\t\tif (snippetedAt == null) { snippetedAt = 0; }\n\t\tconst query =\t{ _id: message._id };\n\n\t\tconst msg = `\\`\\`\\`${ message.msg }\\`\\`\\``;\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tmsg,\n\t\t\t\tsnippeted,\n\t\t\t\tsnippetedAt: snippetedAt || new Date,\n\t\t\t\tsnippetedBy,\n\t\t\t\tsnippetName,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetUrlsById(_id, urls) {\n\t\tconst query =\t{ _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\turls,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateAllUsernamesByUserId(userId, username) {\n\t\tconst query =\t{ 'u._id': userId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'u.username': username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateUsernameOfEditByUserId(userId, username) {\n\t\tconst query =\t{ 'editedBy._id': userId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'editedBy.username': username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateUsernameAndMessageOfMentionByIdAndOldUsername(_id, oldUsername, newUsername, newMessage) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\t'mentions.username': oldUsername,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'mentions.$.username': newUsername,\n\t\t\t\tmsg: newMessage,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateUserStarById(_id, userId, starred) {\n\t\tlet update;\n\t\tconst query =\t{ _id };\n\n\t\tif (starred) {\n\t\t\tupdate = {\n\t\t\t\t$addToSet: {\n\t\t\t\t\tstarred: { _id: userId },\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tupdate = {\n\t\t\t\t$pull: {\n\t\t\t\t\tstarred: { _id: Meteor.userId() },\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupgradeEtsToEditAt() {\n\t\tconst query =\t{ ets: { $exists: 1 } };\n\n\t\tconst update = {\n\t\t\t$rename: {\n\t\t\t\tets: 'editedAt',\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetMessageAttachments(_id, attachments) {\n\t\tconst query =\t{ _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tattachments,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetSlackBotIdAndSlackTs(_id, slackBotId, slackTs) {\n\t\tconst query =\t{ _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tslackBotId,\n\t\t\t\tslackTs,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tunlinkUserId(userId, newUserId, newUsername, newNameAlias) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talias: newNameAlias,\n\t\t\t\t'u._id': newUserId,\n\t\t\t\t'u.username' : newUsername,\n\t\t\t\t'u.name' : undefined,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\t// INSERT\n\tcreateWithTypeRoomIdMessageAndUser(type, roomId, message, user, extraData) {\n\t\tconst room = RocketChat.models.Rooms.findOneById(roomId, { fields: { sysMes: 1 } });\n\t\tif ((room != null ? room.sysMes : undefined) === false) {\n\t\t\treturn;\n\t\t}\n\t\tconst record = {\n\t\t\tt: type,\n\t\t\trid: roomId,\n\t\t\tts: new Date,\n\t\t\tmsg: message,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username,\n\t\t\t},\n\t\t\tgroupable: false,\n\t\t};\n\n\t\tif (RocketChat.settings.get('Message_Read_Receipt_Enabled')) {\n\t\t\trecord.unread = true;\n\t\t}\n\n\t\t_.extend(record, extraData);\n\n\t\trecord._id = this.insertOrUpsert(record);\n\t\tRocketChat.models.Rooms.incMsgCountById(room._id, 1);\n\t\treturn record;\n\t}\n\n\tcreateNavigationHistoryWithRoomIdMessageAndUser(roomId, message, user, extraData) {\n\t\tconst type = 'livechat_navigation_history';\n\t\tconst room = RocketChat.models.Rooms.findOneById(roomId, { fields: { sysMes: 1 } });\n\t\tif ((room != null ? room.sysMes : undefined) === false) {\n\t\t\treturn;\n\t\t}\n\t\tconst record = {\n\t\t\tt: type,\n\t\t\trid: roomId,\n\t\t\tts: new Date,\n\t\t\tmsg: message,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username,\n\t\t\t},\n\t\t\tgroupable: false,\n\t\t};\n\n\t\tif (RocketChat.settings.get('Message_Read_Receipt_Enabled')) {\n\t\t\trecord.unread = true;\n\t\t}\n\n\t\t_.extend(record, extraData);\n\n\t\trecord._id = this.insertOrUpsert(record);\n\t\treturn record;\n\t}\n\n\tcreateUserJoinWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('uj', roomId, message, user, extraData);\n\t}\n\n\tcreateUserLeaveWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('ul', roomId, message, user, extraData);\n\t}\n\n\tcreateUserRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('ru', roomId, message, user, extraData);\n\t}\n\n\tcreateUserAddedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('au', roomId, message, user, extraData);\n\t}\n\n\tcreateCommandWithRoomIdAndUser(command, roomId, user, extraData) {\n\t\treturn this.createWithTypeRoomIdMessageAndUser('command', roomId, command, user, extraData);\n\t}\n\n\tcreateUserMutedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('user-muted', roomId, message, user, extraData);\n\t}\n\n\tcreateUserUnmutedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('user-unmuted', roomId, message, user, extraData);\n\t}\n\n\tcreateNewModeratorWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('new-moderator', roomId, message, user, extraData);\n\t}\n\n\tcreateModeratorRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('moderator-removed', roomId, message, user, extraData);\n\t}\n\n\tcreateNewOwnerWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('new-owner', roomId, message, user, extraData);\n\t}\n\n\tcreateOwnerRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('owner-removed', roomId, message, user, extraData);\n\t}\n\n\tcreateNewLeaderWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('new-leader', roomId, message, user, extraData);\n\t}\n\n\tcreateLeaderRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('leader-removed', roomId, message, user, extraData);\n\t}\n\n\tcreateSubscriptionRoleAddedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('subscription-role-added', roomId, message, user, extraData);\n\t}\n\n\tcreateSubscriptionRoleRemovedWithRoomIdAndUser(roomId, user, extraData) {\n\t\tconst message = user.username;\n\t\treturn this.createWithTypeRoomIdMessageAndUser('subscription-role-removed', roomId, message, user, extraData);\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query =\t{ _id };\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByRoomId(roomId) {\n\t\tconst query =\t{ rid: roomId };\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByIdPinnedTimestampAndUsers(rid, pinned, ts, users = []) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\tts,\n\t\t};\n\n\t\tif (pinned) {\n\t\t\tquery.pinned = { $ne: true };\n\t\t}\n\n\t\tif (users.length) {\n\t\t\tquery['u.username'] = { $in: users };\n\t\t}\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveByIdPinnedTimestampLimitAndUsers(rid, pinned, ts, limit, users = []) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\tts,\n\t\t};\n\n\t\tif (pinned) {\n\t\t\tquery.pinned = { $ne: true };\n\t\t}\n\n\t\tif (users.length) {\n\t\t\tquery['u.username'] = { $in: users };\n\t\t}\n\n\t\tconst messagesToDelete = RocketChat.models.Messages.find(query, {\n\t\t\tfields: {\n\t\t\t\t_id: 1,\n\t\t\t},\n\t\t\tlimit,\n\t\t}).map(({ _id }) => _id);\n\n\t\treturn this.remove({\n\t\t\t_id: {\n\t\t\t\t$in: messagesToDelete,\n\t\t\t},\n\t\t});\n\t}\n\n\tremoveByUserId(userId) {\n\t\tconst query =\t{ 'u._id': userId };\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveFilesByRoomId(roomId) {\n\t\tthis.find({\n\t\t\trid: roomId,\n\t\t\t'file._id': {\n\t\t\t\t$exists: true,\n\t\t\t},\n\t\t}, {\n\t\t\tfields: {\n\t\t\t\t'file._id': 1,\n\t\t\t},\n\t\t}).fetch().forEach((document) => FileUpload.getStore('Uploads').deleteById(document.file._id));\n\t}\n\n\tgetMessageByFileId(fileID) {\n\t\treturn this.findOne({ 'file._id': fileID });\n\t}\n\n\tsetAsRead(rid, until) {\n\t\treturn this.update({\n\t\t\trid,\n\t\t\tunread: true,\n\t\t\tts: { $lt: until },\n\t\t}, {\n\t\t\t$unset: {\n\t\t\t\tunread: 1,\n\t\t\t},\n\t\t}, {\n\t\t\tmulti: true,\n\t\t});\n\t}\n\n\tsetAsReadById(_id) {\n\t\treturn this.update({\n\t\t\t_id,\n\t\t}, {\n\t\t\t$unset: {\n\t\t\t\tunread: 1,\n\t\t\t},\n\t\t});\n\t}\n\n\tfindUnreadMessagesByRoomAndDate(rid, after) {\n\t\tconst query = {\n\t\t\tunread: true,\n\t\t\trid,\n\t\t};\n\n\t\tif (after) {\n\t\t\tquery.ts = { $gt: after };\n\t\t}\n\n\t\treturn this.find(query, {\n\t\t\tfields: {\n\t\t\t\t_id: 1,\n\t\t\t},\n\t\t});\n\t}\n};\n","import _ from 'underscore';\n\nRocketChat.models.Reports = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('reports');\n\t}\n\tcreateWithMessageDescriptionAndUserId(message, description, userId, extraData) {\n\t\tconst record = {\n\t\t\tmessage,\n\t\t\tdescription,\n\t\t\tts: new Date(),\n\t\t\tuserId,\n\t\t};\n\t\t_.extend(record, extraData);\n\t\trecord._id = this.insert(record);\n\t\treturn record;\n\t}\n};\n","import _ from 'underscore';\nimport s from 'underscore.string';\n\nclass ModelRooms extends RocketChat.models._Base {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.tryEnsureIndex({ name: 1 }, { unique: 1, sparse: 1 });\n\t\tthis.tryEnsureIndex({ default: 1 });\n\t\tthis.tryEnsureIndex({ t: 1 });\n\t\tthis.tryEnsureIndex({ 'u._id': 1 });\n\t}\n\n\tfindOneByIdOrName(_idOrName, options) {\n\t\tconst query = {\n\t\t\t$or: [{\n\t\t\t\t_id: _idOrName,\n\t\t\t}, {\n\t\t\t\tname: _idOrName,\n\t\t\t}],\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByImportId(_id, options) {\n\t\tconst query = { importIds: _id };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByName(name, options) {\n\t\tconst query = { name };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByNameAndNotId(name, rid) {\n\t\tconst query = {\n\t\t\t_id: { $ne: rid },\n\t\t\tname,\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindOneByDisplayName(fname, options) {\n\t\tconst query = { fname };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByNameAndType(name, type, options) {\n\t\tconst query = {\n\t\t\tname,\n\t\t\tt: type,\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\t// FIND\n\n\tfindById(roomId, options) {\n\t\treturn this.find({ _id: roomId }, options);\n\t}\n\n\tfindByIds(roomIds, options) {\n\t\treturn this.find({ _id: { $in: [].concat(roomIds) } }, options);\n\t}\n\n\tfindByType(type, options) {\n\t\tconst query = { t: type };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeInIds(type, ids, options) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids,\n\t\t\t},\n\t\t\tt: type,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypes(types, options) {\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUserId(userId, options) {\n\t\tconst query = { 'u._id': userId };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindBySubscriptionUserId(userId, options) {\n\t\tconst data = RocketChat.models.Subscriptions.findByUserId(userId, { fields: { rid: 1 } }).fetch()\n\t\t\t.map((item) => item.rid);\n\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: data,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindBySubscriptionTypeAndUserId(type, userId, options) {\n\t\tconst data = RocketChat.models.Subscriptions.findByUserIdAndType(userId, type, { fields: { rid: 1 } }).fetch()\n\t\t\t.map((item) => item.rid);\n\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\t_id: {\n\t\t\t\t$in: data,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindBySubscriptionUserIdUpdatedAfter(userId, _updatedAt, options) {\n\t\tconst ids = RocketChat.models.Subscriptions.findByUserId(userId, { fields: { rid: 1 } }).fetch()\n\t\t\t.map((item) => item.rid);\n\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids,\n\t\t\t},\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: _updatedAt,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByNameContaining(name, options) {\n\t\tconst nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), 'i');\n\n\t\tconst query = {\n\t\t\t$or: [\n\t\t\t\t{ name: nameRegex },\n\t\t\t\t{\n\t\t\t\t\tt: 'd',\n\t\t\t\t\tusernames: nameRegex,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByNameContainingAndTypes(name, types, options) {\n\t\tconst nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), 'i');\n\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types,\n\t\t\t},\n\t\t\t$or: [\n\t\t\t\t{ name: nameRegex },\n\t\t\t\t{\n\t\t\t\t\tt: 'd',\n\t\t\t\t\tusernames: nameRegex,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByNameAndType(name, type, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tname,\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindByNameAndTypeNotDefault(name, type, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\tname,\n\t\t\tdefault: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindByNameAndTypesNotInIds(name, types, ids, options) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$ne: ids,\n\t\t\t},\n\t\t\tt: {\n\t\t\t\t$in: types,\n\t\t\t},\n\t\t\tname,\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindChannelAndPrivateByNameStarting(name, options) {\n\t\tconst nameRegex = new RegExp(`^${ s.trim(s.escapeRegExp(name)) }`, 'i');\n\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: ['c', 'p'],\n\t\t\t},\n\t\t\tname: nameRegex,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByDefaultAndTypes(defaultValue, types, options) {\n\t\tconst query = {\n\t\t\tdefault: defaultValue,\n\t\t\tt: {\n\t\t\t\t$in: types,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindDirectRoomContainingUsername(username, options) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tusernames: username,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndName(type, name, options) {\n\t\tconst query = {\n\t\t\tname,\n\t\t\tt: type,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndNameContaining(type, name, options) {\n\t\tconst nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), 'i');\n\n\t\tconst query = {\n\t\t\tname: nameRegex,\n\t\t\tt: type,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeInIdsAndNameContaining(type, ids, name, options) {\n\t\tconst nameRegex = new RegExp(s.trim(s.escapeRegExp(name)), 'i');\n\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids,\n\t\t\t},\n\t\t\tname: nameRegex,\n\t\t\tt: type,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndArchivationState(type, archivationstate, options) {\n\t\tconst query = { t: type };\n\n\t\tif (archivationstate) {\n\t\t\tquery.archived = true;\n\t\t} else {\n\t\t\tquery.archived = { $ne: true };\n\t\t}\n\n\t\treturn this.find(query, options);\n\t}\n\n\t// UPDATE\n\taddImportIds(_id, importIds) {\n\t\timportIds = [].concat(importIds);\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\timportIds: {\n\t\t\t\t\t$each: importIds,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tarchiveById(_id) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tarchived: true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tunarchiveById(_id) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tarchived: false,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetNameById(_id, name, fname) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname,\n\t\t\t\tfname,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetFnameById(_id, fname) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tfname,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tincMsgCountById(_id, inc) {\n\t\tif (inc == null) { inc = 1; }\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$inc: {\n\t\t\t\tmsgs: inc,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tincMsgCountAndSetLastMessageById(_id, inc, lastMessageTimestamp, lastMessage) {\n\t\tif (inc == null) { inc = 1; }\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlm: lastMessageTimestamp,\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tmsgs: inc,\n\t\t\t},\n\t\t};\n\n\t\tif (lastMessage) {\n\t\t\tupdate.$set.lastMessage = lastMessage;\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tincUsersCountById(_id, inc = 1) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$inc: {\n\t\t\t\tusersCount: inc,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tincUsersCountByIds(ids, inc = 1) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids,\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$inc: {\n\t\t\t\tusersCount: inc,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetLastMessageById(_id, lastMessage) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlastMessage,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tresetLastMessageById(_id) {\n\t\tconst query = { _id };\n\t\tconst lastMessage = RocketChat.models.Messages.getLastVisibleMessageSentWithNoTypeByRoomId(_id);\n\n\t\tconst update = lastMessage ? {\n\t\t\t$set: {\n\t\t\t\tlastMessage,\n\t\t\t},\n\t\t} : {\n\t\t\t$unset: {\n\t\t\t\tlastMessage: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\treplaceUsername(previousUsername, username) {\n\t\tconst query = { usernames: previousUsername };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'usernames.$': username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\treplaceMutedUsername(previousUsername, username) {\n\t\tconst query = { muted: previousUsername };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'muted.$': username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\treplaceUsernameOfUserByUserId(userId, username) {\n\t\tconst query = { 'u._id': userId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'u.username': username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetJoinCodeById(_id, joinCode) {\n\t\tlet update;\n\t\tconst query = { _id };\n\n\t\tif ((joinCode != null ? joinCode.trim() : undefined) !== '') {\n\t\t\tupdate = {\n\t\t\t\t$set: {\n\t\t\t\t\tjoinCodeRequired: true,\n\t\t\t\t\tjoinCode,\n\t\t\t\t},\n\t\t\t};\n\t\t} else {\n\t\t\tupdate = {\n\t\t\t\t$set: {\n\t\t\t\t\tjoinCodeRequired: false,\n\t\t\t\t},\n\t\t\t\t$unset: {\n\t\t\t\t\tjoinCode: 1,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetUserById(_id, user) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tu: {\n\t\t\t\t\t_id: user._id,\n\t\t\t\t\tusername: user.username,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetTypeById(_id, type) {\n\t\tconst query = { _id };\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tt: type,\n\t\t\t},\n\t\t};\n\t\tif (type === 'p') {\n\t\t\tupdate.$unset = { default: '' };\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetTopicById(_id, topic) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\ttopic,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAnnouncementById(_id, announcement, announcementDetails) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tannouncement,\n\t\t\t\tannouncementDetails,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetCustomFieldsById(_id, customFields) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcustomFields,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tmuteUsernameByRoomId(_id, username) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\tmuted: username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tunmuteUsernameByRoomId(_id, username) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\tmuted: username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveDefaultById(_id, defaultValue) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tdefault: defaultValue === 'true',\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveRetentionEnabledById(_id, value) {\n\t\tconst query = { _id };\n\n\t\tconst update = {};\n\n\t\tif (value == null) {\n\t\t\tupdate.$unset = { 'retention.enabled': true };\n\t\t} else {\n\t\t\tupdate.$set = { 'retention.enabled': !!value };\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveRetentionMaxAgeById(_id, value) {\n\t\tconst query = { _id };\n\n\t\tvalue = Number(value);\n\t\tif (!value) {\n\t\t\tvalue = 30;\n\t\t}\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'retention.maxAge': value,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveRetentionExcludePinnedById(_id, value) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'retention.excludePinned': value === true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveRetentionFilesOnlyById(_id, value) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'retention.filesOnly': value === true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveRetentionOverrideGlobalById(_id, value) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'retention.overrideGlobal': value === true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveEncryptedById(_id, value) {\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tencrypted: value === true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetTopicAndTagsById(_id, topic, tags) {\n\t\tconst setData = {};\n\t\tconst unsetData = {};\n\n\t\tif (topic != null) {\n\t\t\tif (!_.isEmpty(s.trim(topic))) {\n\t\t\t\tsetData.topic = s.trim(topic);\n\t\t\t} else {\n\t\t\t\tunsetData.topic = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (tags != null) {\n\t\t\tif (!_.isEmpty(s.trim(tags))) {\n\t\t\t\tsetData.tags = s.trim(tags).split(',').map((tag) => s.trim(tag));\n\t\t\t} else {\n\t\t\t\tunsetData.tags = 1;\n\t\t\t}\n\t\t}\n\n\t\tconst update = {};\n\n\t\tif (!_.isEmpty(setData)) {\n\t\t\tupdate.$set = setData;\n\t\t}\n\n\t\tif (!_.isEmpty(unsetData)) {\n\t\t\tupdate.$unset = unsetData;\n\t\t}\n\n\t\tif (_.isEmpty(update)) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\t// INSERT\n\tcreateWithTypeNameUserAndUsernames(type, name, fname, user, usernames, extraData) {\n\t\tconst room = {\n\t\t\tname,\n\t\t\tfname,\n\t\t\tt: type,\n\t\t\tusernames,\n\t\t\tmsgs: 0,\n\t\t\tusersCount: 0,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username,\n\t\t\t},\n\t\t};\n\n\t\t_.extend(room, extraData);\n\n\t\troom._id = this.insert(room);\n\t\treturn room;\n\t}\n\n\tcreateWithIdTypeAndName(_id, type, name, extraData) {\n\t\tconst room = {\n\t\t\t_id,\n\t\t\tts: new Date(),\n\t\t\tt: type,\n\t\t\tname,\n\t\t\tusernames: [],\n\t\t\tmsgs: 0,\n\t\t\tusersCount: 0,\n\t\t};\n\n\t\t_.extend(room, extraData);\n\n\t\tthis.insert(room);\n\t\treturn room;\n\t}\n\n\tcreateWithFullRoomData(room) {\n\t\tdelete room._id;\n\n\t\troom._id = this.insert(room);\n\t\treturn room;\n\t}\n\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query = { _id };\n\n\t\treturn this.remove(query);\n\t}\n\n\tremoveDirectRoomContainingUsername(username) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tusernames: username,\n\t\t};\n\n\t\treturn this.remove(query);\n\t}\n}\n\nRocketChat.models.Rooms = new ModelRooms('room', true);\n","class ModelSettings extends RocketChat.models._Base {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.tryEnsureIndex({ blocked: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ hidden: 1 }, { sparse: 1 });\n\t}\n\n\t// FIND\n\tfindById(_id) {\n\t\tconst query = { _id };\n\n\t\treturn this.find(query);\n\t}\n\n\tfindOneNotHiddenById(_id) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\thidden: { $ne: true },\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\tfindByIds(_id = []) {\n\t\t_id = [].concat(_id);\n\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: _id,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindByRole(role, options) {\n\t\tconst query = { role };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindPublic(options) {\n\t\tconst query = { public: true };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindNotHiddenPublic(ids = []) {\n\t\tconst filter = {\n\t\t\thidden: { $ne: true },\n\t\t\tpublic: true,\n\t\t};\n\n\t\tif (ids.length > 0) {\n\t\t\tfilter._id =\n\t\t\t\t{ $in: ids };\n\t\t}\n\n\t\treturn this.find(filter, { fields: { _id: 1, value: 1 } });\n\t}\n\n\tfindNotHiddenPublicUpdatedAfter(updatedAt) {\n\t\tconst filter = {\n\t\t\thidden: { $ne: true },\n\t\t\tpublic: true,\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: updatedAt,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(filter, { fields: { _id: 1, value: 1 } });\n\t}\n\n\tfindNotHiddenPrivate() {\n\t\treturn this.find({\n\t\t\thidden: { $ne: true },\n\t\t\tpublic: { $ne: true },\n\t\t});\n\t}\n\n\tfindNotHidden(options) {\n\t\treturn this.find({ hidden: { $ne: true } }, options);\n\t}\n\n\tfindNotHiddenUpdatedAfter(updatedAt) {\n\t\treturn this.find({\n\t\t\thidden: { $ne: true },\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: updatedAt,\n\t\t\t},\n\t\t});\n\t}\n\n\tfindSetupWizardSettings() {\n\t\treturn this.find({ wizard: { $exists: true, $ne: null } });\n\t}\n\n\t// UPDATE\n\tupdateValueById(_id, value) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\tvalue: { $ne: value },\n\t\t\t_id,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tvalue,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateValueAndEditorById(_id, value, editor) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\tvalue: { $ne: value },\n\t\t\t_id,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tvalue,\n\t\t\t\teditor,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateValueNotHiddenById(_id, value) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\thidden: { $ne: true },\n\t\t\tblocked: { $ne: true },\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tvalue,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateOptionsById(_id, options) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\t_id,\n\t\t};\n\n\t\tconst update = { $set: options };\n\n\t\treturn this.update(query, update);\n\t}\n\n\t// INSERT\n\tcreateWithIdAndValue(_id, value) {\n\t\tconst record = {\n\t\t\t_id,\n\t\t\tvalue,\n\t\t\t_createdAt: new Date,\n\t\t};\n\n\t\treturn this.insert(record);\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\tconst query = {\n\t\t\tblocked: { $ne: true },\n\t\t\t_id,\n\t\t};\n\n\t\treturn this.remove(query);\n\t}\n}\n\nRocketChat.models.Settings = new ModelSettings('settings', true);\n","class ModelSubscriptions extends RocketChat.models._Base {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.tryEnsureIndex({ rid: 1, 'u._id': 1 }, { unique: 1 });\n\t\tthis.tryEnsureIndex({ rid: 1, 'u.username': 1 });\n\t\tthis.tryEnsureIndex({ rid: 1, alert: 1, 'u._id': 1 });\n\t\tthis.tryEnsureIndex({ rid: 1, roles: 1 });\n\t\tthis.tryEnsureIndex({ 'u._id': 1, name: 1, t: 1 });\n\t\tthis.tryEnsureIndex({ open: 1 });\n\t\tthis.tryEnsureIndex({ alert: 1 });\n\n\t\tthis.tryEnsureIndex({ rid: 1, 'u._id': 1, open: 1 });\n\n\t\tthis.tryEnsureIndex({ ts: 1 });\n\t\tthis.tryEnsureIndex({ ls: 1 });\n\t\tthis.tryEnsureIndex({ audioNotifications: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ desktopNotifications: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ mobilePushNotifications: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ emailNotifications: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ autoTranslate: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ autoTranslateLanguage: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ 'userHighlights.0': 1 }, { sparse: 1 });\n\t}\n\n\n\t// FIND ONE\n\tfindOneByRoomIdAndUserId(roomId, userId, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByRoomIdAndUsername(roomId, username, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u.username': username,\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByRoomNameAndUserId(roomName, userId) {\n\t\tconst query = {\n\t\t\tname: roomName,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\treturn this.findOne(query);\n\t}\n\n\t// FIND\n\tfindByUserId(userId, options) {\n\t\tconst query =\n\t\t\t{ 'u._id': userId };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUserIdAndType(userId, type, options) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tt: type,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUserIdAndTypes(userId, types, options) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tt: {\n\t\t\t\t$in: types,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUserIdUpdatedAfter(userId, updatedAt, options) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\t_updatedAt: {\n\t\t\t\t$gt: updatedAt,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomIdAndRoles(roomId, roles, options) {\n\t\troles = [].concat(roles);\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\troles: { $in: roles },\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByType(types, options) {\n\t\tconst query = {\n\t\t\tt: {\n\t\t\t\t$in: types,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByTypeAndUserId(type, userId, options) {\n\t\tconst query = {\n\t\t\tt: type,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomId(roomId, options) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomIdAndNotUserId(roomId, userId, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomWithUserHighlights(roomId, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'userHighlights.0': { $exists: true },\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastSeen(options) {\n\t\tif (options == null) {\n\t\t\toptions = {};\n\t\t}\n\t\tconst query = { ls: { $exists: 1 } };\n\t\toptions.sort = { ls: -1 };\n\t\toptions.limit = 1;\n\t\tconst [subscription] = this.find(query, options).fetch();\n\t\treturn subscription && subscription.ls;\n\t}\n\n\tfindByRoomIdAndUserIds(roomId, userIds, options) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$in: userIds,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomIdAndUserIdsOrAllMessages(roomId, userIds) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t$or: [\n\t\t\t\t{ 'u._id': { $in: userIds } },\n\t\t\t\t{ emailNotifications: 'all' },\n\t\t\t],\n\t\t};\n\n\t\treturn this.find(query);\n\t}\n\n\tfindByRoomIdWhenUserIdExists(rid, options) {\n\t\tconst query = { rid, 'u._id': { $exists: 1 } };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomIdWhenUsernameExists(rid, options) {\n\t\tconst query = { rid, 'u.username': { $exists: 1 } };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindUnreadByUserId(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tunread: {\n\t\t\t\t$gt: 0,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, { fields: { unread: 1 } });\n\t}\n\n\tgetMinimumLastSeenByRoomId(rid) {\n\t\treturn this.db.findOne({\n\t\t\trid,\n\t\t}, {\n\t\t\tsort: {\n\t\t\t\tls: 1,\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\tls: 1,\n\t\t\t},\n\t\t});\n\t}\n\n\t// UPDATE\n\tarchiveByRoomId(roomId) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: false,\n\t\t\t\topen: false,\n\t\t\t\tarchived: true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tunarchiveByRoomId(roomId) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: false,\n\t\t\t\topen: true,\n\t\t\t\tarchived: false,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\thideByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: false,\n\t\t\t\topen: false,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\topenByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAsReadByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true,\n\t\t\t\talert: false,\n\t\t\t\tunread: 0,\n\t\t\t\tuserMentions: 0,\n\t\t\t\tgroupMentions: 0,\n\t\t\t\tls: new Date,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAsUnreadByRoomIdAndUserId(roomId, userId, firstMessageUnreadTimestamp) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true,\n\t\t\t\talert: true,\n\t\t\t\tls: firstMessageUnreadTimestamp,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetCustomFieldsDirectMessagesByUserId(userId, fields) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tt: 'd',\n\t\t};\n\t\tconst update = { $set: { customFields: fields } };\n\t\tconst options = { multi: true };\n\n\t\treturn this.update(query, update, options);\n\t}\n\n\tsetFavoriteByRoomIdAndUserId(roomId, userId, favorite) {\n\t\tif (favorite == null) {\n\t\t\tfavorite = true;\n\t\t}\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tf: favorite,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateNameAndAlertByRoomId(roomId, name, fname) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname,\n\t\t\t\tfname,\n\t\t\t\talert: true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateDisplayNameByRoomId(roomId, fname) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tfname,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetUserUsernameByUserId(userId, username) {\n\t\tconst query =\n\t\t\t{ 'u._id': userId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'u.username': username,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetNameForDirectRoomsWithOldName(oldName, name) {\n\t\tconst query = {\n\t\t\tname: oldName,\n\t\t\tt: 'd',\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tincUnreadForRoomIdExcludingUserId(roomId, userId, inc) {\n\t\tif (inc == null) {\n\t\t\tinc = 1;\n\t\t}\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId,\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true,\n\t\t\t\topen: true,\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tunread: inc,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tincGroupMentionsAndUnreadForRoomIdExcludingUserId(roomId, userId, incGroup = 1, incUnread = 1) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId,\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true,\n\t\t\t\topen: true,\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tunread: incUnread,\n\t\t\t\tgroupMentions: incGroup,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tincUserMentionsAndUnreadForRoomIdAndUserIds(roomId, userIds, incUser = 1, incUnread = 1) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$in: userIds,\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true,\n\t\t\t\topen: true,\n\t\t\t},\n\t\t\t$inc: {\n\t\t\t\tunread: incUnread,\n\t\t\t\tuserMentions: incUser,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tignoreUser({ _id, ignoredUser : ignored, ignore = true }) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t};\n\t\tconst update = {\n\t\t};\n\t\tif (ignore) {\n\t\t\tupdate.$addToSet = { ignored };\n\t\t} else {\n\t\t\tupdate.$pull = { ignored };\n\t\t}\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetAlertForRoomIdExcludingUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId,\n\t\t\t},\n\t\t\talert: { $ne: true },\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\talert: true,\n\t\t\t},\n\t\t};\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetOpenForRoomIdExcludingUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': {\n\t\t\t\t$ne: userId,\n\t\t\t},\n\t\t\topen: { $ne: true },\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\topen: true,\n\t\t\t},\n\t\t};\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tsetBlockedByRoomId(rid, blocked, blocker) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t'u._id': blocked,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tblocked: true,\n\t\t\t},\n\t\t};\n\n\t\tconst query2 = {\n\t\t\trid,\n\t\t\t'u._id': blocker,\n\t\t};\n\n\t\tconst update2 = {\n\t\t\t$set: {\n\t\t\t\tblocker: true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update) && this.update(query2, update2);\n\t}\n\n\tunsetBlockedByRoomId(rid, blocked, blocker) {\n\t\tconst query = {\n\t\t\trid,\n\t\t\t'u._id': blocked,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tblocked: 1,\n\t\t\t},\n\t\t};\n\n\t\tconst query2 = {\n\t\t\trid,\n\t\t\t'u._id': blocker,\n\t\t};\n\n\t\tconst update2 = {\n\t\t\t$unset: {\n\t\t\t\tblocker: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update) && this.update(query2, update2);\n\t}\n\n\tupdateCustomFieldsByRoomId(rid, cfields) {\n\t\tconst query = { rid };\n\t\tconst customFields = cfields || {};\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcustomFields,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateTypeByRoomId(roomId, type) {\n\t\tconst query =\n\t\t\t{ rid: roomId };\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tt: type,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\taddRoleById(_id, role) {\n\t\tconst query =\n\t\t\t{ _id };\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\troles: role,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tremoveRoleById(_id, role) {\n\t\tconst query =\n\t\t\t{ _id };\n\n\t\tconst update = {\n\t\t\t$pull: {\n\t\t\t\troles: role,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetArchivedByUsername(username, archived) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tname: username,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tarchived,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tclearDesktopNotificationUserPreferences(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tdesktopPrefOrigin: 'user',\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tdesktopNotifications: 1,\n\t\t\t\tdesktopPrefOrigin: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateDesktopNotificationUserPreferences(userId, desktopNotifications) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tdesktopPrefOrigin: {\n\t\t\t\t$ne: 'subscription',\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tdesktopNotifications,\n\t\t\t\tdesktopPrefOrigin: 'user',\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tclearMobileNotificationUserPreferences(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tmobilePrefOrigin: 'user',\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tmobilePushNotifications: 1,\n\t\t\t\tmobilePrefOrigin: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateMobileNotificationUserPreferences(userId, mobilePushNotifications) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\tmobilePrefOrigin: {\n\t\t\t\t$ne: 'subscription',\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tmobilePushNotifications,\n\t\t\t\tmobilePrefOrigin: 'user',\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tclearEmailNotificationUserPreferences(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\temailPrefOrigin: 'user',\n\t\t};\n\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\temailNotifications: 1,\n\t\t\t\temailPrefOrigin: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateEmailNotificationUserPreferences(userId, emailNotifications) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t\temailPrefOrigin: {\n\t\t\t\t$ne: 'subscription',\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\temailNotifications,\n\t\t\t\temailPrefOrigin: 'user',\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateUserHighlights(userId, userHighlights) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tuserHighlights,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\tupdateDirectFNameByName(name, fname) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tname,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tfname,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update, { multi: true });\n\t}\n\n\t// INSERT\n\tcreateWithRoomAndUser(room, user, extraData) {\n\t\tconst subscription = {\n\t\t\topen: false,\n\t\t\talert: false,\n\t\t\tunread: 0,\n\t\t\tuserMentions: 0,\n\t\t\tgroupMentions: 0,\n\t\t\tts: room.ts,\n\t\t\trid: room._id,\n\t\t\tname: room.name,\n\t\t\tfname: room.fname,\n\t\t\tcustomFields: room.customFields,\n\t\t\tt: room.t,\n\t\t\tu: {\n\t\t\t\t_id: user._id,\n\t\t\t\tusername: user.username,\n\t\t\t\tname: user.name,\n\t\t\t},\n\t\t\t...RocketChat.getDefaultSubscriptionPref(user),\n\t\t\t...extraData,\n\t\t};\n\n\t\tconst result = this.insert(subscription);\n\n\t\tRocketChat.models.Rooms.incUsersCountById(room._id);\n\n\t\treturn result;\n\t}\n\n\n\t// REMOVE\n\tremoveByUserId(userId) {\n\t\tconst query = {\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst roomIds = this.findByUserId(userId).map((s) => s.rid);\n\n\t\tconst result = this.remove(query);\n\n\t\tif (Match.test(result, Number) && result > 0) {\n\t\t\tRocketChat.models.Rooms.incUsersCountByIds(roomIds, -1);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tremoveByRoomId(roomId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t};\n\n\t\tconst result = this.remove(query);\n\n\t\tif (Match.test(result, Number) && result > 0) {\n\t\t\tRocketChat.models.Rooms.incUsersCountById(roomId, - result);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tremoveByRoomIdAndUserId(roomId, userId) {\n\t\tconst query = {\n\t\t\trid: roomId,\n\t\t\t'u._id': userId,\n\t\t};\n\n\t\tconst result = this.remove(query);\n\n\t\tif (Match.test(result, Number) && result > 0) {\n\t\t\tRocketChat.models.Rooms.incUsersCountById(roomId, - result);\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nRocketChat.models.Subscriptions = new ModelSubscriptions('subscription', true);\n","/* globals InstanceStatus */\nimport _ from 'underscore';\nimport s from 'underscore.string';\n\nRocketChat.models.Uploads = new class extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('uploads');\n\n\t\tthis.model.before.insert((userId, doc) => {\n\t\t\tdoc.instanceId = InstanceStatus.id();\n\t\t});\n\n\t\tthis.tryEnsureIndex({ rid: 1 });\n\t\tthis.tryEnsureIndex({ uploadedAt: 1 });\n\t}\n\n\tfindNotHiddenFilesOfRoom(roomId, searchText, limit) {\n\t\tconst fileQuery = {\n\t\t\trid: roomId,\n\t\t\tcomplete: true,\n\t\t\tuploading: false,\n\t\t\t_hidden: {\n\t\t\t\t$ne: true,\n\t\t\t},\n\t\t};\n\n\t\tif (searchText) {\n\t\t\tfileQuery.name = { $regex: new RegExp(RegExp.escape(searchText), 'i') };\n\t\t}\n\n\t\tconst fileOptions = {\n\t\t\tlimit,\n\t\t\tsort: {\n\t\t\t\tuploadedAt: -1,\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\t_id: 1,\n\t\t\t\tuserId: 1,\n\t\t\t\trid: 1,\n\t\t\t\tname: 1,\n\t\t\t\tdescription: 1,\n\t\t\t\ttype: 1,\n\t\t\t\turl: 1,\n\t\t\t\tuploadedAt: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(fileQuery, fileOptions);\n\t}\n\n\tinsertFileInit(userId, store, file, extra) {\n\t\tconst fileData = {\n\t\t\tuserId,\n\t\t\tstore,\n\t\t\tcomplete: false,\n\t\t\tuploading: true,\n\t\t\tprogress: 0,\n\t\t\textension: s.strRightBack(file.name, '.'),\n\t\t\tuploadedAt: new Date(),\n\t\t};\n\n\t\t_.extend(fileData, file, extra);\n\n\t\tif (this.model.direct && this.model.direct.insert != null) {\n\t\t\tfile = this.model.direct.insert(fileData);\n\t\t} else {\n\t\t\tfile = this.insert(fileData);\n\t\t}\n\n\t\treturn file;\n\t}\n\n\tupdateFileComplete(fileId, userId, file) {\n\t\tlet result;\n\t\tif (!fileId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst filter = {\n\t\t\t_id: fileId,\n\t\t\tuserId,\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tcomplete: true,\n\t\t\t\tuploading: false,\n\t\t\t\tprogress: 1,\n\t\t\t},\n\t\t};\n\n\t\tupdate.$set = _.extend(file, update.$set);\n\n\t\tif (this.model.direct && this.model.direct.update != null) {\n\t\t\tresult = this.model.direct.update(filter, update);\n\t\t} else {\n\t\t\tresult = this.update(filter, update);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdeleteFile(fileId) {\n\t\tif (this.model.direct && this.model.direct.remove != null) {\n\t\t\treturn this.model.direct.remove({ _id: fileId });\n\t\t} else {\n\t\t\treturn this.remove({ _id: fileId });\n\t\t}\n\t}\n};\n","import _ from 'underscore';\nimport s from 'underscore.string';\n\nclass ModelUsers extends RocketChat.models._Base {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.tryEnsureIndex({ roles: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ name: 1 });\n\t\tthis.tryEnsureIndex({ lastLogin: 1 });\n\t\tthis.tryEnsureIndex({ status: 1 });\n\t\tthis.tryEnsureIndex({ active: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ statusConnection: 1 }, { sparse: 1 });\n\t\tthis.tryEnsureIndex({ type: 1 });\n\t}\n\n\tfindOneByImportId(_id, options) {\n\t\treturn this.findOne({ importIds: _id }, options);\n\t}\n\n\tfindOneByUsername(username, options) {\n\t\tif (typeof username === 'string') {\n\t\t\tusername = new RegExp(`^${ username }$`, 'i');\n\t\t}\n\n\t\tconst query = { username };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByEmailAddress(emailAddress, options) {\n\t\tconst query = { 'emails.address': new RegExp(`^${ s.escapeRegExp(emailAddress) }$`, 'i') };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneAdmin(admin, options) {\n\t\tconst query = { admin };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneByIdAndLoginToken(_id, token, options) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\t'services.resume.loginTokens.hashedToken' : Accounts._hashLoginToken(token),\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindOneById(userId, options) {\n\t\tconst query = { _id: userId };\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\t// FIND\n\tfindById(userId) {\n\t\tconst query = { _id: userId };\n\n\t\treturn this.find(query);\n\t}\n\n\tfindByIds(users, options) {\n\t\tconst query = { _id: { $in: users } };\n\t\treturn this.find(query, options);\n\t}\n\n\tfindUsersNotOffline(options) {\n\t\tconst query = {\n\t\t\tusername: {\n\t\t\t\t$exists: 1,\n\t\t\t},\n\t\t\tstatus: {\n\t\t\t\t$in: ['online', 'away', 'busy'],\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByRoomId(rid, options) {\n\t\tconst data = RocketChat.models.Subscriptions.findByRoomId(rid).fetch().map((item) => item.u._id);\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: data,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUsername(username, options) {\n\t\tconst query = { username };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindActiveByUsernameOrNameRegexWithExceptions(searchTerm, exceptions, options) {\n\t\tif (exceptions == null) { exceptions = []; }\n\t\tif (options == null) { options = {}; }\n\t\tif (!_.isArray(exceptions)) {\n\t\t\texceptions = [exceptions];\n\t\t}\n\n\t\tconst termRegex = new RegExp(s.escapeRegExp(searchTerm), 'i');\n\t\tconst query = {\n\t\t\t$or: [{\n\t\t\t\tusername: termRegex,\n\t\t\t}, {\n\t\t\t\tname: termRegex,\n\t\t\t}],\n\t\t\tactive: true,\n\t\t\ttype: {\n\t\t\t\t$in: ['user', 'bot'],\n\t\t\t},\n\t\t\t$and: [{\n\t\t\t\tusername: {\n\t\t\t\t\t$exists: true,\n\t\t\t\t},\n\t\t\t}, {\n\t\t\t\tusername: {\n\t\t\t\t\t$nin: exceptions,\n\t\t\t\t},\n\t\t\t}],\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByActiveUsersExcept(searchTerm, exceptions, options) {\n\t\tif (exceptions == null) { exceptions = []; }\n\t\tif (options == null) { options = {}; }\n\t\tif (!_.isArray(exceptions)) {\n\t\t\texceptions = [exceptions];\n\t\t}\n\n\t\tconst termRegex = new RegExp(s.escapeRegExp(searchTerm), 'i');\n\n\t\tconst orStmt = _.reduce(RocketChat.settings.get('Accounts_SearchFields').trim().split(','), function(acc, el) {\n\t\t\tacc.push({ [el.trim()]: termRegex });\n\t\t\treturn acc;\n\t\t}, []);\n\t\tconst query = {\n\t\t\t$and: [\n\t\t\t\t{\n\t\t\t\t\tactive: true,\n\t\t\t\t\t$or: orStmt,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tusername: { $exists: true, $nin: exceptions },\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\t// do not use cache\n\t\treturn this._db.find(query, options);\n\t}\n\n\tfindUsersByNameOrUsername(nameOrUsername, options) {\n\t\tconst query = {\n\t\t\tusername: {\n\t\t\t\t$exists: 1,\n\t\t\t},\n\n\t\t\t$or: [\n\t\t\t\t{ name: nameOrUsername },\n\t\t\t\t{ username: nameOrUsername },\n\t\t\t],\n\n\t\t\ttype: {\n\t\t\t\t$in: ['user'],\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindByUsernameNameOrEmailAddress(usernameNameOrEmailAddress, options) {\n\t\tconst query = {\n\t\t\t$or: [\n\t\t\t\t{ name: usernameNameOrEmailAddress },\n\t\t\t\t{ username: usernameNameOrEmailAddress },\n\t\t\t\t{ 'emails.address': usernameNameOrEmailAddress },\n\t\t\t],\n\t\t\ttype: {\n\t\t\t\t$in: ['user', 'bot'],\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindLDAPUsers(options) {\n\t\tconst query = { ldap: true };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindCrowdUsers(options) {\n\t\tconst query = { crowd: true };\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetLastLogin(options) {\n\t\tif (options == null) { options = {}; }\n\t\tconst query = { lastLogin: { $exists: 1 } };\n\t\toptions.sort = { lastLogin: -1 };\n\t\toptions.limit = 1;\n\t\tconst [user] = this.find(query, options).fetch();\n\t\treturn user && user.lastLogin;\n\t}\n\n\tfindUsersByUsernames(usernames, options) {\n\t\tconst query = {\n\t\t\tusername: {\n\t\t\t\t$in: usernames,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindUsersByIds(ids, options) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids,\n\t\t\t},\n\t\t};\n\t\treturn this.find(query, options);\n\t}\n\n\tfindUsersWithUsernameByIds(ids, options) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids,\n\t\t\t},\n\t\t\tusername: {\n\t\t\t\t$exists: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindUsersWithUsernameByIdsNotOffline(ids, options) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: ids,\n\t\t\t},\n\t\t\tusername: {\n\t\t\t\t$exists: 1,\n\t\t\t},\n\t\t\tstatus: {\n\t\t\t\t$in: ['online', 'away', 'busy'],\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tgetOldest(fields = { _id: 1 }) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$ne: 'rocket.cat',\n\t\t\t},\n\t\t};\n\n\t\tconst options = {\n\t\t\tfields,\n\t\t\tsort: {\n\t\t\t\tcreatedAt: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.findOne(query, options);\n\t}\n\n\t// UPDATE\n\taddImportIds(_id, importIds) {\n\t\timportIds = [].concat(importIds);\n\n\t\tconst query = { _id };\n\n\t\tconst update = {\n\t\t\t$addToSet: {\n\t\t\t\timportIds: {\n\t\t\t\t\t$each: importIds,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tupdateLastLoginById(_id) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlastLogin: new Date,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetServiceId(_id, serviceName, serviceId) {\n\t\tconst update =\n\t\t{ $set: {} };\n\n\t\tconst serviceIdKey = `services.${ serviceName }.id`;\n\t\tupdate.$set[serviceIdKey] = serviceId;\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetUsername(_id, username) {\n\t\tconst update =\n\t\t{ $set: { username } };\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetEmail(_id, email) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\temails: [{\n\t\t\t\t\taddress: email,\n\t\t\t\t\tverified: false,\n\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetEmailVerified(_id, email) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\temails: {\n\t\t\t\t$elemMatch: {\n\t\t\t\t\taddress: email,\n\t\t\t\t\tverified: false,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'emails.$.verified': true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsetName(_id, name) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tname,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetCustomFields(_id, fields) {\n\t\tconst values = {};\n\t\tObject.keys(fields).forEach((key) => {\n\t\t\tvalues[`customFields.${ key }`] = fields[key];\n\t\t});\n\n\t\tconst update = { $set: values };\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetAvatarOrigin(_id, origin) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tavatarOrigin: origin,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tunsetAvatarOrigin(_id) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\tavatarOrigin: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetUserActive(_id, active) {\n\t\tif (active == null) { active = true; }\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tactive,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetAllUsersActive(active) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tactive,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update({}, update, { multi: true });\n\t}\n\n\tunsetLoginTokens(_id) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'services.resume.loginTokens' : [],\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tunsetRequirePasswordChange(_id) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\trequirePasswordChange : true,\n\t\t\t\trequirePasswordChangeReason : true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tresetPasswordAndSetRequirePasswordChange(_id, requirePasswordChange, requirePasswordChangeReason) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\t'services.password': 1,\n\t\t\t},\n\t\t\t$set: {\n\t\t\t\trequirePasswordChange,\n\t\t\t\trequirePasswordChangeReason,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetLanguage(_id, language) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tlanguage,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetProfile(_id, profile) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t'settings.profile': profile,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tclearSettings(_id) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tsettings: {},\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetPreferences(_id, preferences) {\n\t\tconst settings = Object.assign(\n\t\t\t{},\n\t\t\t...Object.keys(preferences).map((key) => ({ [`settings.preferences.${ key }`]: preferences[key] }))\n\t\t);\n\n\t\tconst update = {\n\t\t\t$set: settings,\n\t\t};\n\t\tif (parseInt(preferences.clockMode) === 0) {\n\t\t\tdelete update.$set['settings.preferences.clockMode'];\n\t\t\tupdate.$unset = { 'settings.preferences.clockMode': 1 };\n\t\t}\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tsetUtcOffset(_id, utcOffset) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\tutcOffset: {\n\t\t\t\t$ne: utcOffset,\n\t\t\t},\n\t\t};\n\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\tutcOffset,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(query, update);\n\t}\n\n\tsaveUserById(_id, data) {\n\t\tconst setData = {};\n\t\tconst unsetData = {};\n\n\t\tif (data.name != null) {\n\t\t\tif (!_.isEmpty(s.trim(data.name))) {\n\t\t\t\tsetData.name = s.trim(data.name);\n\t\t\t} else {\n\t\t\t\tunsetData.name = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (data.email != null) {\n\t\t\tif (!_.isEmpty(s.trim(data.email))) {\n\t\t\t\tsetData.emails = [{ address: s.trim(data.email) }];\n\t\t\t} else {\n\t\t\t\tunsetData.emails = 1;\n\t\t\t}\n\t\t}\n\n\t\tif (data.phone != null) {\n\t\t\tif (!_.isEmpty(s.trim(data.phone))) {\n\t\t\t\tsetData.phone = [{ phoneNumber: s.trim(data.phone) }];\n\t\t\t} else {\n\t\t\t\tunsetData.phone = 1;\n\t\t\t}\n\t\t}\n\n\t\tconst update = {};\n\n\t\tif (!_.isEmpty(setData)) {\n\t\t\tupdate.$set = setData;\n\t\t}\n\n\t\tif (!_.isEmpty(unsetData)) {\n\t\t\tupdate.$unset = unsetData;\n\t\t}\n\n\t\tif (_.isEmpty(update)) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\tsetReason(_id, reason) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\treason,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\tunsetReason(_id) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\treason: true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(_id, update);\n\t}\n\n\taddBannerById(_id, banner) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\t[`banners.${ banner.id }`]: banner,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\tremoveBannerById(_id, banner) {\n\t\tconst update = {\n\t\t\t$unset: {\n\t\t\t\t[`banners.${ banner.id }`]: true,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update({ _id }, update);\n\t}\n\n\t// INSERT\n\tcreate(data) {\n\t\tconst user = {\n\t\t\tcreatedAt: new Date,\n\t\t\tavatarOrigin: 'none',\n\t\t};\n\n\t\t_.extend(user, data);\n\n\t\treturn this.insert(user);\n\t}\n\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\treturn this.remove(_id);\n\t}\n\n\t/*\nFind users to send a message by email if:\n- he is not online\n- has a verified email\n- has not disabled email notifications\n- `active` is equal to true (false means they were deactivated and can't login)\n*/\n\tgetUsersToSendOfflineEmail(usersIds) {\n\t\tconst query = {\n\t\t\t_id: {\n\t\t\t\t$in: usersIds,\n\t\t\t},\n\t\t\tactive: true,\n\t\t\tstatus: 'offline',\n\t\t\tstatusConnection: {\n\t\t\t\t$ne: 'online',\n\t\t\t},\n\t\t\t'emails.verified': true,\n\t\t};\n\n\t\tconst options = {\n\t\t\tfields: {\n\t\t\t\tname: 1,\n\t\t\t\tusername: 1,\n\t\t\t\temails: 1,\n\t\t\t\t'settings.preferences.emailNotificationMode': 1,\n\t\t\t\tlanguage: 1,\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n}\n\nRocketChat.models.Users = new ModelUsers(Meteor.users, true);\n","import _ from 'underscore';\n\nRocketChat.models.ExportOperations = new class ModelExportOperations extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('export_operations');\n\n\t\tthis.tryEnsureIndex({ userId: 1 });\n\t\tthis.tryEnsureIndex({ status: 1 });\n\t}\n\n\t// FIND\n\tfindById(id) {\n\t\tconst query = { _id: id };\n\n\t\treturn this.find(query);\n\t}\n\n\tfindLastOperationByUser(userId, fullExport = false, options = {}) {\n\t\tconst query = {\n\t\t\tuserId,\n\t\t\tfullExport,\n\t\t};\n\n\t\toptions.sort = { createdAt : -1 };\n\t\treturn this.findOne(query, options);\n\t}\n\n\tfindPendingByUser(userId, options) {\n\t\tconst query = {\n\t\t\tuserId,\n\t\t\tstatus: {\n\t\t\t\t$nin: ['completed'],\n\t\t\t},\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\tfindAllPending(options) {\n\t\tconst query = {\n\t\t\tstatus: { $nin: ['completed'] },\n\t\t};\n\n\t\treturn this.find(query, options);\n\t}\n\n\t// UPDATE\n\tupdateOperation(data) {\n\t\tconst update = {\n\t\t\t$set: {\n\t\t\t\troomList: data.roomList,\n\t\t\t\tstatus: data.status,\n\t\t\t\tfileList: data.fileList,\n\t\t\t\tgeneratedFile: data.generatedFile,\n\t\t\t},\n\t\t};\n\n\t\treturn this.update(data._id, update);\n\t}\n\n\n\t// INSERT\n\tcreate(data) {\n\t\tconst exportOperation = {\n\t\t\tcreatedAt: new Date,\n\t\t};\n\n\t\t_.extend(exportOperation, data);\n\n\t\treturn this.insert(exportOperation);\n\t}\n\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\treturn this.remove(_id);\n\t}\n};\n","import _ from 'underscore';\n\nRocketChat.models.UserDataFiles = new class ModelUserDataFiles extends RocketChat.models._Base {\n\tconstructor() {\n\t\tsuper('user_data_files');\n\n\t\tthis.tryEnsureIndex({ userId: 1 });\n\t}\n\n\t// FIND\n\tfindById(id) {\n\t\tconst query = { _id: id };\n\t\treturn this.find(query);\n\t}\n\n\tfindLastFileByUser(userId, options = {}) {\n\t\tconst query = {\n\t\t\tuserId,\n\t\t};\n\n\t\toptions.sort = { _updatedAt : -1 };\n\t\treturn this.findOne(query, options);\n\t}\n\n\t// INSERT\n\tcreate(data) {\n\t\tconst userDataFile = {\n\t\t\tcreatedAt: new Date,\n\t\t};\n\n\t\t_.extend(userDataFile, data);\n\n\t\treturn this.insert(userDataFile);\n\t}\n\n\t// REMOVE\n\tremoveById(_id) {\n\t\treturn this.remove(_id);\n\t}\n};\n","/* globals MongoInternals */\nimport _ from 'underscore';\n\nconst baseName = 'rocketchat_';\nimport { EventEmitter } from 'events';\n\nconst trash = new Mongo.Collection(`${ baseName }_trash`);\ntry {\n\ttrash._ensureIndex({ collection: 1 });\n\ttrash._ensureIndex({ _deletedAt: 1 }, { expireAfterSeconds: 60 * 60 * 24 * 30 });\n} catch (e) {\n\tconsole.log(e);\n}\n\nconst isOplogAvailable = MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle && !!MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry;\nlet isOplogEnabled = isOplogAvailable;\nRocketChat.settings.get('Force_Disable_OpLog_For_Cache', (key, value) => {\n\tisOplogEnabled = isOplogAvailable && value === false;\n});\n\nclass ModelsBaseDb extends EventEmitter {\n\tconstructor(model, baseModel) {\n\t\tsuper();\n\n\t\tif (Match.test(model, String)) {\n\t\t\tthis.name = model;\n\t\t\tthis.collectionName = this.baseName + this.name;\n\t\t\tthis.model = new Mongo.Collection(this.collectionName);\n\t\t} else {\n\t\t\tthis.name = model._name;\n\t\t\tthis.collectionName = this.name;\n\t\t\tthis.model = model;\n\t\t}\n\n\t\tthis.baseModel = baseModel;\n\n\t\tthis.wrapModel();\n\n\t\tlet alreadyListeningToOplog = false;\n\t\t// When someone start listening for changes we start oplog if available\n\t\tthis.on('newListener', (event/* , listener*/) => {\n\t\t\tif (event === 'change' && alreadyListeningToOplog === false) {\n\t\t\t\talreadyListeningToOplog = true;\n\t\t\t\tif (isOplogEnabled) {\n\t\t\t\t\tconst query = {\n\t\t\t\t\t\tcollection: this.collectionName,\n\t\t\t\t\t};\n\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry(query, this.processOplogRecord.bind(this));\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle._defineTooFarBehind(Number.MAX_SAFE_INTEGER);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.tryEnsureIndex({ _updatedAt: 1 });\n\t}\n\n\tget baseName() {\n\t\treturn baseName;\n\t}\n\n\tsetUpdatedAt(record = {}) {\n\n\t\t// TODO: Check if this can be deleted, Rodrigo does not rememebr WHY he added it. So he removed it to fix issue #5541\n\t\t// setUpdatedAt(record = {}, checkQuery = false, query) {\n\t\t// if (checkQuery === true) {\n\t\t// \tif (!query || Object.keys(query).length === 0) {\n\t\t// \t\tthrow new Meteor.Error('Models._Base: Empty query');\n\t\t// \t}\n\t\t// }\n\n\t\tif (/(^|,)\\$/.test(Object.keys(record).join(','))) {\n\t\t\trecord.$set = record.$set || {};\n\t\t\trecord.$set._updatedAt = new Date;\n\t\t} else {\n\t\t\trecord._updatedAt = new Date;\n\t\t}\n\n\t\treturn record;\n\t}\n\n\twrapModel() {\n\t\tthis.originals = {\n\t\t\tinsert: this.model.insert.bind(this.model),\n\t\t\tupdate: this.model.update.bind(this.model),\n\t\t\tremove: this.model.remove.bind(this.model),\n\t\t};\n\t\tconst self = this;\n\n\t\tthis.model.insert = function(...args) {\n\t\t\treturn self.insert(...args);\n\t\t};\n\n\t\tthis.model.update = function(...args) {\n\t\t\treturn self.update(...args);\n\t\t};\n\n\t\tthis.model.remove = function(...args) {\n\t\t\treturn self.remove(...args);\n\t\t};\n\t}\n\n\t_doNotMixInclusionAndExclusionFields(options) {\n\t\tif (options && options.fields) {\n\t\t\tconst keys = Object.keys(options.fields);\n\t\t\tconst removeKeys = keys.filter((key) => options.fields[key] === 0);\n\t\t\tif (keys.length > removeKeys.length) {\n\t\t\t\tremoveKeys.forEach((key) => delete options.fields[key]);\n\t\t\t}\n\t\t}\n\t}\n\n\tfind(...args) {\n\t\tthis._doNotMixInclusionAndExclusionFields(args[1]);\n\t\treturn this.model.find(...args);\n\t}\n\n\tfindOne(...args) {\n\t\tthis._doNotMixInclusionAndExclusionFields(args[1]);\n\t\treturn this.model.findOne(...args);\n\t}\n\n\tfindOneById(_id, options) {\n\t\treturn this.findOne({ _id }, options);\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\treturn this.findOne({ _id: { $in: ids } }, options);\n\t}\n\n\tupdateHasPositionalOperator(update) {\n\t\treturn Object.keys(update).some((key) => key.includes('.$') || (Match.test(update[key], Object) && this.updateHasPositionalOperator(update[key])));\n\t}\n\n\tprocessOplogRecord(action) {\n\t\tif (isOplogEnabled === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'i') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tclientAction: 'inserted',\n\t\t\t\tid: action.op.o._id,\n\t\t\t\tdata: action.op.o,\n\t\t\t\toplog: true,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'u') {\n\t\t\tif (!action.op.o.$set && !action.op.o.$unset) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update',\n\t\t\t\t\tclientAction: 'updated',\n\t\t\t\t\tid: action.id,\n\t\t\t\t\tdata: action.op.o,\n\t\t\t\t\toplog: true,\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst diff = {};\n\t\t\tif (action.op.o.$set) {\n\t\t\t\tfor (const key in action.op.o.$set) {\n\t\t\t\t\tif (action.op.o.$set.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = action.op.o.$set[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (action.op.o.$unset) {\n\t\t\t\tfor (const key in action.op.o.$unset) {\n\t\t\t\t\tif (action.op.o.$unset.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'update',\n\t\t\t\tclientAction: 'updated',\n\t\t\t\tid: action.id,\n\t\t\t\tdiff,\n\t\t\t\toplog: true,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'd') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'remove',\n\t\t\t\tclientAction: 'removed',\n\t\t\t\tid: action.id,\n\t\t\t\toplog: true,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t}\n\n\tinsert(record, ...args) {\n\t\tthis.setUpdatedAt(record);\n\n\t\tconst result = this.originals.insert(record, ...args);\n\n\t\trecord._id = result;\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tclientAction: 'inserted',\n\t\t\t\tid: result,\n\t\t\t\tdata: _.extend({}, record),\n\t\t\t\toplog: false,\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tupdate(query, update, options = {}) {\n\t\tthis.setUpdatedAt(update, true, query);\n\n\t\tlet ids = [];\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tconst findOptions = { fields: { _id: 1 } };\n\t\t\tlet records = options.multi ? this.find(query, findOptions).fetch() : this.findOne(query, findOptions) || [];\n\t\t\tif (!Array.isArray(records)) {\n\t\t\t\trecords = [records];\n\t\t\t}\n\n\t\t\tids = records.map((item) => item._id);\n\t\t\tif (options.upsert !== true && this.updateHasPositionalOperator(update) === false) {\n\t\t\t\tquery = {\n\t\t\t\t\t_id: {\n\t\t\t\t\t\t$in: ids,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\t// TODO: CACHE: Can we use findAndModify here when oplog is disabled?\n\t\tconst result = this.originals.update(query, update, options);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tif (options.upsert === true && result.insertedId) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'insert',\n\t\t\t\t\tclientAction: 'inserted',\n\t\t\t\t\tid: result.insertedId,\n\t\t\t\t\toplog: false,\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfor (const id of ids) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update',\n\t\t\t\t\tclientAction: 'updated',\n\t\t\t\t\tid,\n\t\t\t\t\toplog: false,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tupsert(query, update, options = {}) {\n\t\toptions.upsert = true;\n\t\toptions._returnObject = true;\n\t\treturn this.update(query, update, options);\n\t}\n\n\tremove(query) {\n\t\tconst records = this.model.find(query).fetch();\n\n\t\tconst ids = [];\n\t\tfor (const record of records) {\n\t\t\tids.push(record._id);\n\n\t\t\trecord._deletedAt = new Date;\n\t\t\trecord.__collection__ = this.name;\n\n\t\t\ttrash.upsert({ _id: record._id }, _.omit(record, '_id'));\n\t\t}\n\n\t\tquery = { _id: { $in: ids } };\n\n\t\tconst result = this.originals.remove(query);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tfor (const record of records) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'remove',\n\t\t\t\t\tclientAction: 'removed',\n\t\t\t\t\tid: record._id,\n\t\t\t\t\tdata: _.extend({}, record),\n\t\t\t\t\toplog: false,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tinsertOrUpsert(...args) {\n\t\tif (args[0] && args[0]._id) {\n\t\t\tconst { _id } = args[0];\n\t\t\tdelete args[0]._id;\n\t\t\targs.unshift({\n\t\t\t\t_id,\n\t\t\t});\n\n\t\t\tthis.upsert(...args);\n\t\t\treturn _id;\n\t\t} else {\n\t\t\treturn this.insert(...args);\n\t\t}\n\t}\n\n\tallow(...args) {\n\t\treturn this.model.allow(...args);\n\t}\n\n\tdeny(...args) {\n\t\treturn this.model.deny(...args);\n\t}\n\n\tensureIndex(...args) {\n\t\treturn this.model._ensureIndex(...args);\n\t}\n\n\tdropIndex(...args) {\n\t\treturn this.model._dropIndex(...args);\n\t}\n\n\ttryEnsureIndex(...args) {\n\t\ttry {\n\t\t\treturn this.ensureIndex(...args);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error creating index:', this.name, '->', ...args, e);\n\t\t}\n\t}\n\n\ttryDropIndex(...args) {\n\t\ttry {\n\t\t\treturn this.dropIndex(...args);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error dropping index:', this.name, '->', ...args, e);\n\t\t}\n\t}\n\n\ttrashFind(query, options) {\n\t\tquery.__collection__ = this.name;\n\n\t\treturn trash.find(query, options);\n\t}\n\n\ttrashFindOneById(_id, options) {\n\t\tconst query = {\n\t\t\t_id,\n\t\t\t__collection__: this.name,\n\t\t};\n\n\t\treturn trash.findOne(query, options);\n\t}\n\n\ttrashFindDeletedAfter(deletedAt, query = {}, options) {\n\t\tquery.__collection__ = this.name;\n\t\tquery._deletedAt = {\n\t\t\t$gt: deletedAt,\n\t\t};\n\n\t\treturn trash.find(query, options);\n\t}\n}\n\nexport default ModelsBaseDb;\n","import _ from 'underscore';\n\nconst AccessTokenServices = {};\n\nRocketChat.registerAccessTokenService = function(serviceName, handleAccessTokenRequest) {\n\tAccessTokenServices[serviceName] = {\n\t\tserviceName,\n\t\thandleAccessTokenRequest,\n\t};\n};\n\n// Listen to calls to `login` with an oauth option set. This is where\n// users actually get logged in to meteor via oauth.\nAccounts.registerLoginHandler(function(options) {\n\tif (!options.accessToken) {\n\t\treturn undefined; // don't handle\n\t}\n\n\tcheck(options, Match.ObjectIncluding({\n\t\tserviceName: String,\n\t}));\n\n\tconst service = AccessTokenServices[options.serviceName];\n\n\t// Skip everything if there's no service set by the oauth middleware\n\tif (!service) {\n\t\tthrow new Error(`Unexpected AccessToken service ${ options.serviceName }`);\n\t}\n\n\t// Make sure we're configured\n\tif (!ServiceConfiguration.configurations.findOne({ service: service.serviceName })) {\n\t\tthrow new ServiceConfiguration.ConfigError();\n\t}\n\n\tif (!_.contains(Accounts.oauth.serviceNames(), service.serviceName)) {\n\t\t// serviceName was not found in the registered services list.\n\t\t// This could happen because the service never registered itself or\n\t\t// unregisterService was called on it.\n\t\treturn {\n\t\t\ttype: 'oauth',\n\t\t\terror: new Meteor.Error(\n\t\t\t\tAccounts.LoginCancelledError.numericError,\n\t\t\t\t`No registered oauth service found for: ${ service.serviceName }`\n\t\t\t),\n\t\t};\n\t}\n\n\tconst oauthResult = service.handleAccessTokenRequest(options);\n\n\treturn Accounts.updateOrCreateUserFromExternalService(service.serviceName, oauthResult.serviceData, oauthResult.options);\n});\n\n\n","import _ from 'underscore';\nimport { OAuth } from 'meteor/oauth';\nconst crypto = Npm.require('crypto');\nconst whitelisted = [\n\t'id',\n\t'email',\n\t'name',\n\t'first_name',\n\t'last_name',\n\t'link',\n\t'gender',\n\t'locale',\n\t'age_range'];\n\nconst FB_API_VERSION = 'v2.9';\nconst FB_URL = 'https://graph.facebook.com';\n\nconst getIdentity = function(accessToken, fields, secret) {\n\tconst hmac = crypto.createHmac('sha256', OAuth.openSecret(secret));\n\thmac.update(accessToken);\n\n\ttry {\n\t\treturn HTTP.get(`${ FB_URL }/${ FB_API_VERSION }/me`, {\n\t\t\tparams: {\n\t\t\t\taccess_token: accessToken,\n\t\t\t\tappsecret_proof: hmac.digest('hex'),\n\t\t\t\tfields: fields.join(','),\n\t\t\t},\n\t\t}).data;\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch identity from Facebook. ${ err.message }`),\n\t\t\t{ response: err.response });\n\t}\n};\n\nRocketChat.registerAccessTokenService('facebook', function(options) {\n\tcheck(options, Match.ObjectIncluding({\n\t\taccessToken: String,\n\t\tsecret: String,\n\t\texpiresIn: Match.Integer,\n\t\tidentity: Match.Maybe(Object),\n\t}));\n\n\tconst identity = options.identity || getIdentity(options.accessToken, whitelisted, options.secret);\n\n\tconst serviceData = {\n\t\taccessToken: options.accessToken,\n\t\texpiresAt: (+new Date) + (1000 * parseInt(options.expiresIn, 10)),\n\t};\n\n\tconst fields = _.pick(identity, whitelisted);\n\t_.extend(serviceData, fields);\n\n\treturn {\n\t\tserviceData,\n\t\toptions: {\n\t\t\tprofile: {\n\t\t\t\tname: identity.name,\n\t\t\t},\n\t\t},\n\t};\n});\n\n","import Twit from 'twit';\nimport _ from 'underscore';\n\nconst whitelistedFields = [\n\t'id',\n\t'name',\n\t'description',\n\t'profile_image_url',\n\t'profile_image_url_https',\n\t'lang',\n\t'email',\n];\n\nconst getIdentity = function(accessToken, appId, appSecret, accessTokenSecret) {\n\tconst Twitter = new Twit({\n\t\tconsumer_key: appId,\n\t\tconsumer_secret: appSecret,\n\t\taccess_token: accessToken,\n\t\taccess_token_secret: accessTokenSecret,\n\t});\n\tconst syncTwitter = Meteor.wrapAsync(Twitter.get, Twitter);\n\ttry {\n\t\treturn syncTwitter('account/verify_credentials.json?include_email=true');\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch identity from Twwiter. ${ err.message }`),\n\t\t\t{ response: err.response });\n\t}\n};\n\nRocketChat.registerAccessTokenService('twitter', function(options) {\n\tcheck(options, Match.ObjectIncluding({\n\t\taccessToken: String,\n\t\tappSecret: String,\n\t\tappId: String,\n\t\taccessTokenSecret: String,\n\t\texpiresIn: Match.Integer,\n\t\tidentity: Match.Maybe(Object),\n\t}));\n\n\tconst identity = options.identity || getIdentity(options.accessToken, options.appId, options.appSecret, options.accessTokenSecret);\n\n\tconst serviceData = {\n\t\taccessToken: options.accessToken,\n\t\texpiresAt: (+new Date) + (1000 * parseInt(options.expiresIn, 10)),\n\t};\n\n\tconst fields = _.pick(identity, whitelistedFields);\n\t_.extend(serviceData, fields);\n\n\treturn {\n\t\tserviceData,\n\t\toptions: {\n\t\t\tprofile: {\n\t\t\t\tname: identity.name,\n\t\t\t},\n\t\t},\n\t};\n});\n","/* globals Google */\nimport _ from 'underscore';\n\nfunction getIdentity(accessToken) {\n\ttry {\n\t\treturn HTTP.get(\n\t\t\t'https://www.googleapis.com/oauth2/v1/userinfo',\n\t\t\t{ params: { access_token: accessToken } }).data;\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch identity from Google. ${ err.message }`), { response: err.response });\n\t}\n}\n\nfunction getScopes(accessToken) {\n\ttry {\n\t\treturn HTTP.get(\n\t\t\t'https://www.googleapis.com/oauth2/v1/tokeninfo',\n\t\t\t{ params: { access_token: accessToken } }).data.scope.split(' ');\n\t} catch (err) {\n\t\tthrow _.extend(new Error(`Failed to fetch tokeninfo from Google. ${ err.message }`), { response: err.response });\n\t}\n}\n\n\nRocketChat.registerAccessTokenService('google', function(options) {\n\tcheck(options, Match.ObjectIncluding({\n\t\taccessToken: String,\n\t\tidToken: String,\n\t\texpiresIn: Match.Integer,\n\t\tscope: Match.Maybe(String),\n\t\tidentity: Match.Maybe(Object),\n\t}));\n\n\tconst identity = options.identity || getIdentity(options.accessToken);\n\n\tconst serviceData = {\n\t\taccessToken: options.accessToken,\n\t\tidToken: options.idToken,\n\t\texpiresAt: (+new Date) + (1000 * parseInt(options.expiresIn, 10)),\n\t\tscope: options.scopes || getScopes(options.accessToken),\n\t};\n\n\tconst fields = _.pick(identity, Google.whitelistedFields);\n\t_.extend(serviceData, fields);\n\n\t// only set the token in serviceData if it's there. this ensures\n\t// that we don't lose old ones (since we only get this on the first\n\t// log in attempt)\n\tif (options.refreshToken) {\n\t\tserviceData.refreshToken = options.refreshToken;\n\t}\n\n\treturn {\n\t\tserviceData,\n\t\toptions: {\n\t\t\tprofile: {\n\t\t\t\tname: identity.name,\n\t\t\t},\n\t\t},\n\t};\n});\n","/* globals OAuth */\nimport _ from 'underscore';\n\nOAuth._redirectUri = _.wrap(OAuth._redirectUri, function(func, serviceName, ...args) {\n\tconst proxy = RocketChat.settings.get('Accounts_OAuth_Proxy_services').replace(/\\s/g, '').split(',');\n\tif (proxy.includes(serviceName)) {\n\t\treturn `${ RocketChat.settings.get('Accounts_OAuth_Proxy_host') }/oauth_redirect`;\n\t} else {\n\t\treturn func(serviceName, ...args);\n\t}\n\n});\n","import { StatsD } from 'node-dogstatsd';\n\nRocketChat.statsTracker = new (class StatsTracker {\n\tconstructor() {\n\t\tthis.StatsD = StatsD;\n\t\tthis.dogstatsd = new this.StatsD();\n\t}\n\n\ttrack(type, stats, ...args) {\n\t\tthis.dogstatsd[type](`RocketChat.${ stats }`, ...args);\n\t}\n\n\tnow() {\n\t\tconst hrtime = process.hrtime();\n\t\treturn (hrtime[0] * 1000000 + hrtime[1] / 1000);\n\t}\n\n\ttiming(stats, time, tags) {\n\t\tthis.track('timing', stats, time, tags);\n\t}\n\n\tincrement(stats, time, tags) {\n\t\tthis.track('increment', stats, time, tags);\n\t}\n\n\tdecrement(stats, time, tags) {\n\t\tthis.track('decrement', stats, time, tags);\n\t}\n\n\thistogram(stats, time, tags) {\n\t\tthis.track('histogram', stats, time, tags);\n\t}\n\n\tgauge(stats, time, tags) {\n\t\tthis.track('gauge', stats, time, tags);\n\t}\n\n\tunique(stats, time, tags) {\n\t\tthis.track('unique', stats, time, tags);\n\t}\n\n\tset(stats, time, tags) {\n\t\tthis.track('set', stats, time, tags);\n\t}\n});\n","/* globals WebAppInternals*/\nimport _ from 'underscore';\n\nfunction testWebAppInternals(fn) {\n\ttypeof WebAppInternals !== 'undefined' && fn(WebAppInternals);\n}\nRocketChat.settings.onload('CDN_PREFIX', function(key, value) {\n\tconst useForAll = RocketChat.settings.get('CDN_PREFIX_ALL');\n\tif (_.isString(value) && value.trim() && useForAll) {\n\t\treturn testWebAppInternals((WebAppInternals) => WebAppInternals.setBundledJsCssPrefix(value));\n\t}\n});\n\nRocketChat.settings.onload('CDN_JSCSS_PREFIX', function(key, value) {\n\tconst useForAll = RocketChat.settings.get('CDN_PREFIX_ALL');\n\tif (_.isString(value) && value.trim() && !useForAll) {\n\t\treturn testWebAppInternals((WebAppInternals) => WebAppInternals.setBundledJsCssPrefix(value));\n\t}\n});\n\nMeteor.startup(function() {\n\tconst cdnValue = RocketChat.settings.get('CDN_PREFIX');\n\tconst useForAll = RocketChat.settings.get('CDN_PREFIX_ALL');\n\tconst cdnJsCss = RocketChat.settings.get('CDN_JSCSS_PREFIX');\n\tif (_.isString(cdnValue) && cdnValue.trim()) {\n\t\tif (useForAll) {\n\t\t\treturn testWebAppInternals((WebAppInternals) => WebAppInternals.setBundledJsCssPrefix(cdnValue));\n\t\t} else if (_.isString(cdnJsCss) && cdnJsCss.trim()) {\n\t\t\treturn testWebAppInternals((WebAppInternals) => WebAppInternals.setBundledJsCssPrefix(cdnJsCss));\n\t\t}\n\t}\n});\n","import _ from 'underscore';\nimport { IMAPIntercepter, POP3Helper } from '../lib/interceptDirectReplyEmails.js';\n\nconst startEmailIntercepter = _.debounce(Meteor.bindEnvironment(function() {\n\tconsole.log('Starting Email Intercepter...');\n\n\tif (RocketChat.settings.get('Direct_Reply_Enable') && RocketChat.settings.get('Direct_Reply_Protocol') && RocketChat.settings.get('Direct_Reply_Host') && RocketChat.settings.get('Direct_Reply_Port') && RocketChat.settings.get('Direct_Reply_Username') && RocketChat.settings.get('Direct_Reply_Password')) {\n\t\tif (RocketChat.settings.get('Direct_Reply_Protocol') === 'IMAP') {\n\t\t\t// stop already running IMAP instance\n\t\t\tif (RocketChat.IMAP && RocketChat.IMAP.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running IMAP instance...');\n\t\t\t\tRocketChat.IMAP.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new IMAP instance......');\n\t\t\t\t\tRocketChat.IMAP = new IMAPIntercepter();\n\t\t\t\t\tRocketChat.IMAP.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else if (RocketChat.POP3 && RocketChat.POP3Helper && RocketChat.POP3Helper.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running POP instance...');\n\t\t\t\tRocketChat.POP3Helper.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new IMAP instance......');\n\t\t\t\t\tRocketChat.IMAP = new IMAPIntercepter();\n\t\t\t\t\tRocketChat.IMAP.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\tconsole.log('Starting new IMAP instance......');\n\t\t\t\tRocketChat.IMAP = new IMAPIntercepter();\n\t\t\t\tRocketChat.IMAP.start();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else if (RocketChat.settings.get('Direct_Reply_Protocol') === 'POP') {\n\t\t\t// stop already running POP instance\n\t\t\tif (RocketChat.POP3 && RocketChat.POP3Helper && RocketChat.POP3Helper.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running POP instance...');\n\t\t\t\tRocketChat.POP3Helper.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new POP instance......');\n\t\t\t\t\tRocketChat.POP3Helper = new POP3Helper();\n\t\t\t\t\tRocketChat.POP3Helper.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else if (RocketChat.IMAP && RocketChat.IMAP.isActive()) {\n\t\t\t\tconsole.log('Disconnecting already running IMAP instance...');\n\t\t\t\tRocketChat.IMAP.stop(Meteor.bindEnvironment(function() {\n\t\t\t\t\tconsole.log('Starting new POP instance......');\n\t\t\t\t\tRocketChat.POP3Helper = new POP3Helper();\n\t\t\t\t\tRocketChat.POP3Helper.start();\n\t\t\t\t\treturn true;\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\tconsole.log('Starting new POP instance......');\n\t\t\t\tRocketChat.POP3Helper = new POP3Helper();\n\t\t\t\tRocketChat.POP3Helper.start();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t} else if (RocketChat.IMAP && RocketChat.IMAP.isActive()) {\n\t\t// stop IMAP instance\n\t\tRocketChat.IMAP.stop();\n\t} else if (RocketChat.POP3 && RocketChat.POP3Helper.isActive()) {\n\t\t// stop POP3 instance\n\t\tRocketChat.POP3Helper.stop();\n\t}\n}), 1000);\n\nRocketChat.settings.onload(/^Direct_Reply_.+/, startEmailIntercepter);\n","import _ from 'underscore';\n\nconst buildMailURL = _.debounce(function() {\n\tconsole.log('Updating process.env.MAIL_URL');\n\n\tif (RocketChat.settings.get('SMTP_Host')) {\n\t\tprocess.env.MAIL_URL = `${ RocketChat.settings.get('SMTP_Protocol') }://`;\n\n\t\tif (RocketChat.settings.get('SMTP_Username') && RocketChat.settings.get('SMTP_Password')) {\n\t\t\tprocess.env.MAIL_URL += `${ encodeURIComponent(RocketChat.settings.get('SMTP_Username')) }:${ encodeURIComponent(RocketChat.settings.get('SMTP_Password')) }@`;\n\t\t}\n\n\t\tprocess.env.MAIL_URL += encodeURIComponent(RocketChat.settings.get('SMTP_Host'));\n\n\t\tif (RocketChat.settings.get('SMTP_Port')) {\n\t\t\tprocess.env.MAIL_URL += `:${ parseInt(RocketChat.settings.get('SMTP_Port')) }`;\n\t\t}\n\n\t\tprocess.env.MAIL_URL += `?pool=${ RocketChat.settings.get('SMTP_Pool') }`;\n\n\t\tif (RocketChat.settings.get('SMTP_Protocol') === 'smtp' && RocketChat.settings.get('SMTP_IgnoreTLS')) {\n\t\t\tprocess.env.MAIL_URL += '&secure=false&ignoreTLS=true';\n\t\t}\n\n\t\treturn process.env.MAIL_URL;\n\t}\n}, 500);\n\nRocketChat.settings.onload('SMTP_Host', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Port', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_Username', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Password', function(key, value) {\n\tif (_.isString(value)) {\n\t\treturn buildMailURL();\n\t}\n});\n\nRocketChat.settings.onload('SMTP_Protocol', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_Pool', function() {\n\treturn buildMailURL();\n});\n\nRocketChat.settings.onload('SMTP_IgnoreTLS', function() {\n\treturn buildMailURL();\n});\n\nMeteor.startup(function() {\n\treturn buildMailURL();\n});\n","/* globals CustomOAuth */\nimport _ from 'underscore';\n\nconst logger = new Logger('rocketchat:lib', {\n\tmethods: {\n\t\toauth_updated: {\n\t\t\ttype: 'info',\n\t\t},\n\t},\n});\n\nfunction _OAuthServicesUpdate() {\n\tconst services = RocketChat.settings.get(/^(Accounts_OAuth_|Accounts_OAuth_Custom-)[a-z0-9_]+$/i);\n\tservices.forEach((service) => {\n\t\tlogger.oauth_updated(service.key);\n\t\tlet serviceName = service.key.replace('Accounts_OAuth_', '');\n\t\tif (serviceName === 'Meteor') {\n\t\t\tserviceName = 'meteor-developer';\n\t\t}\n\t\tif (/Accounts_OAuth_Custom-/.test(service.key)) {\n\t\t\tserviceName = service.key.replace('Accounts_OAuth_Custom-', '');\n\t\t}\n\t\tif (service.value === true) {\n\t\t\tconst data = {\n\t\t\t\tclientId: RocketChat.settings.get(`${ service.key }_id`),\n\t\t\t\tsecret: RocketChat.settings.get(`${ service.key }_secret`),\n\t\t\t};\n\t\t\tif (/Accounts_OAuth_Custom-/.test(service.key)) {\n\t\t\t\tdata.custom = true;\n\t\t\t\tdata.clientId = RocketChat.settings.get(`${ service.key }-id`);\n\t\t\t\tdata.secret = RocketChat.settings.get(`${ service.key }-secret`);\n\t\t\t\tdata.serverURL = RocketChat.settings.get(`${ service.key }-url`);\n\t\t\t\tdata.tokenPath = RocketChat.settings.get(`${ service.key }-token_path`);\n\t\t\t\tdata.identityPath = RocketChat.settings.get(`${ service.key }-identity_path`);\n\t\t\t\tdata.authorizePath = RocketChat.settings.get(`${ service.key }-authorize_path`);\n\t\t\t\tdata.scope = RocketChat.settings.get(`${ service.key }-scope`);\n\t\t\t\tdata.buttonLabelText = RocketChat.settings.get(`${ service.key }-button_label_text`);\n\t\t\t\tdata.buttonLabelColor = RocketChat.settings.get(`${ service.key }-button_label_color`);\n\t\t\t\tdata.loginStyle = RocketChat.settings.get(`${ service.key }-login_style`);\n\t\t\t\tdata.buttonColor = RocketChat.settings.get(`${ service.key }-button_color`);\n\t\t\t\tdata.tokenSentVia = RocketChat.settings.get(`${ service.key }-token_sent_via`);\n\t\t\t\tdata.identityTokenSentVia = RocketChat.settings.get(`${ service.key }-identity_token_sent_via`);\n\t\t\t\tdata.usernameField = RocketChat.settings.get(`${ service.key }-username_field`);\n\t\t\t\tdata.mergeUsers = RocketChat.settings.get(`${ service.key }-merge_users`);\n\t\t\t\tnew CustomOAuth(serviceName.toLowerCase(), {\n\t\t\t\t\tserverURL: data.serverURL,\n\t\t\t\t\ttokenPath: data.tokenPath,\n\t\t\t\t\tidentityPath: data.identityPath,\n\t\t\t\t\tauthorizePath: data.authorizePath,\n\t\t\t\t\tscope: data.scope,\n\t\t\t\t\tloginStyle: data.loginStyle,\n\t\t\t\t\ttokenSentVia: data.tokenSentVia,\n\t\t\t\t\tidentityTokenSentVia: data.identityTokenSentVia,\n\t\t\t\t\tusernameField: data.usernameField,\n\t\t\t\t\tmergeUsers: data.mergeUsers,\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (serviceName === 'Facebook') {\n\t\t\t\tdata.appId = data.clientId;\n\t\t\t\tdelete data.clientId;\n\t\t\t}\n\t\t\tif (serviceName === 'Twitter') {\n\t\t\t\tdata.consumerKey = data.clientId;\n\t\t\t\tdelete data.clientId;\n\t\t\t}\n\t\t\tServiceConfiguration.configurations.upsert({\n\t\t\t\tservice: serviceName.toLowerCase(),\n\t\t\t}, {\n\t\t\t\t$set: data,\n\t\t\t});\n\t\t} else {\n\t\t\tServiceConfiguration.configurations.remove({\n\t\t\t\tservice: serviceName.toLowerCase(),\n\t\t\t});\n\t\t}\n\t});\n}\n\nconst OAuthServicesUpdate = _.debounce(Meteor.bindEnvironment(_OAuthServicesUpdate), 2000);\n\nfunction OAuthServicesRemove(_id) {\n\tconst serviceName = _id.replace('Accounts_OAuth_Custom-', '');\n\treturn ServiceConfiguration.configurations.remove({\n\t\tservice: serviceName.toLowerCase(),\n\t});\n}\n\nRocketChat.settings.get(/^Accounts_OAuth_.+/, function() {\n\treturn OAuthServicesUpdate(); // eslint-disable-line new-cap\n});\n\nRocketChat.settings.get(/^Accounts_OAuth_Custom-[a-z0-9_]+/, function(key, value) {\n\tif (!value) {\n\t\treturn OAuthServicesRemove(key);// eslint-disable-line new-cap\n\t}\n});\n","import './email';\n\n// Insert server unique id if it doesn't exist\nRocketChat.settings.add('uniqueID', process.env.DEPLOYMENT_ID || Random.id(), {\n\tpublic: true,\n\thidden: true,\n});\n\n// When you define a setting and want to add a description, you don't need to automatically define the i18nDescription\n// if you add a node to the i18n.json with the same setting name but with `_Description` it will automatically work.\n\nRocketChat.settings.addGroup('Accounts', function() {\n\tthis.add('Accounts_AllowAnonymousRead', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_AllowAnonymousWrite', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\tenableQuery: {\n\t\t\t_id: 'Accounts_AllowAnonymousRead',\n\t\t\tvalue: true,\n\t\t},\n\t});\n\tthis.add('Accounts_AllowDeleteOwnAccount', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\tenableQuery: {\n\t\t\t_id: 'Accounts_AllowUserProfileChange',\n\t\t\tvalue: true,\n\t\t},\n\t});\n\tthis.add('Accounts_AllowUserProfileChange', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_AllowUserAvatarChange', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_AllowRealNameChange', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_AllowUsernameChange', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_AllowEmailChange', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_AllowPasswordChange', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_CustomFieldsToShowInUserInfo', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_LoginExpiration', 90, {\n\t\ttype: 'int',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_ShowFormLogin', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_EmailOrUsernamePlaceholder', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\ti18nLabel: 'Placeholder_for_email_or_username_login_field',\n\t});\n\tthis.add('Accounts_PasswordPlaceholder', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\ti18nLabel: 'Placeholder_for_password_login_field',\n\t});\n\n\tthis.add('Accounts_ConfirmPasswordPlaceholder', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\ti18nLabel: 'Placeholder_for_password_login_field',\n\t});\n\tthis.add('Accounts_ForgetUserSessionOnWindowClose', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_SearchFields', 'username, name', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('Accounts_Directory_DefaultView', 'channels', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'channels',\n\t\t\t\ti18nLabel: 'Channels',\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'users',\n\t\t\t\ti18nLabel: 'Users',\n\t\t\t},\n\t\t],\n\t\tpublic: true,\n\t});\n\tthis.section('Registration', function() {\n\t\tthis.add('Accounts_DefaultUsernamePrefixSuggestion', 'user', {\n\t\t\ttype: 'string',\n\t\t});\n\t\tthis.add('Accounts_RequireNameForSignUp', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_RequirePasswordConfirmation', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_EmailVerification', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'SMTP_Host',\n\t\t\t\tvalue: {\n\t\t\t\t\t$exists: 1,\n\t\t\t\t\t$ne: '',\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tthis.add('Accounts_ManuallyApproveNewUsers', false, {\n\t\t\tpublic: true,\n\t\t\ttype: 'boolean',\n\t\t});\n\t\tthis.add('Accounts_AllowedDomainsList', '', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_BlockedDomainsList', '', {\n\t\t\ttype: 'string',\n\t\t});\n\t\tthis.add('Accounts_BlockedUsernameList', '', {\n\t\t\ttype: 'string',\n\t\t});\n\t\tthis.add('Accounts_UseDefaultBlockedDomainsList', true, {\n\t\t\ttype: 'boolean',\n\t\t});\n\t\tthis.add('Accounts_UseDNSDomainCheck', false, {\n\t\t\ttype: 'boolean',\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm', 'Public', {\n\t\t\ttype: 'select',\n\t\t\tpublic: true,\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'Public',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Public',\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Disabled',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Disabled',\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Secret URL',\n\t\t\t\t\ti18nLabel: 'Accounts_RegistrationForm_Secret_URL',\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm_SecretURL', Random.id(), {\n\t\t\ttype: 'string',\n\t\t});\n\t\tthis.add('Accounts_RegistrationForm_LinkReplacementText', 'New user registration is currently disabled', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_Registration_AuthenticationServices_Enabled', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_Registration_AuthenticationServices_Default_Roles', 'user', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_Registration_AuthenticationServices_Enabled',\n\t\t\t\tvalue: true,\n\t\t\t},\n\t\t});\n\t\tthis.add('Accounts_PasswordReset', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_CustomFields', '', {\n\t\t\ttype: 'code',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Custom_Fields',\n\t\t});\n\t});\n\n\tthis.section('Accounts_Default_User_Preferences', function() {\n\t\tthis.add('Accounts_Default_User_Preferences_enableAutoAway', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Enable_Auto_Away',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_idleTimeLimit', 300, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Idle_Time_Limit',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_desktopNotificationDuration', 0, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Notification_Duration',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_audioNotifications', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'all',\n\t\t\t\t\ti18nLabel: 'All_messages',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mentions',\n\t\t\t\t\ti18nLabel: 'Mentions',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nothing',\n\t\t\t\t\ti18nLabel: 'Nothing',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_desktopNotifications', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'all',\n\t\t\t\t\ti18nLabel: 'All_messages',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mentions',\n\t\t\t\t\ti18nLabel: 'Mentions',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nothing',\n\t\t\t\t\ti18nLabel: 'Nothing',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_mobileNotifications', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey : 'all',\n\t\t\t\t\ti18nLabel : 'All_messages',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey : 'mentions',\n\t\t\t\t\ti18nLabel : 'Mentions',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey : 'nothing',\n\t\t\t\t\ti18nLabel : 'Nothing',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_unreadAlert', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Unread_Tray_Icon_Alert',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_useEmojis', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Use_Emojis',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_convertAsciiEmoji', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Convert_Ascii_Emojis',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_autoImageLoad', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Auto_Load_Images',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_saveMobileBandwidth', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Save_Mobile_Bandwidth',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_collapseMediaByDefault', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Collapse_Embedded_Media_By_Default',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideUsernames', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Hide_usernames',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideRoles', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Hide_roles',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideFlexTab', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Hide_flextab',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_hideAvatars', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Hide_Avatars',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarGroupByType', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Group_by_Type',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarViewMode', 'medium', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'extended',\n\t\t\t\t\ti18nLabel: 'Extended',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'medium',\n\t\t\t\t\ti18nLabel: 'Medium',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'condensed',\n\t\t\t\t\ti18nLabel: 'Condensed',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Sidebar_list_mode',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarHideAvatar', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Hide_Avatars',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarShowUnread', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Unread_on_top',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sidebarShowFavorites', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Group_favorites',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_sendOnEnter', 'normal', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'normal',\n\t\t\t\t\ti18nLabel: 'Enter_Normal',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'alternative',\n\t\t\t\t\ti18nLabel: 'Enter_Alternative',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'desktop',\n\t\t\t\t\ti18nLabel: 'Only_On_Desktop',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Enter_Behaviour',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_messageViewMode', 0, {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 0,\n\t\t\t\t\ti18nLabel: 'Normal',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 1,\n\t\t\t\t\ti18nLabel: 'Cozy',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 2,\n\t\t\t\t\ti18nLabel: 'Compact',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'MessageBox_view_mode',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_emailNotificationMode', 'mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'nothing',\n\t\t\t\t\ti18nLabel: 'Email_Notification_Mode_Disabled',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mentions',\n\t\t\t\t\ti18nLabel: 'Email_Notification_Mode_All',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Email_Notification_Mode',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_roomCounterSidebar', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Show_room_counter_on_sidebar',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_newRoomNotification', 'door', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'none',\n\t\t\t\t\ti18nLabel: 'None',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'door',\n\t\t\t\t\ti18nLabel: 'Default',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'New_Room_Notification',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_newMessageNotification', 'chime', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'none',\n\t\t\t\t\ti18nLabel: 'None',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'chime',\n\t\t\t\t\ti18nLabel: 'Default',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'New_Message_Notification',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_muteFocusedConversations', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Mute_Focused_Conversations',\n\t\t});\n\t\tthis.add('Accounts_Default_User_Preferences_notificationsSoundVolume', 100, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t\ti18nLabel: 'Notifications_Sound_Volume',\n\t\t});\n\t});\n\n\tthis.section('Avatar', function() {\n\t\tthis.add('Accounts_AvatarResize', true, {\n\t\t\ttype: 'boolean',\n\t\t});\n\t\tthis.add('Accounts_AvatarSize', 200, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Accounts_AvatarResize',\n\t\t\t\tvalue: true,\n\t\t\t},\n\t\t});\n\t\tthis.add('Accounts_AvatarCacheTime', 3600, {\n\t\t\ttype: 'int',\n\t\t\ti18nDescription: 'Accounts_AvatarCacheTime_description',\n\t\t});\n\n\t\tthis.add('Accounts_AvatarBlockUnauthenticatedAccess', false, {\n\t\t\ttype: 'boolean',\n\t\t});\n\n\t\treturn this.add('Accounts_SetDefaultAvatar', true, {\n\t\t\ttype: 'boolean',\n\t\t});\n\t});\n\n\tthis.section('Password_Policy', function() {\n\t\tthis.add('Accounts_Password_Policy_Enabled', false, {\n\t\t\ttype: 'boolean',\n\t\t});\n\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_Password_Policy_Enabled',\n\t\t\tvalue: true,\n\t\t};\n\n\t\tthis.add('Accounts_Password_Policy_MinLength', 7, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery,\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_MaxLength', -1, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery,\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_ForbidRepeatingCharacters', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery,\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_ForbidRepeatingCharactersCount', 3, {\n\t\t\ttype: 'int',\n\t\t\tenableQuery,\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneLowercase', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery,\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneUppercase', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery,\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneNumber', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery,\n\t\t});\n\n\t\tthis.add('Accounts_Password_Policy_AtLeastOneSpecialCharacter', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenableQuery,\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('OAuth', function() {\n\tthis.section('Facebook', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Facebook',\n\t\t\tvalue: true,\n\t\t};\n\t\tthis.add('Accounts_OAuth_Facebook', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Facebook_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Facebook_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Facebook_callback_url', '_oauth/facebook', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery,\n\t\t});\n\t});\n\tthis.section('Google', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Google',\n\t\t\tvalue: true,\n\t\t};\n\t\tthis.add('Accounts_OAuth_Google', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Google_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Google_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Google_callback_url', '_oauth/google', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery,\n\t\t});\n\t});\n\tthis.section('GitHub', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Github',\n\t\t\tvalue: true,\n\t\t};\n\t\tthis.add('Accounts_OAuth_Github', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Github_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Github_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Github_callback_url', '_oauth/github', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery,\n\t\t});\n\t});\n\tthis.section('Linkedin', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Linkedin',\n\t\t\tvalue: true,\n\t\t};\n\t\tthis.add('Accounts_OAuth_Linkedin', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Linkedin_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Linkedin_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Linkedin_callback_url', '_oauth/linkedin', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery,\n\t\t});\n\t});\n\tthis.section('Meteor', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Meteor',\n\t\t\tvalue: true,\n\t\t};\n\t\tthis.add('Accounts_OAuth_Meteor', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Meteor_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Meteor_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Meteor_callback_url', '_oauth/meteor', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery,\n\t\t});\n\t});\n\tthis.section('Twitter', function() {\n\t\tconst enableQuery = {\n\t\t\t_id: 'Accounts_OAuth_Twitter',\n\t\t\tvalue: true,\n\t\t};\n\t\tthis.add('Accounts_OAuth_Twitter', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Twitter_id', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\tthis.add('Accounts_OAuth_Twitter_secret', '', {\n\t\t\ttype: 'string',\n\t\t\tenableQuery,\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Twitter_callback_url', '_oauth/twitter', {\n\t\t\ttype: 'relativeUrl',\n\t\t\treadonly: true,\n\t\t\tforce: true,\n\t\t\tenableQuery,\n\t\t});\n\t});\n\treturn this.section('Proxy', function() {\n\t\tthis.add('Accounts_OAuth_Proxy_host', 'https://oauth-proxy.rocket.chat', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t});\n\t\treturn this.add('Accounts_OAuth_Proxy_services', '', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('General', function() {\n\tthis.add('Show_Setup_Wizard', 'pending', {\n\t\ttype: 'select',\n\t\tpublic: true,\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'pending',\n\t\t\t\ti18nLabel: 'Pending',\n\t\t\t}, {\n\t\t\t\tkey: 'in_progress',\n\t\t\t\ti18nLabel: 'In_progress',\n\t\t\t}, {\n\t\t\t\tkey: 'completed',\n\t\t\t\ti18nLabel: 'Completed',\n\t\t\t},\n\t\t],\n\t});\n\tthis.add('Site_Url', typeof __meteor_runtime_config__ !== 'undefined' && __meteor_runtime_config__ !== null ? __meteor_runtime_config__.ROOT_URL : null, {\n\t\ttype: 'string',\n\t\ti18nDescription: 'Site_Url_Description',\n\t\tpublic: true,\n\t});\n\tthis.add('Site_Name', 'Rocket.Chat', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\twizard: {\n\t\t\tstep: 3,\n\t\t\torder: 0,\n\t\t},\n\t});\n\tthis.add('Document_Domain', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('Language', '', {\n\t\ttype: 'language',\n\t\tpublic: true,\n\t\twizard: {\n\t\t\tstep: 3,\n\t\t\torder: 1,\n\t\t},\n\t});\n\tthis.add('Allow_Invalid_SelfSigned_Certs', false, {\n\t\ttype: 'boolean',\n\t});\n\tthis.add('Favorite_Rooms', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('First_Channel_After_Login', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('Unread_Count', 'user_and_group_mentions_only', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'all_messages',\n\t\t\t\ti18nLabel: 'All_messages',\n\t\t\t}, {\n\t\t\t\tkey: 'user_mentions_only',\n\t\t\t\ti18nLabel: 'User_mentions_only',\n\t\t\t}, {\n\t\t\t\tkey: 'group_mentions_only',\n\t\t\t\ti18nLabel: 'Group_mentions_only',\n\t\t\t}, {\n\t\t\t\tkey: 'user_and_group_mentions_only',\n\t\t\t\ti18nLabel: 'User_and_group_mentions_only',\n\t\t\t},\n\t\t],\n\t\tpublic: true,\n\t});\n\tthis.add('Unread_Count_DM', 'all_messages', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'all_messages',\n\t\t\t\ti18nLabel: 'All_messages',\n\t\t\t}, {\n\t\t\t\tkey: 'mentions_only',\n\t\t\t\ti18nLabel: 'Mentions_only',\n\t\t\t},\n\t\t],\n\t\tpublic: true,\n\t});\n\tthis.add('CDN_PREFIX', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('CDN_PREFIX_ALL', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('CDN_JSCSS_PREFIX', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\tenableQuery: {\n\t\t\t_id: 'CDN_PREFIX_ALL',\n\t\t\tvalue: false,\n\t\t},\n\t});\n\tthis.add('Force_SSL', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('GoogleTagManager_id', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('Bugsnag_api_key', '', {\n\t\ttype: 'string',\n\t\tpublic: false,\n\t});\n\tthis.add('Force_Disable_OpLog_For_Cache', false, {\n\t\ttype: 'boolean',\n\t\tpublic: false,\n\t});\n\tthis.add('Restart', 'restart_server', {\n\t\ttype: 'action',\n\t\tactionText: 'Restart_the_server',\n\t});\n\tthis.add('Store_Last_Message', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\ti18nDescription: 'Store_Last_Message_Sent_per_Room',\n\t});\n\tthis.section('UTF8', function() {\n\t\tthis.add('UTF8_Names_Validation', '[0-9a-zA-Z-_.]+', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'UTF8_Names_Validation_Description',\n\t\t});\n\t\treturn this.add('UTF8_Names_Slugify', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t});\n\tthis.section('Reporting', function() {\n\t\treturn this.add('Statistics_reporting', true, {\n\t\t\ttype: 'boolean',\n\t\t});\n\t});\n\tthis.section('Notifications', function() {\n\t\tthis.add('Notifications_Max_Room_Members', 100, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'Notifications_Max_Room_Members_Description',\n\t\t});\n\n\t\tthis.add('Notifications_Always_Notify_Mobile', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'Notifications_Always_Notify_Mobile_Description',\n\t\t});\n\t});\n\tthis.section('REST API', function() {\n\t\treturn this.add('API_User_Limit', 500, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'API_User_Limit',\n\t\t});\n\t});\n\tthis.section('Iframe_Integration', function() {\n\t\tthis.add('Iframe_Integration_send_enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Iframe_Integration_send_target_origin', '*', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Iframe_Integration_send_enable',\n\t\t\t\tvalue: true,\n\t\t\t},\n\t\t});\n\t\tthis.add('Iframe_Integration_receive_enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\treturn this.add('Iframe_Integration_receive_origin', '*', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Iframe_Integration_receive_enable',\n\t\t\t\tvalue: true,\n\t\t\t},\n\t\t});\n\t});\n\tthis.section('Translations', function() {\n\t\treturn this.add('Custom_Translations', '', {\n\t\t\ttype: 'code',\n\t\t\tpublic: true,\n\t\t});\n\t});\n\treturn this.section('Stream_Cast', function() {\n\t\treturn this.add('Stream_Cast_Address', '', {\n\t\t\ttype: 'string',\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Message', function() {\n\tthis.section('Message_Attachments', function() {\n\t\tthis.add('Message_Attachments_GroupAttach', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'Message_Attachments_GroupAttachDescription',\n\t\t});\n\t});\n\tthis.section('Message_Audio', function() {\n\t\tthis.add('Message_AudioRecorderEnabled', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'Message_AudioRecorderEnabledDescription',\n\t\t});\n\t\tthis.add('Message_Audio_bitRate', 32, {\n\t\t\ttype: 'int',\n\t\t\tpublic: true,\n\t\t});\n\t});\n\tthis.add('Message_AllowEditing', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_AllowEditing_BlockEditInMinutes', 0, {\n\t\ttype: 'int',\n\t\tpublic: true,\n\t\ti18nDescription: 'Message_AllowEditing_BlockEditInMinutesDescription',\n\t});\n\tthis.add('Message_AllowDeleting', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_AllowDeleting_BlockDeleteInMinutes', 0, {\n\t\ttype: 'int',\n\t\tpublic: true,\n\t\ti18nDescription: 'Message_AllowDeleting_BlockDeleteInMinutes',\n\t});\n\tthis.add('Message_AllowUnrecognizedSlashCommand', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_AllowDirectMessagesToYourself', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_AlwaysSearchRegExp', false, {\n\t\ttype: 'boolean',\n\t});\n\tthis.add('Message_ShowEditedStatus', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_ShowDeletedStatus', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_AllowBadWordsFilter', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_BadWordsFilterList', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_KeepHistory', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_MaxAll', 0, {\n\t\ttype: 'int',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_MaxAllowedSize', 5000, {\n\t\ttype: 'int',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_ShowFormattingTips', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_SetNameToAliasEnabled', false, {\n\t\ttype: 'boolean',\n\t\tpublic: false,\n\t\ti18nDescription: 'Message_SetNameToAliasEnabled_Description',\n\t});\n\tthis.add('Message_GroupingPeriod', 300, {\n\t\ttype: 'int',\n\t\tpublic: true,\n\t\ti18nDescription: 'Message_GroupingPeriodDescription',\n\t});\n\tthis.add('API_Embed', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('API_Embed_UserAgent', 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t});\n\tthis.add('API_EmbedCacheExpirationDays', 30, {\n\t\ttype: 'int',\n\t\tpublic: false,\n\t});\n\tthis.add('API_Embed_clear_cache_now', 'OEmbedCacheCleanup', {\n\t\ttype: 'action',\n\t\tactionText: 'clear',\n\t\ti18nLabel: 'clear_cache_now',\n\t});\n\tthis.add('API_EmbedDisabledFor', '', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\ti18nDescription: 'API_EmbedDisabledFor_Description',\n\t});\n\tthis.add('API_EmbedIgnoredHosts', 'localhost, 127.0.0.1, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16', {\n\t\ttype: 'string',\n\t\ti18nDescription: 'API_EmbedIgnoredHosts_Description',\n\t});\n\tthis.add('API_EmbedSafePorts', '80, 443', {\n\t\ttype: 'string',\n\t});\n\tthis.add('Message_TimeFormat', 'LT', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\ti18nDescription: 'Message_TimeFormat_Description',\n\t});\n\tthis.add('Message_DateFormat', 'LL', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\ti18nDescription: 'Message_DateFormat_Description',\n\t});\n\tthis.add('Message_TimeAndDateFormat', 'LLL', {\n\t\ttype: 'string',\n\t\tpublic: true,\n\t\ti18nDescription: 'Message_TimeAndDateFormat_Description',\n\t});\n\tthis.add('Message_QuoteChainLimit', 2, {\n\t\ttype: 'int',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_HideType_uj', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_HideType_ul', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_HideType_ru', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Message_HideType_au', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\n\tthis.add('Message_HideType_mute_unmute', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\n\tthis.add('Message_ErasureType', 'Delete', {\n\t\ttype: 'select',\n\t\tpublic: true,\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: 'Keep',\n\t\t\t\ti18nLabel: 'Message_ErasureType_Keep',\n\t\t\t}, {\n\t\t\t\tkey: 'Delete',\n\t\t\t\ti18nLabel: 'Message_ErasureType_Delete',\n\t\t\t}, {\n\t\t\t\tkey: 'Unlink',\n\t\t\t\ti18nLabel: 'Message_ErasureType_Unlink',\n\t\t\t},\n\t\t],\n\t});\n});\n\nRocketChat.settings.addGroup('Meta', function() {\n\tthis.add('Meta_language', '', {\n\t\ttype: 'string',\n\t});\n\tthis.add('Meta_fb_app_id', '', {\n\t\ttype: 'string',\n\t});\n\tthis.add('Meta_robots', 'INDEX,FOLLOW', {\n\t\ttype: 'string',\n\t});\n\tthis.add('Meta_google-site-verification', '', {\n\t\ttype: 'string',\n\t});\n\tthis.add('Meta_msvalidate01', '', {\n\t\ttype: 'string',\n\t});\n\treturn this.add('Meta_custom', '', {\n\t\ttype: 'code',\n\t\tcode: 'text/html',\n\t\tmultiline: true,\n\t});\n});\n\nRocketChat.settings.addGroup('Push', function() {\n\tthis.add('Push_enable', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\talert: 'Push_Setting_Requires_Restart_Alert',\n\t});\n\tthis.add('Push_debug', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\talert: 'Push_Setting_Requires_Restart_Alert',\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true,\n\t\t},\n\t});\n\tthis.add('Push_enable_gateway', true, {\n\t\ttype: 'boolean',\n\t\talert: 'Push_Setting_Requires_Restart_Alert',\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true,\n\t\t},\n\t});\n\tthis.add('Push_gateway', 'https://gateway.rocket.chat', {\n\t\ttype: 'string',\n\t\talert: 'Push_Setting_Requires_Restart_Alert',\n\t\tenableQuery: [\n\t\t\t{\n\t\t\t\t_id: 'Push_enable',\n\t\t\t\tvalue: true,\n\t\t\t}, {\n\t\t\t\t_id: 'Push_enable_gateway',\n\t\t\t\tvalue: true,\n\t\t\t},\n\t\t],\n\t});\n\tthis.add('Push_production', true, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t\talert: 'Push_Setting_Requires_Restart_Alert',\n\t\tenableQuery: [\n\t\t\t{\n\t\t\t\t_id: 'Push_enable',\n\t\t\t\tvalue: true,\n\t\t\t}, {\n\t\t\t\t_id: 'Push_enable_gateway',\n\t\t\t\tvalue: false,\n\t\t\t},\n\t\t],\n\t});\n\tthis.add('Push_test_push', 'push_test', {\n\t\ttype: 'action',\n\t\tactionText: 'Send_a_test_push_to_my_user',\n\t\tenableQuery: {\n\t\t\t_id: 'Push_enable',\n\t\t\tvalue: true,\n\t\t},\n\t});\n\tthis.section('Certificates_and_Keys', function() {\n\t\tthis.add('Push_apn_passphrase', '', {\n\t\t\ttype: 'string',\n\t\t});\n\t\tthis.add('Push_apn_key', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true,\n\t\t});\n\t\tthis.add('Push_apn_cert', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true,\n\t\t});\n\t\tthis.add('Push_apn_dev_passphrase', '', {\n\t\t\ttype: 'string',\n\t\t});\n\t\tthis.add('Push_apn_dev_key', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true,\n\t\t});\n\t\tthis.add('Push_apn_dev_cert', '', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true,\n\t\t});\n\t\tthis.add('Push_gcm_api_key', '', {\n\t\t\ttype: 'string',\n\t\t});\n\t\treturn this.add('Push_gcm_project_number', '', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t});\n\t});\n\treturn this.section('Privacy', function() {\n\t\tthis.add('Push_show_username_room', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\treturn this.add('Push_show_message', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Layout', function() {\n\tthis.section('Content', function() {\n\t\tthis.add('Layout_Home_Title', 'Home', {\n\t\t\ttype: 'string',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Layout_Home_Body', '<p>Welcome to Rocket.Chat!</p>\\n<p>The Rocket.Chat desktops apps for Windows, macOS and Linux are available to download <a title=\"Rocket.Chat desktop apps\" href=\"https: //rocket.chat/download\" target=\"_blank\" rel=\"noopener\">here</a>.</p><p>The native mobile app, Rocket.Chat+,\\n  for Android and iOS is available from <a title=\"Rocket.Chat+ on Google Play\" href=\"https: //play.google.com/store/apps/details?id=chat.rocket.android\" target=\"_blank\" rel=\"noopener\">Google Play</a> and the <a title=\"Rocket.Chat+ on the App Store\" href=\"https: //itunes.apple.com/app/rocket-chat/id1148741252\" target=\"_blank\" rel=\"noopener\">App Store</a>.</p>\\n<p>For further help, please consult the <a title=\"Rocket.Chat Documentation\" href=\"https: //rocket.chat/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a>.</p>\\n<p>If you\\'re an admin, feel free to change this content via <strong>Administration</strong> -> <strong>Layout</strong> -> <strong>Home Body</strong>. Or clicking <a title=\"Home Body Layout\" href=\"/admin/Layout\">here</a>.</p>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Layout_Terms_of_Service', 'Terms of Service <br> Go to APP SETTINGS -> Layout to customize this page.', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Layout_Login_Terms', 'By proceeding you are agreeing to our <a href=\"terms-of-service\">Terms of Service</a> and <a href=\"privacy-policy\">Privacy Policy</a>.', {\n\t\t\ttype: 'string',\n\t\t\tmultiline: true,\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('Layout_Privacy_Policy', 'Privacy Policy <br> Go to APP SETTINGS -> Layout to customize this page.', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\tpublic: true,\n\t\t});\n\t\treturn this.add('Layout_Sidenav_Footer', '<a href=\"/home\"><img src=\"assets/logo\"/></a>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tpublic: true,\n\t\t\ti18nDescription: 'Layout_Sidenav_Footer_description',\n\t\t});\n\t});\n\tthis.section('Custom_Scripts', function() {\n\t\tthis.add('Custom_Script_Logged_Out', '//Add your script', {\n\t\t\ttype: 'code',\n\t\t\tmultiline: true,\n\t\t\tpublic: true,\n\t\t});\n\t\treturn this.add('Custom_Script_Logged_In', '//Add your script', {\n\t\t\ttype: 'code',\n\t\t\tmultiline: true,\n\t\t\tpublic: true,\n\t\t});\n\t});\n\treturn this.section('User_Interface', function() {\n\t\tthis.add('UI_DisplayRoles', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('UI_Group_Channels_By_Type', true, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: false,\n\t\t});\n\t\tthis.add('UI_Use_Name_Avatar', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('UI_Use_Real_Name', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('UI_Click_Direct_Message', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('UI_Unread_Counter_Style', 'Different_Style_For_User_Mentions', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'Same_Style_For_Mentions',\n\t\t\t\t\ti18nLabel: 'Same_Style_For_Mentions',\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'Different_Style_For_User_Mentions',\n\t\t\t\t\ti18nLabel: 'Different_Style_For_User_Mentions',\n\t\t\t\t},\n\t\t\t],\n\t\t\tpublic: true,\n\t\t});\n\t\tthis.add('UI_Allow_room_names_with_special_chars', false, {\n\t\t\ttype: 'boolean',\n\t\t\tpublic: true,\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Logs', function() {\n\tthis.add('Log_Level', '0', {\n\t\ttype: 'select',\n\t\tvalues: [\n\t\t\t{\n\t\t\t\tkey: '0',\n\t\t\t\ti18nLabel: '0_Errors_Only',\n\t\t\t}, {\n\t\t\t\tkey: '1',\n\t\t\t\ti18nLabel: '1_Errors_and_Information',\n\t\t\t}, {\n\t\t\t\tkey: '2',\n\t\t\t\ti18nLabel: '2_Erros_Information_and_Debug',\n\t\t\t},\n\t\t],\n\t\tpublic: true,\n\t});\n\tthis.add('Log_Package', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Log_File', false, {\n\t\ttype: 'boolean',\n\t\tpublic: true,\n\t});\n\tthis.add('Log_View_Limit', 1000, {\n\t\ttype: 'int',\n\t});\n\n\tthis.add('Log_Trace_Methods', false, {\n\t\ttype: 'boolean',\n\t});\n\n\tthis.add('Log_Trace_Methods_Filter', '', {\n\t\ttype: 'string',\n\t\tenableQuery: {\n\t\t\t_id: 'Log_Trace_Methods',\n\t\t\tvalue: true,\n\t\t},\n\t});\n\n\tthis.add('Log_Trace_Subscriptions', false, {\n\t\ttype: 'boolean',\n\t});\n\n\tthis.add('Log_Trace_Subscriptions_Filter', '', {\n\t\ttype: 'string',\n\t\tenableQuery: {\n\t\t\t_id: 'Log_Trace_Subscriptions',\n\t\t\tvalue: true,\n\t\t},\n\t});\n\n\tthis.section('Prometheus', function() {\n\t\tthis.add('Prometheus_Enabled', false, {\n\t\t\ttype: 'boolean',\n\t\t\ti18nLabel: 'Enabled',\n\t\t});\n\t\t// See the default port allocation at https://github.com/prometheus/prometheus/wiki/Default-port-allocations\n\t\tthis.add('Prometheus_Port', 9458, {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Port',\n\t\t});\n\t});\n});\n\nRocketChat.settings.addGroup('Setup_Wizard', function() {\n\tthis.section('Organization_Info', function() {\n\t\tthis.add('Organization_Type', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'nonprofit',\n\t\t\t\t\ti18nLabel: 'Nonprofit',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'enterprise',\n\t\t\t\t\ti18nLabel: 'Enterprise',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'government',\n\t\t\t\t\ti18nLabel: 'Government',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'community',\n\t\t\t\t\ti18nLabel: 'Community',\n\t\t\t\t},\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 0,\n\t\t\t},\n\t\t});\n\t\tthis.add('Organization_Name', '', {\n\t\t\ttype: 'string',\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 1,\n\t\t\t},\n\t\t});\n\t\tthis.add('Industry', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'advocacy',\n\t\t\t\t\ti18nLabel: 'Advocacy',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'blockchain',\n\t\t\t\t\ti18nLabel: 'Blockchain',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'helpCenter',\n\t\t\t\t\ti18nLabel: 'Help_Center',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'manufacturing',\n\t\t\t\t\ti18nLabel: 'Manufacturing',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'education',\n\t\t\t\t\ti18nLabel: 'Education',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'insurance',\n\t\t\t\t\ti18nLabel: 'Insurance',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'logistics',\n\t\t\t\t\ti18nLabel: 'Logistics',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'consulting',\n\t\t\t\t\ti18nLabel: 'Consulting',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'entertainment',\n\t\t\t\t\ti18nLabel: 'Entertainment',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'publicRelations',\n\t\t\t\t\ti18nLabel: 'Public_Relations',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'religious',\n\t\t\t\t\ti18nLabel: 'Religious',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gaming',\n\t\t\t\t\ti18nLabel: 'Gaming',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'socialNetwork',\n\t\t\t\t\ti18nLabel: 'Social_Network',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'realEstate',\n\t\t\t\t\ti18nLabel: 'Real_Estate',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tourism',\n\t\t\t\t\ti18nLabel: 'Tourism',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'telecom',\n\t\t\t\t\ti18nLabel: 'Telecom',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'consumerGoods',\n\t\t\t\t\ti18nLabel: 'Consumer_Goods',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'financialServices',\n\t\t\t\t\ti18nLabel: 'Financial_Services',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'healthcarePharmaceutical',\n\t\t\t\t\ti18nLabel: 'Healthcare_and_Pharmaceutical',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'industry',\n\t\t\t\t\ti18nLabel: 'Industry',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'media',\n\t\t\t\t\ti18nLabel: 'Media',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'retail',\n\t\t\t\t\ti18nLabel: 'Retail',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'technologyServices',\n\t\t\t\t\ti18nLabel: 'Technology_Services',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'technologyProvider',\n\t\t\t\t\ti18nLabel: 'Technology_Provider',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'other',\n\t\t\t\t\ti18nLabel: 'Other',\n\t\t\t\t},\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 2,\n\t\t\t},\n\t\t});\n\t\tthis.add('Size', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: '0',\n\t\t\t\t\ti18nLabel: '1-10 people',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '1',\n\t\t\t\t\ti18nLabel: '11-50 people',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '2',\n\t\t\t\t\ti18nLabel: '51-100 people',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '3',\n\t\t\t\t\ti18nLabel: '101-250 people',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '4',\n\t\t\t\t\ti18nLabel: '251-500 people',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '5',\n\t\t\t\t\ti18nLabel: '501-1000 people',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '6',\n\t\t\t\t\ti18nLabel: '1001-4000 people',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: '7',\n\t\t\t\t\ti18nLabel: '4000 or more people',\n\t\t\t\t},\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 3,\n\t\t\t},\n\t\t});\n\t\tthis.add('Country', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'worldwide',\n\t\t\t\t\ti18nLabel: 'Worldwide',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'afghanistan',\n\t\t\t\t\ti18nLabel: 'Country_Afghanistan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'albania',\n\t\t\t\t\ti18nLabel: 'Country_Albania',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'algeria',\n\t\t\t\t\ti18nLabel: 'Country_Algeria',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'americanSamoa',\n\t\t\t\t\ti18nLabel: 'Country_American_Samoa',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'andorra',\n\t\t\t\t\ti18nLabel: 'Country_Andorra',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'angola',\n\t\t\t\t\ti18nLabel: 'Country_Angola',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'anguilla',\n\t\t\t\t\ti18nLabel: 'Country_Anguilla',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'antarctica',\n\t\t\t\t\ti18nLabel: 'Country_Antarctica',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'antiguaAndBarbuda',\n\t\t\t\t\ti18nLabel: 'Country_Antigua_and_Barbuda',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'argentina',\n\t\t\t\t\ti18nLabel: 'Country_Argentina',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'armenia',\n\t\t\t\t\ti18nLabel: 'Country_Armenia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'aruba',\n\t\t\t\t\ti18nLabel: 'Country_Aruba',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'australia',\n\t\t\t\t\ti18nLabel: 'Country_Australia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'austria',\n\t\t\t\t\ti18nLabel: 'Country_Austria',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'azerbaijan',\n\t\t\t\t\ti18nLabel: 'Country_Azerbaijan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bahamas',\n\t\t\t\t\ti18nLabel: 'Country_Bahamas',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bahrain',\n\t\t\t\t\ti18nLabel: 'Country_Bahrain',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bangladesh',\n\t\t\t\t\ti18nLabel: 'Country_Bangladesh',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'barbados',\n\t\t\t\t\ti18nLabel: 'Country_Barbados',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'belarus',\n\t\t\t\t\ti18nLabel: 'Country_Belarus',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'belgium',\n\t\t\t\t\ti18nLabel: 'Country_Belgium',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'belize',\n\t\t\t\t\ti18nLabel: 'Country_Belize',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'benin',\n\t\t\t\t\ti18nLabel: 'Country_Benin',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bermuda',\n\t\t\t\t\ti18nLabel: 'Country_Bermuda',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bhutan',\n\t\t\t\t\ti18nLabel: 'Country_Bhutan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bolivia',\n\t\t\t\t\ti18nLabel: 'Country_Bolivia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bosniaAndHerzegovina',\n\t\t\t\t\ti18nLabel: 'Country_Bosnia_and_Herzegovina',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'botswana',\n\t\t\t\t\ti18nLabel: 'Country_Botswana',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bouvetIsland',\n\t\t\t\t\ti18nLabel: 'Country_Bouvet_Island',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'brazil',\n\t\t\t\t\ti18nLabel: 'Country_Brazil',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'britishIndianOceanTerritory',\n\t\t\t\t\ti18nLabel: 'Country_British_Indian_Ocean_Territory',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bruneiDarussalam',\n\t\t\t\t\ti18nLabel: 'Country_Brunei_Darussalam',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'bulgaria',\n\t\t\t\t\ti18nLabel: 'Country_Bulgaria',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'burkinaFaso',\n\t\t\t\t\ti18nLabel: 'Country_Burkina_Faso',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'burundi',\n\t\t\t\t\ti18nLabel: 'Country_Burundi',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cambodia',\n\t\t\t\t\ti18nLabel: 'Country_Cambodia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cameroon',\n\t\t\t\t\ti18nLabel: 'Country_Cameroon',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'canada',\n\t\t\t\t\ti18nLabel: 'Country_Canada',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'capeVerde',\n\t\t\t\t\ti18nLabel: 'Country_Cape_Verde',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'caymanIslands',\n\t\t\t\t\ti18nLabel: 'Country_Cayman_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'centralAfricanRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Central_African_Republic',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'chad',\n\t\t\t\t\ti18nLabel: 'Country_Chad',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'chile',\n\t\t\t\t\ti18nLabel: 'Country_Chile',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'china',\n\t\t\t\t\ti18nLabel: 'Country_China',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'christmasIsland',\n\t\t\t\t\ti18nLabel: 'Country_Christmas_Island',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cocosKeelingIslands',\n\t\t\t\t\ti18nLabel: 'Country_Cocos_Keeling_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'colombia',\n\t\t\t\t\ti18nLabel: 'Country_Colombia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'comoros',\n\t\t\t\t\ti18nLabel: 'Country_Comoros',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'congo',\n\t\t\t\t\ti18nLabel: 'Country_Congo',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'congoTheDemocraticRepublicOfThe',\n\t\t\t\t\ti18nLabel: 'Country_Congo_The_Democratic_Republic_of_The',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cookIslands',\n\t\t\t\t\ti18nLabel: 'Country_Cook_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'costaRica',\n\t\t\t\t\ti18nLabel: 'Country_Costa_Rica',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'coteDivoire',\n\t\t\t\t\ti18nLabel: 'Country_Cote_Divoire',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'croatia',\n\t\t\t\t\ti18nLabel: 'Country_Croatia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cuba',\n\t\t\t\t\ti18nLabel: 'Country_Cuba',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'cyprus',\n\t\t\t\t\ti18nLabel: 'Country_Cyprus',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'czechRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Czech_Republic',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'denmark',\n\t\t\t\t\ti18nLabel: 'Country_Denmark',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'djibouti',\n\t\t\t\t\ti18nLabel: 'Country_Djibouti',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'dominica',\n\t\t\t\t\ti18nLabel: 'Country_Dominica',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'dominicanRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Dominican_Republic',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ecuador',\n\t\t\t\t\ti18nLabel: 'Country_Ecuador',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'egypt',\n\t\t\t\t\ti18nLabel: 'Country_Egypt',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'elSalvador',\n\t\t\t\t\ti18nLabel: 'Country_El_Salvador',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'equatorialGuinea',\n\t\t\t\t\ti18nLabel: 'Country_Equatorial_Guinea',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'eritrea',\n\t\t\t\t\ti18nLabel: 'Country_Eritrea',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'estonia',\n\t\t\t\t\ti18nLabel: 'Country_Estonia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ethiopia',\n\t\t\t\t\ti18nLabel: 'Country_Ethiopia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'falklandIslandsMalvinas',\n\t\t\t\t\ti18nLabel: 'Country_Falkland_Islands_Malvinas',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'faroeIslands',\n\t\t\t\t\ti18nLabel: 'Country_Faroe_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'fiji',\n\t\t\t\t\ti18nLabel: 'Country_Fiji',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'finland',\n\t\t\t\t\ti18nLabel: 'Country_Finland',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'france',\n\t\t\t\t\ti18nLabel: 'Country_France',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'frenchGuiana',\n\t\t\t\t\ti18nLabel: 'Country_French_Guiana',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'frenchPolynesia',\n\t\t\t\t\ti18nLabel: 'Country_French_Polynesia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'frenchSouthernTerritories',\n\t\t\t\t\ti18nLabel: 'Country_French_Southern_Territories',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gabon',\n\t\t\t\t\ti18nLabel: 'Country_Gabon',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gambia',\n\t\t\t\t\ti18nLabel: 'Country_Gambia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'georgia',\n\t\t\t\t\ti18nLabel: 'Country_Georgia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'germany',\n\t\t\t\t\ti18nLabel: 'Country_Germany',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ghana',\n\t\t\t\t\ti18nLabel: 'Country_Ghana',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'gibraltar',\n\t\t\t\t\ti18nLabel: 'Country_Gibraltar',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'greece',\n\t\t\t\t\ti18nLabel: 'Country_Greece',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'greenland',\n\t\t\t\t\ti18nLabel: 'Country_Greenland',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'grenada',\n\t\t\t\t\ti18nLabel: 'Country_Grenada',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guadeloupe',\n\t\t\t\t\ti18nLabel: 'Country_Guadeloupe',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guam',\n\t\t\t\t\ti18nLabel: 'Country_Guam',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guatemala',\n\t\t\t\t\ti18nLabel: 'Country_Guatemala',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guinea',\n\t\t\t\t\ti18nLabel: 'Country_Guinea',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guineaBissau',\n\t\t\t\t\ti18nLabel: 'Country_Guinea_bissau',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'guyana',\n\t\t\t\t\ti18nLabel: 'Country_Guyana',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'haiti',\n\t\t\t\t\ti18nLabel: 'Country_Haiti',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'heardIslandAndMcdonaldIslands',\n\t\t\t\t\ti18nLabel: 'Country_Heard_Island_and_Mcdonald_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'holySeeVaticanCityState',\n\t\t\t\t\ti18nLabel: 'Country_Holy_See_Vatican_City_State',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'honduras',\n\t\t\t\t\ti18nLabel: 'Country_Honduras',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'hongKong',\n\t\t\t\t\ti18nLabel: 'Country_Hong_Kong',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'hungary',\n\t\t\t\t\ti18nLabel: 'Country_Hungary',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'iceland',\n\t\t\t\t\ti18nLabel: 'Country_Iceland',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'india',\n\t\t\t\t\ti18nLabel: 'Country_India',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'indonesia',\n\t\t\t\t\ti18nLabel: 'Country_Indonesia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'iranIslamicRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Iran_Islamic_Republic_of',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'iraq',\n\t\t\t\t\ti18nLabel: 'Country_Iraq',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ireland',\n\t\t\t\t\ti18nLabel: 'Country_Ireland',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'israel',\n\t\t\t\t\ti18nLabel: 'Country_Israel',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'italy',\n\t\t\t\t\ti18nLabel: 'Country_Italy',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'jamaica',\n\t\t\t\t\ti18nLabel: 'Country_Jamaica',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'japan',\n\t\t\t\t\ti18nLabel: 'Country_Japan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'jordan',\n\t\t\t\t\ti18nLabel: 'Country_Jordan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kazakhstan',\n\t\t\t\t\ti18nLabel: 'Country_Kazakhstan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kenya',\n\t\t\t\t\ti18nLabel: 'Country_Kenya',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kiribati',\n\t\t\t\t\ti18nLabel: 'Country_Kiribati',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'koreaDemocraticPeoplesRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Korea_Democratic_Peoples_Republic_of',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'koreaRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Korea_Republic_of',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kuwait',\n\t\t\t\t\ti18nLabel: 'Country_Kuwait',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'kyrgyzstan',\n\t\t\t\t\ti18nLabel: 'Country_Kyrgyzstan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'laoPeoplesDemocraticRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Lao_Peoples_Democratic_Republic',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'latvia',\n\t\t\t\t\ti18nLabel: 'Country_Latvia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'lebanon',\n\t\t\t\t\ti18nLabel: 'Country_Lebanon',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'lesotho',\n\t\t\t\t\ti18nLabel: 'Country_Lesotho',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'liberia',\n\t\t\t\t\ti18nLabel: 'Country_Liberia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'libyanArabJamahiriya',\n\t\t\t\t\ti18nLabel: 'Country_Libyan_Arab_Jamahiriya',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'liechtenstein',\n\t\t\t\t\ti18nLabel: 'Country_Liechtenstein',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'lithuania',\n\t\t\t\t\ti18nLabel: 'Country_Lithuania',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'luxembourg',\n\t\t\t\t\ti18nLabel: 'Country_Luxembourg',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'macao',\n\t\t\t\t\ti18nLabel: 'Country_Macao',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'macedoniaTheFormerYugoslavRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Macedonia_The_Former_Yugoslav_Republic_of',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'madagascar',\n\t\t\t\t\ti18nLabel: 'Country_Madagascar',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'malawi',\n\t\t\t\t\ti18nLabel: 'Country_Malawi',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'malaysia',\n\t\t\t\t\ti18nLabel: 'Country_Malaysia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'maldives',\n\t\t\t\t\ti18nLabel: 'Country_Maldives',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mali',\n\t\t\t\t\ti18nLabel: 'Country_Mali',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'malta',\n\t\t\t\t\ti18nLabel: 'Country_Malta',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'marshallIslands',\n\t\t\t\t\ti18nLabel: 'Country_Marshall_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'martinique',\n\t\t\t\t\ti18nLabel: 'Country_Martinique',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mauritania',\n\t\t\t\t\ti18nLabel: 'Country_Mauritania',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mauritius',\n\t\t\t\t\ti18nLabel: 'Country_Mauritius',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mayotte',\n\t\t\t\t\ti18nLabel: 'Country_Mayotte',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mexico',\n\t\t\t\t\ti18nLabel: 'Country_Mexico',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'micronesiaFederatedStatesOf',\n\t\t\t\t\ti18nLabel: 'Country_Micronesia_Federated_States_of',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'moldovaRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Moldova_Republic_of',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'monaco',\n\t\t\t\t\ti18nLabel: 'Country_Monaco',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mongolia',\n\t\t\t\t\ti18nLabel: 'Country_Mongolia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'montserrat',\n\t\t\t\t\ti18nLabel: 'Country_Montserrat',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'morocco',\n\t\t\t\t\ti18nLabel: 'Country_Morocco',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'mozambique',\n\t\t\t\t\ti18nLabel: 'Country_Mozambique',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'myanmar',\n\t\t\t\t\ti18nLabel: 'Country_Myanmar',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'namibia',\n\t\t\t\t\ti18nLabel: 'Country_Namibia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nauru',\n\t\t\t\t\ti18nLabel: 'Country_Nauru',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nepal',\n\t\t\t\t\ti18nLabel: 'Country_Nepal',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'netherlands',\n\t\t\t\t\ti18nLabel: 'Country_Netherlands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'netherlandsAntilles',\n\t\t\t\t\ti18nLabel: 'Country_Netherlands_Antilles',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'newCaledonia',\n\t\t\t\t\ti18nLabel: 'Country_New_Caledonia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'newZealand',\n\t\t\t\t\ti18nLabel: 'Country_New_Zealand',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nicaragua',\n\t\t\t\t\ti18nLabel: 'Country_Nicaragua',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'niger',\n\t\t\t\t\ti18nLabel: 'Country_Niger',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'nigeria',\n\t\t\t\t\ti18nLabel: 'Country_Nigeria',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'niue',\n\t\t\t\t\ti18nLabel: 'Country_Niue',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'norfolkIsland',\n\t\t\t\t\ti18nLabel: 'Country_Norfolk_Island',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'northernMarianaIslands',\n\t\t\t\t\ti18nLabel: 'Country_Northern_Mariana_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'norway',\n\t\t\t\t\ti18nLabel: 'Country_Norway',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'oman',\n\t\t\t\t\ti18nLabel: 'Country_Oman',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'pakistan',\n\t\t\t\t\ti18nLabel: 'Country_Pakistan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'palau',\n\t\t\t\t\ti18nLabel: 'Country_Palau',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'palestinianTerritoryOccupied',\n\t\t\t\t\ti18nLabel: 'Country_Palestinian_Territory_Occupied',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'panama',\n\t\t\t\t\ti18nLabel: 'Country_Panama',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'papuaNewGuinea',\n\t\t\t\t\ti18nLabel: 'Country_Papua_New_Guinea',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'paraguay',\n\t\t\t\t\ti18nLabel: 'Country_Paraguay',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'peru',\n\t\t\t\t\ti18nLabel: 'Country_Peru',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'philippines',\n\t\t\t\t\ti18nLabel: 'Country_Philippines',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'pitcairn',\n\t\t\t\t\ti18nLabel: 'Country_Pitcairn',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'poland',\n\t\t\t\t\ti18nLabel: 'Country_Poland',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'portugal',\n\t\t\t\t\ti18nLabel: 'Country_Portugal',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'puertoRico',\n\t\t\t\t\ti18nLabel: 'Country_Puerto_Rico',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'qatar',\n\t\t\t\t\ti18nLabel: 'Country_Qatar',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'reunion',\n\t\t\t\t\ti18nLabel: 'Country_Reunion',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'romania',\n\t\t\t\t\ti18nLabel: 'Country_Romania',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'russianFederation',\n\t\t\t\t\ti18nLabel: 'Country_Russian_Federation',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'rwanda',\n\t\t\t\t\ti18nLabel: 'Country_Rwanda',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintHelena',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Helena',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintKittsAndNevis',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Kitts_and_Nevis',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintLucia',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Lucia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintPierreAndMiquelon',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Pierre_and_Miquelon',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saintVincentAndTheGrenadines',\n\t\t\t\t\ti18nLabel: 'Country_Saint_Vincent_and_The_Grenadines',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'samoa',\n\t\t\t\t\ti18nLabel: 'Country_Samoa',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sanMarino',\n\t\t\t\t\ti18nLabel: 'Country_San_Marino',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saoTomeAndPrincipe',\n\t\t\t\t\ti18nLabel: 'Country_Sao_Tome_and_Principe',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'saudiArabia',\n\t\t\t\t\ti18nLabel: 'Country_Saudi_Arabia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'senegal',\n\t\t\t\t\ti18nLabel: 'Country_Senegal',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'serbiaAndMontenegro',\n\t\t\t\t\ti18nLabel: 'Country_Serbia_and_Montenegro',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'seychelles',\n\t\t\t\t\ti18nLabel: 'Country_Seychelles',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sierraLeone',\n\t\t\t\t\ti18nLabel: 'Country_Sierra_Leone',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'singapore',\n\t\t\t\t\ti18nLabel: 'Country_Singapore',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'slovakia',\n\t\t\t\t\ti18nLabel: 'Country_Slovakia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'slovenia',\n\t\t\t\t\ti18nLabel: 'Country_Slovenia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'solomonIslands',\n\t\t\t\t\ti18nLabel: 'Country_Solomon_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'somalia',\n\t\t\t\t\ti18nLabel: 'Country_Somalia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'southAfrica',\n\t\t\t\t\ti18nLabel: 'Country_South_Africa',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'southGeorgiaAndTheSouthSandwichIslands',\n\t\t\t\t\ti18nLabel: 'Country_South_Georgia_and_The_South_Sandwich_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'spain',\n\t\t\t\t\ti18nLabel: 'Country_Spain',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sriLanka',\n\t\t\t\t\ti18nLabel: 'Country_Sri_Lanka',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sudan',\n\t\t\t\t\ti18nLabel: 'Country_Sudan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'suriname',\n\t\t\t\t\ti18nLabel: 'Country_Suriname',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'svalbardAndJanMayen',\n\t\t\t\t\ti18nLabel: 'Country_Svalbard_and_Jan_Mayen',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'swaziland',\n\t\t\t\t\ti18nLabel: 'Country_Swaziland',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'sweden',\n\t\t\t\t\ti18nLabel: 'Country_Sweden',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'switzerland',\n\t\t\t\t\ti18nLabel: 'Country_Switzerland',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'syrianArabRepublic',\n\t\t\t\t\ti18nLabel: 'Country_Syrian_Arab_Republic',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'taiwanProvinceOfChina',\n\t\t\t\t\ti18nLabel: 'Country_Taiwan_Province_of_China',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tajikistan',\n\t\t\t\t\ti18nLabel: 'Country_Tajikistan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tanzaniaUnitedRepublicOf',\n\t\t\t\t\ti18nLabel: 'Country_Tanzania_United_Republic_of',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'thailand',\n\t\t\t\t\ti18nLabel: 'Country_Thailand',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'timorLeste',\n\t\t\t\t\ti18nLabel: 'Country_Timor_leste',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'togo',\n\t\t\t\t\ti18nLabel: 'Country_Togo',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tokelau',\n\t\t\t\t\ti18nLabel: 'Country_Tokelau',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tonga',\n\t\t\t\t\ti18nLabel: 'Country_Tonga',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'trinidadAndTobago',\n\t\t\t\t\ti18nLabel: 'Country_Trinidad_and_Tobago',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tunisia',\n\t\t\t\t\ti18nLabel: 'Country_Tunisia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'turkey',\n\t\t\t\t\ti18nLabel: 'Country_Turkey',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'turkmenistan',\n\t\t\t\t\ti18nLabel: 'Country_Turkmenistan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'turksAndCaicosIslands',\n\t\t\t\t\ti18nLabel: 'Country_Turks_and_Caicos_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'tuvalu',\n\t\t\t\t\ti18nLabel: 'Country_Tuvalu',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'uganda',\n\t\t\t\t\ti18nLabel: 'Country_Uganda',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'ukraine',\n\t\t\t\t\ti18nLabel: 'Country_Ukraine',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedArabEmirates',\n\t\t\t\t\ti18nLabel: 'Country_United_Arab_Emirates',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedKingdom',\n\t\t\t\t\ti18nLabel: 'Country_United_Kingdom',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedStates',\n\t\t\t\t\ti18nLabel: 'Country_United_States',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'unitedStatesMinorOutlyingIslands',\n\t\t\t\t\ti18nLabel: 'Country_United_States_Minor_Outlying_Islands',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'uruguay',\n\t\t\t\t\ti18nLabel: 'Country_Uruguay',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'uzbekistan',\n\t\t\t\t\ti18nLabel: 'Country_Uzbekistan',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'vanuatu',\n\t\t\t\t\ti18nLabel: 'Country_Vanuatu',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'venezuela',\n\t\t\t\t\ti18nLabel: 'Country_Venezuela',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'vietNam',\n\t\t\t\t\ti18nLabel: 'Country_Viet_Nam',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'virginIslandsBritish',\n\t\t\t\t\ti18nLabel: 'Country_Virgin_Islands_British',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'virginIslandsUS',\n\t\t\t\t\ti18nLabel: 'Country_Virgin_Islands_US',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'wallisAndFutuna',\n\t\t\t\t\ti18nLabel: 'Country_Wallis_and_Futuna',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'westernSahara',\n\t\t\t\t\ti18nLabel: 'Country_Western_Sahara',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'yemen',\n\t\t\t\t\ti18nLabel: 'Country_Yemen',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'zambia',\n\t\t\t\t\ti18nLabel: 'Country_Zambia',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'zimbabwe',\n\t\t\t\t\ti18nLabel: 'Country_Zimbabwe',\n\t\t\t\t},\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 4,\n\t\t\t},\n\t\t});\n\t\tthis.add('Website', '', {\n\t\t\ttype: 'string',\n\t\t\twizard: {\n\t\t\t\tstep: 2,\n\t\t\t\torder: 5,\n\t\t\t},\n\t\t});\n\t\tthis.add('Server_Type', '', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'privateTeam',\n\t\t\t\t\ti18nLabel: 'Private_Team',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tkey: 'publicCommunity',\n\t\t\t\t\ti18nLabel: 'Public_Community',\n\t\t\t\t},\n\t\t\t],\n\t\t\twizard: {\n\t\t\t\tstep: 3,\n\t\t\t\torder: 2,\n\t\t\t},\n\t\t});\n\t\tthis.add('Allow_Marketing_Emails', true, {\n\t\t\ttype: 'boolean',\n\t\t});\n\t});\n});\n\nRocketChat.settings.init();\n","RocketChat.settings.addGroup('Email', function() {\n\tthis.section('Style', function() {\n\n\t\tthis.add('email_style', `html, body, .body { font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Helvetica Neue','Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Meiryo UI',Arial,sans-serif; }\n\n\tbody, .body {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n\n\ta {\n\t\tcolor: #1D74F5;\n\t\tfont-weight: bold;\n\t\ttext-decoration: none;\n\t\tline-height: 1.8;\n\t\tpadding-left: 2px;\n\t\tpadding-right: 2px;\n\t}\n\tp {\n\t\tmargin: 1rem 0;\n\t}\n\t.btn {\n\t\ttext-decoration: none;\n\t\tcolor: #FFF;\n\t\tbackground-color: #1D74F5;\n\t\tpadding: 12px 18px;\n\t\tfont-weight: 500;\n\t\tfont-size: 14px;\n\t\tmargin-top: 8px;\n\t\ttext-align: center;\n\t\tcursor: pointer;\n\t\tdisplay: inline-block;\n\t\tborder-radius: 2px;\n\t}\n\n\tol, ul, div {\n\t\tlist-style-position: inside;\n\t\tpadding: 16px 0 ;\n\t}\n\tli {\n\t\tpadding: 8px 0;\n\t\tfont-weight: 600;\n\t}\n\t.wrap {\n\t\twidth: 100%;\n\t\tclear: both;\n\t}\n\n\th1,h2,h3,h4,h5,h6 {\n\t\tline-height: 1.1; margin:0 0 16px 0; color: #000;\n\t}\n\n\th1 { font-weight: 100; font-size: 44px;}\n\th2 { font-weight: 600; font-size: 30px; color: #2F343D;}\n\th3 { font-weight: 100; font-size: 27px;}\n\th4 { font-weight: 500; font-size: 14px; color: #2F343D;}\n\th5 { font-weight: 500; font-size: 13px; line-height: 1.6; color: #2F343D}\n\th6 { font-weight: 500; font-size: 10px; color: #6c727A; line-height: 1.7;}\n\n\t.container {\n\t\tdisplay: block;\n\t\tmax-width: 640px;\n\t\tmargin: 0 auto; /* makes it centered */\n\t\tclear: both;\n\t\tborder-radius: 2px;\n\t}\n\n\t.content {\n\t\tpadding: 36px;\n\t}\n\n\t.header-content {\n\t\tpadding-top: 36px;\n\t\tpadding-bottom: 36px;\n\t\tpadding-left: 36px;\n\t\tpadding-right: 36px;\n\t\tmax-width: 640px;\n\t\tmargin: 0 auto;\n\t\tdisplay: block;\n\t}\n\n\t.lead {\n\t\tmargin-bottom: 32px;\n\t\tcolor: #2f343d;\n\t\tline-height: 22px;\n\t\tfont-size: 14px;\n\t}\n\n\t.advice {\n\t\theight: 20px;\n\t\tcolor: #9EA2A8;\n\t\tfont-size: 12px;\n\t\tfont-weight: normal;\n\t\tmargin-bottom: 0;\n\t}\n\t.social {\n\t\tfont-size: 12px\n\t}\n\t\t\t`, {\n\t\t\ttype: 'code',\n\t\t\tcode: 'css',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'email_style_label',\n\t\t\ti18nDescription: 'email_style_description',\n\t\t});\n\t});\n\n\tthis.section('Subject', function() {\n\t\tthis.add('Offline_DM_Email', '[[Site_Name]] You have been direct messaged by [User]', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Offline_DM_Email',\n\t\t\ti18nDescription: 'Offline_Email_Subject_Description',\n\t\t});\n\t\tthis.add('Offline_Mention_Email', '[[Site_Name]] You have been mentioned by [User] in #[Room]', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Offline_Mention_Email',\n\t\t\ti18nDescription: 'Offline_Email_Subject_Description',\n\t\t});\n\t\tthis.add('Offline_Mention_All_Email', '[User] has posted a message in #[Room]', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Offline_Mention_All_Email',\n\t\t\ti18nDescription: 'Offline_Email_Subject_Description',\n\t\t});\n\t});\n\tthis.section('Header_and_Footer', function() {\n\t\tthis.add('Email_Header', '<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><!-- If you delete this tag, the sky will fall on your head --><meta name=\"viewport\" content=\"width=device-width\" /><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><title>Rocket.Chat Cloud</title></head><body bgcolor=\"#F7F8FA\"><table class=\"body\" bgcolor=\"#F7F8FA\" width=\"100%\"><tr><td><!-- HEADER --><table class=\"wrap\" bgcolor=\"#F7F8FA\"><tr><td class=\"header container\"><div class=\"header-content\"><table bgcolor=\"#F7F8FA\" width=\"100%\"><tr><td><img src=\"[Site_Url_Slash]assets/logo.png\" alt=\"Rocket.chat\" width=\"150px\" /></td></tr></table></div></td></tr></table><!-- /HEADER --></td></tr><tr><td><!-- BODY --><table class=\"wrap\"><tr><td class=\"container\" bgcolor=\"#FFFFFF\"><div class=\"content\"><table><tr><td>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Header',\n\t\t});\n\t\tthis.add('Email_Footer', '</td></tr></table></div></td></tr></table><!-- /BODY --></td></tr><tr style=\"margin: 0; padding: 0;\"><td style=\"margin: 0; padding: 0;\"><!-- FOOTER --><table class=\"wrap\"><tr><td class=\"container\"><!-- content --><div class=\"content\"><table width=\"100%\"><tr><td align=\"center\" class=\"social\"><a href=\"https://rocket.chat/blog\">Blog</a> | <a href=\"https://github.com/RocketChat\">Github</a> | <a href=\"https://www.facebook.com/RocketChatApp\">Facebook</a> | <a href=\"https://www.instagram.com/rocket.chat\">Instagram</a></td></tr><tr><td align=\"center\"><h6>© Rocket.Chat Technologies Corp.</h6><h6>Made with ❤️ in 🇧🇷 🇨🇦 🇩🇪 🇮🇳 🇬🇧 🇺🇸 </h6></td></tr></table></div><!-- /content --></td></tr></table><!-- /FOOTER --></td></tr></table></body></html>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Footer',\n\t\t});\n\t\tthis.add('Email_Footer_Direct_Reply', '<p class=\"advice\">{Direct_Reply_Advice}</p>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Footer_Direct_Reply',\n\t\t});\n\t});\n\tthis.section('Direct_Reply', function() {\n\t\tthis.add('Direct_Reply_Enable', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Enable',\n\t\t});\n\t\tthis.add('Direct_Reply_Debug', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Debug',\n\t\t\ti18nDescription: 'Direct_Reply_Debug_Description',\n\t\t});\n\t\tthis.add('Direct_Reply_Protocol', 'IMAP', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'IMAP',\n\t\t\t\t\ti18nLabel: 'IMAP',\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'POP',\n\t\t\t\t\ti18nLabel: 'POP',\n\t\t\t\t},\n\t\t\t],\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Protocol',\n\t\t});\n\t\tthis.add('Direct_Reply_Host', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Host',\n\t\t});\n\t\tthis.add('Direct_Reply_Port', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Port',\n\t\t});\n\t\tthis.add('Direct_Reply_IgnoreTLS', false, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'IgnoreTLS',\n\t\t});\n\t\tthis.add('Direct_Reply_Frequency', 5, {\n\t\t\ttype: 'int',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Frequency',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Direct_Reply_Protocol',\n\t\t\t\tvalue: 'POP',\n\t\t\t},\n\t\t});\n\t\tthis.add('Direct_Reply_Delete', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Delete',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'Direct_Reply_Protocol',\n\t\t\t\tvalue: 'IMAP',\n\t\t\t},\n\t\t});\n\t\tthis.add('Direct_Reply_Separator', '+', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: '!',\n\t\t\t\t\ti18nLabel: '!',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '#',\n\t\t\t\t\ti18nLabel: '#',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '$',\n\t\t\t\t\ti18nLabel: '$',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '%',\n\t\t\t\t\ti18nLabel: '%',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '&',\n\t\t\t\t\ti18nLabel: '&',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '\\'',\n\t\t\t\t\ti18nLabel: '\\'',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '*',\n\t\t\t\t\ti18nLabel: '*',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '+',\n\t\t\t\t\ti18nLabel: '+',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '-',\n\t\t\t\t\ti18nLabel: '-',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '/',\n\t\t\t\t\ti18nLabel: '/',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '=',\n\t\t\t\t\ti18nLabel: '=',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '?',\n\t\t\t\t\ti18nLabel: '?',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '^',\n\t\t\t\t\ti18nLabel: '^',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '_',\n\t\t\t\t\ti18nLabel: '_',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '`',\n\t\t\t\t\ti18nLabel: '`',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '{',\n\t\t\t\t\ti18nLabel: '{',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '|',\n\t\t\t\t\ti18nLabel: '|',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '}',\n\t\t\t\t\ti18nLabel: '}',\n\t\t\t\t}, {\n\t\t\t\t\tkey: '~',\n\t\t\t\t\ti18nLabel: '~',\n\t\t\t\t},\n\t\t\t],\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Direct_Reply_Separator',\n\t\t});\n\t\tthis.add('Direct_Reply_Username', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Username',\n\t\t\tplaceholder: 'email@domain',\n\t\t});\n\t\tthis.add('Direct_Reply_ReplyTo', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'ReplyTo',\n\t\t\tplaceholder: 'email@domain',\n\t\t});\n\t\treturn this.add('Direct_Reply_Password', '', {\n\t\t\ttype: 'password',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Password',\n\t\t});\n\t});\n\tthis.section('SMTP', function() {\n\t\tthis.add('SMTP_Protocol', 'smtp', {\n\t\t\ttype: 'select',\n\t\t\tvalues: [\n\t\t\t\t{\n\t\t\t\t\tkey: 'smtp',\n\t\t\t\t\ti18nLabel: 'smtp',\n\t\t\t\t}, {\n\t\t\t\t\tkey: 'smtps',\n\t\t\t\t\ti18nLabel: 'smtps',\n\t\t\t\t},\n\t\t\t],\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Protocol',\n\t\t});\n\t\tthis.add('SMTP_Host', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Host',\n\t\t});\n\t\tthis.add('SMTP_Port', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Port',\n\t\t});\n\t\tthis.add('SMTP_IgnoreTLS', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'IgnoreTLS',\n\t\t\tenableQuery: {\n\t\t\t\t_id: 'SMTP_Protocol',\n\t\t\t\tvalue: 'smtp',\n\t\t\t},\n\t\t});\n\t\tthis.add('SMTP_Pool', true, {\n\t\t\ttype: 'boolean',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Pool',\n\t\t});\n\t\tthis.add('SMTP_Username', '', {\n\t\t\ttype: 'string',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Username',\n\t\t\tautocomplete: false,\n\t\t});\n\t\tthis.add('SMTP_Password', '', {\n\t\t\ttype: 'password',\n\t\t\tenv: true,\n\t\t\ti18nLabel: 'Password',\n\t\t\tautocomplete: false,\n\t\t});\n\t\tthis.add('From_Email', '', {\n\t\t\ttype: 'string',\n\t\t\tplaceholder: 'email@domain',\n\t\t});\n\t\treturn this.add('SMTP_Test_Button', 'sendSMTPTestEmail', {\n\t\t\ttype: 'action',\n\t\t\tactionText: 'Send_a_test_mail_to_my_user',\n\t\t});\n\t});\n\n\tthis.section('Registration', function() {\n\t\tthis.add('Accounts_Enrollment_Email_Subject', '{Welcome_to Site_name}', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t});\n\t\tthis.add('Accounts_Enrollment_Email', '<h2>{Welcome_to Site_Name}</h2><p>{Visit_Site_Url_and_try_the_best_open_source_chat_solution_available_today}</p><a class=\"btn\" target=\"_blank\" href=\"[Site_URL]\">{Login}</a>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t});\n\t});\n\n\tthis.section('Registration_via_Admin', function() {\n\t\tthis.add('Accounts_UserAddedEmail_Subject', '{Welcome_to Site_Name}', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t});\n\t\tthis.add('Accounts_UserAddedEmail_Email', '<h2>{Welcome_to Site_Name}</h2><p>{Visit_Site_Url_and_try_the_best_open_source_chat_solution_available_today}</p><a class=\"btn\" target=\"_blank\" href=\"[Site_URL]\">{Login}</a>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Accounts_UserAddedEmail_Description',\n\t\t});\n\t});\n\n\tthis.section('Verification', function() {\n\t\tthis.add('Verification_Email_Subject', '{Verification_Email_Subject}', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t});\n\n\t\tthis.add('Verification_Email', '<h2>{Hi_username}</h2><p>{Verification_email_body}</p><a class=\"btn\" target=\"_blank\" href=\"[Verification_Url]\">{Verify_your_email}</a>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Verification_Description',\n\t\t});\n\t});\n\n\n\tthis.section('Invitation', function() {\n\t\tthis.add('Invitation_Subject', '{Invitation_Subject_Default}', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t});\n\t\tthis.add('Invitation_Email', '<h2>{Welcome_to Site_Name}</h2><p>{Visit_Site_Url_and_try_the_best_open_source_chat_solution_available_today}</p><a class=\"btn\" href=\"[Site_URL]\">{Join_Chat}</a>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Invitation_Email_Description',\n\t\t});\n\t});\n\n\tthis.section('Forgot_password_section', function() {\n\t\tthis.add('Forgot_Password_Email_Subject', '{Forgot_Password_Email_Subject}', {\n\t\t\ttype: 'string',\n\t\t\ti18nLabel: 'Subject',\n\t\t});\n\n\t\tthis.add('Forgot_Password_Email', '<h2>{Forgot_password}</h2><p>{Lets_get_you_new_one}</p><a class=\"btn\" href=\"[Forgot_Password_Url]\">{Reset}</a><p class=\"advice\">{If_you_didnt_ask_for_reset_ignore_this_email}</p>', {\n\t\t\ttype: 'code',\n\t\t\tcode: 'text/html',\n\t\t\tmultiline: true,\n\t\t\ti18nLabel: 'Body',\n\t\t\ti18nDescription: 'Forgot_Password_Description',\n\t\t});\n\t});\n});\n","Meteor.methods({\n\t'public-settings/get'(updatedAt) {\n\t\tthis.unblock();\n\t\tconst records = RocketChat.models.Settings.findNotHiddenPublic().fetch();\n\n\t\tif (updatedAt instanceof Date) {\n\t\t\treturn {\n\t\t\t\tupdate: records.filter(function(record) {\n\t\t\t\t\treturn record._updatedAt > updatedAt;\n\t\t\t\t}),\n\t\t\t\tremove: RocketChat.models.Settings.trashFindDeletedAfter(updatedAt, {\n\t\t\t\t\thidden: {\n\t\t\t\t\t\t$ne: true,\n\t\t\t\t\t},\n\t\t\t\t\tpublic: true,\n\t\t\t\t}, {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t_deletedAt: 1,\n\t\t\t\t\t},\n\t\t\t\t}).fetch(),\n\t\t\t};\n\t\t}\n\t\treturn records;\n\t},\n\t'private-settings/get'(updatedAt) {\n\t\tif (!Meteor.userId()) {\n\t\t\treturn [];\n\t\t}\n\t\tthis.unblock();\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'view-privileged-setting')) {\n\t\t\treturn [];\n\t\t}\n\t\tconst records = RocketChat.models.Settings.findNotHidden().fetch();\n\t\tif (updatedAt instanceof Date) {\n\t\t\treturn {\n\t\t\t\tupdate: records.filter(function(record) {\n\t\t\t\t\treturn record._updatedAt > updatedAt;\n\t\t\t\t}),\n\t\t\t\tremove: RocketChat.models.Settings.trashFindDeletedAfter(updatedAt, {\n\t\t\t\t\thidden: {\n\t\t\t\t\t\t$ne: true,\n\t\t\t\t\t},\n\t\t\t\t}, {\n\t\t\t\t\tfields: {\n\t\t\t\t\t\t_id: 1,\n\t\t\t\t\t\t_deletedAt: 1,\n\t\t\t\t\t},\n\t\t\t\t}).fetch(),\n\t\t\t};\n\t\t}\n\t\treturn records;\n\t},\n});\n\nRocketChat.models.Settings.on('change', ({ clientAction, id, data }) => {\n\tswitch (clientAction) {\n\t\tcase 'updated':\n\t\tcase 'inserted':\n\t\t\tconst setting = data || RocketChat.models.Settings.findOneById(id);\n\t\t\tconst value = {\n\t\t\t\t_id: setting._id,\n\t\t\t\tvalue: setting.value,\n\t\t\t\teditor: setting.editor,\n\t\t\t\tproperties: setting.properties,\n\t\t\t};\n\n\t\t\tif (setting.public === true) {\n\t\t\t\tRocketChat.Notifications.notifyAllInThisInstance('public-settings-changed', clientAction, value);\n\t\t\t} else {\n\t\t\t\tRocketChat.Notifications.notifyLoggedInThisInstance('private-settings-changed', clientAction, setting);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'removed':\n\t\t\tRocketChat.Notifications.notifyLoggedInThisInstance('private-settings-changed', clientAction, { _id: id });\n\t\t\tRocketChat.Notifications.notifyAllInThisInstance('public-settings-changed', clientAction, { _id: id });\n\t\t\tbreak;\n\t}\n});\n\nRocketChat.Notifications.streamAll.allowRead('private-settings-changed', function() {\n\tif (this.userId == null) {\n\t\treturn false;\n\t}\n\treturn RocketChat.authz.hasPermission(this.userId, 'view-privileged-setting');\n});\n","/* eslint no-multi-spaces: 0 */\n/* eslint comma-spacing: 0 */\nimport s from 'underscore.string';\n\nMeteor.methods({\n\taddOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'addOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding OAuth Services is not allowed', { method: 'addOAuthService', action: 'Adding_OAuth_Services' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }`                        , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Enable', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-url`                    , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'URL', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-token_path`             , '/oauth/token'    , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Token_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-token_sent_via`         , 'payload'         , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Token_Sent_Via', persistent: true, values: [{ key: 'header', i18nLabel: 'Header' }, { key: 'payload', i18nLabel: 'Payload' }] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-identity_token_sent_via`, 'default'         , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Identity_Token_Sent_Via', persistent: true, values: [{ key: 'default', i18nLabel: 'Same_As_Token_Sent_Via' }, { key: 'header', i18nLabel: 'Header' }, { key: 'payload', i18nLabel: 'Payload' }] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-identity_path`          , '/me'             , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Identity_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-authorize_path`         , '/oauth/authorize', { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Authorize_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-scope`                  , 'openid'          , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Scope', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-id`                     , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_id', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-secret`                 , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Secret', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-login_style`            , 'popup'           , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Login_Style', persistent: true, values: [{ key: 'redirect', i18nLabel: 'Redirect' }, { key: 'popup', i18nLabel: 'Popup' }, { key: '', i18nLabel: 'Default' }] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_label_text`      , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Text', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_label_color`     , '#FFFFFF'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-button_color`           , '#13679A'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Button_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-username_field`         , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Username_Field', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${ name }-merge_users`            , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${ name }`, i18nLabel: 'Accounts_OAuth_Custom_Merge_Users', persistent: true });\n\t} });\n","Meteor.methods({\n\trefreshOAuthService() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'refreshOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Refresh OAuth Services is not allowed', { method: 'refreshOAuthService', action: 'Refreshing_OAuth_Services' });\n\t\t}\n\n\t\tServiceConfiguration.configurations.remove({});\n\n\t\tRocketChat.models.Settings.update({ _id: /^Accounts_OAuth_.+/ }, { $set: { _updatedAt: new Date } }, { multi: true });\n\t},\n});\n","Meteor.methods({\n\taddUserToRoom(data) {\n\t\treturn Meteor.call('addUsersToRoom', {\n\t\t\trid: data.rid,\n\t\t\tusers: [data.username],\n\t\t});\n\t},\n});\n","Meteor.methods({\n\taddUsersToRoom(data = {}) {\n\t\t// Validate user and room\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'addUsersToRoom',\n\t\t\t});\n\t\t}\n\n\t\tif (!Match.test(data.rid, String)) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', {\n\t\t\t\tmethod: 'addUsersToRoom',\n\t\t\t});\n\t\t}\n\n\t\t// Get user and room details\n\t\tconst room = RocketChat.models.Rooms.findOneById(data.rid);\n\t\tconst userId = Meteor.userId();\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(data.rid, userId, { fields: { _id: 1 } });\n\t\tconst userInRoom = subscription != null;\n\n\t\t// Can't add to direct room ever\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-cant-invite-for-direct-room', 'Can\\'t invite user to direct rooms', {\n\t\t\t\tmethod: 'addUsersToRoom',\n\t\t\t});\n\t\t}\n\n\t\t// Can add to any room you're in, with permission, otherwise need specific room type permission\n\t\tlet canAddUser = false;\n\t\tif (userInRoom && RocketChat.authz.hasPermission(userId, 'add-user-to-joined-room', room._id)) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'c' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-c-room')) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'p' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-p-room')) {\n\t\t\tcanAddUser = true;\n\t\t}\n\n\t\t// Adding wasn't allowed\n\t\tif (!canAddUser) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'addUsersToRoom',\n\t\t\t});\n\t\t}\n\n\t\t// Missing the users to be added\n\t\tif (!Array.isArray(data.users)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', {\n\t\t\t\tmethod: 'addUsersToRoom',\n\t\t\t});\n\t\t}\n\n\t\t// Validate each user, then add to room\n\t\tconst user = Meteor.user();\n\t\tdata.users.forEach((username) => {\n\t\t\tconst newUser = RocketChat.models.Users.findOneByUsername(username);\n\t\t\tif (!newUser) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', {\n\t\t\t\t\tmethod: 'addUsersToRoom',\n\t\t\t\t});\n\t\t\t}\n\t\t\tRocketChat.addUserToRoom(data.rid, newUser, user);\n\t\t});\n\n\t\treturn true;\n\t},\n});\n","Meteor.methods({\n\tarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'archiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'archiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'archive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'archiveRoom' });\n\t\t}\n\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-direct-message-room', 'Direct Messages can not be archived', { method: 'archiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.archiveRoom(rid);\n\t},\n});\n","Meteor.methods({\n\tblockUser({ rid, blocked }) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.setBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t},\n});\n","Meteor.methods({\n\tcheckRegistrationSecretURL(hash) {\n\n\t\tcheck(hash, String);\n\n\t\treturn hash === RocketChat.settings.get('Accounts_RegistrationForm_SecretURL');\n\t},\n});\n","Meteor.methods({\n\tcheckUsernameAvailability(username) {\n\t\tcheck(username, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setUsername' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (user.username && !RocketChat.settings.get('Accounts_AllowUsernameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setUsername' });\n\t\t}\n\n\t\tif (user.username === username) {\n\t\t\treturn true;\n\t\t}\n\t\treturn RocketChat.checkUsernameAvailability(username);\n\t},\n});\n\nRocketChat.RateLimiter.limitMethod('checkUsernameAvailability', 1, 1000, {\n\tuserId() { return true; },\n});\n","/* globals FileUpload */\n\nMeteor.methods({\n\tcleanRoomHistory({ roomId, latest, oldest, inclusive = true, limit, excludePinned = false, filesOnly = false, fromUsers = [] }) {\n\t\tcheck(roomId, String);\n\t\tcheck(latest, Date);\n\t\tcheck(oldest, Date);\n\t\tcheck(inclusive, Boolean);\n\t\tcheck(limit, Match.Maybe(Number));\n\t\tcheck(excludePinned, Match.Maybe(Boolean));\n\t\tcheck(filesOnly, Match.Maybe(Boolean));\n\t\tcheck(fromUsers, Match.Maybe([String]));\n\n\t\tconst userId = Meteor.userId();\n\n\t\tif (!userId) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'cleanRoomHistory' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(userId, 'clean-channel-history', roomId)) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'cleanRoomHistory' });\n\t\t}\n\n\t\treturn RocketChat.cleanRoomHistory({ rid: roomId, latest, oldest, inclusive, limit, excludePinned, filesOnly, fromUsers });\n\t},\n});\n","Meteor.methods({\n\tcreateChannel(name, members, readOnly = false, customFields = {}, extraData = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createChannel' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-c')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createChannel' });\n\t\t}\n\t\treturn RocketChat.createRoom('c', name, Meteor.user() && Meteor.user().username, members, readOnly, { customFields, ...extraData });\n\t},\n});\n","Meteor.methods({\n\tcreateToken(userId) {\n\t\tif (Meteor.userId() !== userId && !RocketChat.authz.hasPermission(Meteor.userId(), 'user-generate-access-token')) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'createToken' });\n\t\t}\n\t\tconst token = Accounts._generateStampedLoginToken();\n\t\tAccounts._insertLoginToken(userId, token);\n\t\treturn {\n\t\t\tuserId,\n\t\t\tauthToken: token.token,\n\t\t};\n\t},\n});\n","Meteor.methods({\n\tcreatePrivateGroup(name, members, readOnly = false, customFields = {}, extraData = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-p')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\t// validate extra data schema\n\t\tcheck(extraData, Match.ObjectIncluding({\n\t\t\ttokenpass: Match.Maybe({\n\t\t\t\trequire: String,\n\t\t\t\ttokens: [{\n\t\t\t\t\ttoken: String,\n\t\t\t\t\tbalance: String,\n\t\t\t\t}],\n\t\t\t}),\n\t\t}));\n\n\t\treturn RocketChat.createRoom('p', name, Meteor.user() && Meteor.user().username, members, readOnly, { customFields, ...extraData });\n\t},\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tdeleteMessage(message) {\n\t\tcheck(message, Match.ObjectIncluding({\n\t\t\t_id: String,\n\t\t}));\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'deleteMessage',\n\t\t\t});\n\t\t}\n\t\tconst originalMessage = RocketChat.models.Messages.findOneById(message._id, {\n\t\t\tfields: {\n\t\t\t\tu: 1,\n\t\t\t\trid: 1,\n\t\t\t\tfile: 1,\n\t\t\t\tts: 1,\n\t\t\t},\n\t\t});\n\t\tif (originalMessage == null) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'deleteMessage',\n\t\t\t\taction: 'Delete_message',\n\t\t\t});\n\t\t}\n\t\tconst forceDelete = RocketChat.authz.hasPermission(Meteor.userId(), 'force-delete-message', originalMessage.rid);\n\t\tconst hasPermission = RocketChat.authz.hasPermission(Meteor.userId(), 'delete-message', originalMessage.rid);\n\t\tconst deleteAllowed = RocketChat.settings.get('Message_AllowDeleting');\n\t\tconst deleteOwn = originalMessage && originalMessage.u && originalMessage.u._id === Meteor.userId();\n\t\tif (!(hasPermission || (deleteAllowed && deleteOwn)) && !(forceDelete)) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'deleteMessage',\n\t\t\t\taction: 'Delete_message',\n\t\t\t});\n\t\t}\n\t\tconst blockDeleteInMinutes = RocketChat.settings.get('Message_AllowDeleting_BlockDeleteInMinutes');\n\t\tif (blockDeleteInMinutes != null && blockDeleteInMinutes !== 0 && !forceDelete) {\n\t\t\tif (originalMessage.ts == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst msgTs = moment(originalMessage.ts);\n\t\t\tif (msgTs == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst currentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\tif (currentTsDiff > blockDeleteInMinutes) {\n\t\t\t\tthrow new Meteor.Error('error-message-deleting-blocked', 'Message deleting is blocked', {\n\t\t\t\t\tmethod: 'deleteMessage',\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn RocketChat.deleteMessage(originalMessage, Meteor.user());\n\t},\n});\n","import s from 'underscore.string';\n\nMeteor.methods({\n\tdeleteUserOwnAccount(password) {\n\n\t\tcheck(password, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowDeleteOwnAccount')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tconst userId = Meteor.userId();\n\t\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (user.services && user.services.password && s.trim(user.services.password.bcrypt)) {\n\t\t\tconst result = Accounts._checkPassword(user, { digest: password, algorithm: 'sha-256' });\n\t\t\tif (result.error) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-password', 'Invalid password', { method: 'deleteUserOwnAccount' });\n\t\t\t}\n\t\t} else if (user.username !== s.trim(password)) {\n\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.deleteUser(userId);\n\t\t});\n\n\t\treturn true;\n\t},\n});\n","Meteor.methods({\n\texecuteSlashCommandPreview(command, preview) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'getSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\tif (!command || !command.cmd || !RocketChat.slashCommands.commands[command.cmd]) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\tconst theCmd = RocketChat.slashCommands.commands[command.cmd];\n\t\tif (!theCmd.providesPreview) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Command Does Not Provide Previews', {\n\t\t\t\tmethod: 'executeSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\tif (!preview) {\n\t\t\tthrow new Meteor.Error('error-invalid-command-preview', 'Invalid Preview Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\treturn RocketChat.slashCommands.executePreview(command.cmd, command.params, command.msg, preview);\n\t},\n});\n","import Filter from 'bad-words';\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\n\tif (RocketChat.settings.get('Message_AllowBadWordsFilter')) {\n\t\tconst badWordsList = RocketChat.settings.get('Message_BadWordsFilterList');\n\t\tlet options;\n\n\t\t// Add words to the blacklist\n\t\tif (!!badWordsList && badWordsList.length) {\n\t\t\toptions = {\n\t\t\t\tlist: badWordsList.split(','),\n\t\t\t};\n\t\t}\n\t\tconst filter = new Filter(options);\n\t\tmessage.msg = filter.clean(message.msg);\n\t}\n\n\treturn message;\n\n}, 1, 'filterBadWords');\n","import _ from 'underscore';\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\t// Test if the message mentions include @all.\n\tif (message.mentions != null &&\n\t\t_.pluck(message.mentions, '_id').some((item) => item === 'all')) {\n\n\t\t// Check if the user has permissions to use @all in both global and room scopes.\n\t\tif (!RocketChat.authz.hasPermission(message.u._id, 'mention-all') && !RocketChat.authz.hasPermission(message.u._id, 'mention-all', message.rid)) {\n\n\t\t\t// Get the language of the user for the error notification.\n\t\t\tconst { language } = RocketChat.models.Users.findOneById(message.u._id);\n\t\t\tconst action = TAPi18n.__('Notify_all_in_this_room', {}, language);\n\n\t\t\t// Add a notification to the chat, informing the user that this\n\t\t\t// action is not allowed.\n\t\t\tRocketChat.Notifications.notifyUser(message.u._id, 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: message.rid,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('error-action-not-allowed', { action }, language),\n\t\t\t});\n\n\t\t\t// Also throw to stop propagation of 'sendMessage'.\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Notify all in this room not allowed', {\n\t\t\t\tmethod: 'filterATAllTag',\n\t\t\t\taction: 'Notify_all_in_this_room',\n\t\t\t});\n\t\t}\n\t}\n\n\treturn message;\n\n}, 1, 'filterATAllTag');\n","import _ from 'underscore';\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\t// Test if the message mentions include @here.\n\tif (message.mentions != null &&\n\t\t_.pluck(message.mentions, '_id').some((item) => item === 'here')) {\n\n\t\t// Check if the user has permissions to use @here in both global and room scopes.\n\t\tif (!RocketChat.authz.hasPermission(message.u._id, 'mention-here') && !RocketChat.authz.hasPermission(message.u._id, 'mention-here', message.rid)) {\n\n\t\t\t// Get the language of the user for the error notification.\n\t\t\tconst { language } = RocketChat.models.Users.findOneById(message.u._id);\n\t\t\tconst action = TAPi18n.__('Notify_active_in_this_room', {}, language);\n\n\t\t\t// Add a notification to the chat, informing the user that this\n\t\t\t// action is not allowed.\n\t\t\tRocketChat.Notifications.notifyUser(message.u._id, 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: message.rid,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('error-action-not-allowed', { action }, language),\n\t\t\t});\n\n\t\t\t// Also throw to stop propagation of 'sendMessage'.\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Notify here in this room not allowed', {\n\t\t\t\tmethod: 'filterATHereTag',\n\t\t\t\taction: 'Notify_active_in_this_room',\n\t\t\t});\n\t\t}\n\t}\n\n\treturn message;\n\n}, 1, 'filterATHereTag');\n","import _ from 'underscore';\n\nMeteor.methods({\n\tgetChannelHistory({ rid, latest, oldest, inclusive, count = 20, unreads }) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst fromUserId = Meteor.userId();\n\t\tconst room = Meteor.call('canAccessRoom', rid, fromUserId);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Make sure they can access the room\n\t\tif (room.t === 'c' && !RocketChat.authz.hasPermission(fromUserId, 'preview-c-room') && !RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, fromUserId, { fields: { _id: 1 } })) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Ensure latest is always defined.\n\t\tif (_.isUndefined(latest)) {\n\t\t\tlatest = new Date();\n\t\t}\n\n\t\t// Verify oldest is a date if it exists\n\t\tif (!_.isUndefined(oldest) && !_.isDate(oldest)) {\n\t\t\tthrow new Meteor.Error('error-invalid-date', 'Invalid date', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\tts: -1,\n\t\t\t},\n\t\t\tlimit: count,\n\t\t};\n\n\t\tif (!RocketChat.settings.get('Message_ShowEditedStatus')) {\n\t\t\toptions.fields = { editedAt: 0 };\n\t\t}\n\n\t\tlet records = [];\n\t\tif (_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestampInclusive(rid, latest, options).fetch();\n\t\t} else if (_.isUndefined(oldest) && !inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestamp(rid, latest, options).fetch();\n\t\t} else if (!_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestampsInclusive(rid, oldest, latest, options).fetch();\n\t\t} else {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, latest, options).fetch();\n\t\t}\n\n\t\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\t\tconst messages = _.map(records, (message) => {\n\t\t\tmessage.starred = _.findWhere(message.starred, { _id: fromUserId });\n\t\t\tif (message.u && message.u._id && UI_Use_Real_Name) {\n\t\t\t\tconst user = RocketChat.models.Users.findOneById(message.u._id);\n\t\t\t\tmessage.u.name = user && user.name;\n\t\t\t}\n\t\t\tif (message.mentions && message.mentions.length && UI_Use_Real_Name) {\n\t\t\t\tmessage.mentions.forEach((mention) => {\n\t\t\t\t\tconst user = RocketChat.models.Users.findOneById(mention._id);\n\t\t\t\t\tmention.name = user && user.name;\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn message;\n\t\t});\n\n\t\tif (unreads) {\n\t\t\tlet unreadNotLoaded = 0;\n\t\t\tlet firstUnread = undefined;\n\n\t\t\tif (!_.isUndefined(oldest)) {\n\t\t\t\tconst firstMsg = messages[messages.length - 1];\n\t\t\t\tif (!_.isUndefined(firstMsg) && firstMsg.ts > oldest) {\n\t\t\t\t\tconst unreadMessages = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, firstMsg.ts, { limit: 1, sort: { ts: 1 } });\n\t\t\t\t\tfirstUnread = unreadMessages.fetch()[0];\n\t\t\t\t\tunreadNotLoaded = unreadMessages.count();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tmessages: messages || [],\n\t\t\t\tfirstUnread,\n\t\t\t\tunreadNotLoaded,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tmessages: messages || [],\n\t\t};\n\t},\n});\n","Meteor.methods({\n\tgetFullUserData({ filter = '', username = '', limit = 1 }) {\n\t\tconst result = RocketChat.getFullUserData({ userId: Meteor.userId(), filter: filter || username, limit });\n\t\treturn result && result.fetch();\n\t},\n});\n","Meteor.methods({\n\tgetRoomJoinCode(rid) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getJoinCode' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'view-join-code')) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'getJoinCode' });\n\t\t}\n\n\t\tconst [room] = RocketChat.models.Rooms.findById(rid).fetch();\n\n\t\treturn room && room.joinCode;\n\t},\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\tgetRoomRoles(rid) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId() && RocketChat.settings.get('Accounts_AllowAnonymousRead') === false) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getRoomRoles' });\n\t\t}\n\n\t\tcheck(rid, String);\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\t'u.username': 1,\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\trid: 1,\n\t\t\t\tu: 1,\n\t\t\t\troles: 1,\n\t\t\t},\n\t\t};\n\n\t\tconst UI_Use_Real_Name = RocketChat.settings.get('UI_Use_Real_Name') === true;\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Subscriptions', description: { $exists: 1, $ne: '' } }).fetch();\n\t\tconst subscriptions = RocketChat.models.Subscriptions.findByRoomIdAndRoles(rid, _.pluck(roles, '_id'), options).fetch();\n\n\t\tif (!UI_Use_Real_Name) {\n\t\t\treturn subscriptions;\n\t\t} else {\n\t\t\treturn subscriptions.map((subscription) => {\n\t\t\t\tconst user = RocketChat.models.Users.findOneById(subscription.u._id);\n\t\t\t\tsubscription.u.name = user && user.name;\n\t\t\t\treturn subscription;\n\t\t\t});\n\t\t}\n\t},\n});\n","Meteor.methods({\n\tgetServerInfo() {\n\t\treturn RocketChat.Info;\n\t},\n});\n","Meteor.methods({\n\tgetSingleMessage(msgId) {\n\t\tcheck(msgId, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getSingleMessage' });\n\t\t}\n\n\t\tconst msg = RocketChat.models.Messages.findOneById(msgId);\n\n\t\tif (!msg && !msg.rid) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tMeteor.call('canAccessRoom', msg.rid, Meteor.userId());\n\n\t\treturn msg;\n\t},\n});\n","Meteor.methods({\n\tgetSlashCommandPreviews(command) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'getSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\tif (!command || !command.cmd || !RocketChat.slashCommands.commands[command.cmd]) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Invalid Command Provided', {\n\t\t\t\tmethod: 'executeSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\tconst theCmd = RocketChat.slashCommands.commands[command.cmd];\n\t\tif (!theCmd.providesPreview) {\n\t\t\tthrow new Meteor.Error('error-invalid-command', 'Command Does Not Provide Previews', {\n\t\t\t\tmethod: 'executeSlashCommandPreview',\n\t\t\t});\n\t\t}\n\n\t\treturn RocketChat.slashCommands.getPreviews(command.cmd, command.params, command.msg);\n\t},\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\tgetUserRoles() {\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getUserRoles' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\tusername: 1,\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\troles: 1,\n\t\t\t},\n\t\t};\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Users', description: { $exists: 1, $ne: '' } }).fetch();\n\t\tconst roleIds = _.pluck(roles, '_id');\n\n\t\t// Security issue: we should not send all user's roles to all clients, only the 'public' roles\n\t\t// We must remove all roles that are not part of the query from the returned users\n\t\tconst users = RocketChat.models.Users.findUsersInRoles(roleIds, null, options).fetch();\n\t\tfor (const user of users) {\n\t\t\tuser.roles = _.intersection(user.roles, roleIds);\n\t\t}\n\t\treturn users;\n\t},\n});\n","Meteor.methods({\n\tinsertOrUpdateUser(userData) {\n\n\t\tcheck(userData, Object);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'insertOrUpdateUser' });\n\t\t}\n\n\t\treturn RocketChat.saveUser(Meteor.userId(), userData);\n\t},\n});\n","Meteor.methods({\n\tjoinDefaultChannels(silenced) {\n\t\tcheck(silenced, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinDefaultChannels' });\n\t\t}\n\n\t\tthis.unblock();\n\t\treturn RocketChat.addUserToDefaultChannels(Meteor.user(), silenced);\n\t},\n});\n","Meteor.methods({\n\tjoinRoom(rid, code) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'joinRoom' });\n\t\t}\n\n\t\t// TODO we should have a 'beforeJoinRoom' call back so external services can do their own validations\n\t\tconst user = Meteor.user();\n\t\tif (room.tokenpass && user && user.services && user.services.tokenpass) {\n\t\t\tconst balances = RocketChat.updateUserTokenpassBalances(user);\n\n\t\t\tif (!RocketChat.Tokenpass.validateAccess(room.tokenpass, balances)) {\n\t\t\t\tthrow new Meteor.Error('error-not-allowed', 'Token required', { method: 'joinRoom' });\n\t\t\t}\n\t\t} else {\n\t\t\tif (!RocketChat.authz.canAccessRoom(room, Meteor.user())) {\n\t\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'joinRoom' });\n\t\t\t}\n\n\t\t\tif ((room.joinCodeRequired === true) && (code !== room.joinCode) && !RocketChat.authz.hasPermission(Meteor.userId(), 'join-without-join-code')) {\n\t\t\t\tthrow new Meteor.Error('error-code-invalid', 'Invalid Room Password', { method: 'joinRoom' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.addUserToRoom(rid, user);\n\t},\n});\n","Meteor.methods({\n\tleaveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'leaveRoom' });\n\t\t}\n\n\t\tthis.unblock();\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\t\tconst user = Meteor.user();\n\n\t\tif (room.t === 'd' || (room.t === 'c' && !RocketChat.authz.hasPermission(user._id, 'leave-c')) || (room.t === 'p' && !RocketChat.authz.hasPermission(user._id, 'leave-p'))) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'leaveRoom' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, user._id, { fields: { _id: 1 } });\n\t\tif (!subscription) {\n\t\t\tthrow new Meteor.Error('error-user-not-in-room', 'You are not in this room', { method: 'leaveRoom' });\n\t\t}\n\n\t\t// If user is room owner, check if there are other owners. If there isn't anyone else, warn user to set a new owner.\n\t\tif (RocketChat.authz.hasRole(user._id, 'owner', room._id)) {\n\t\t\tconst numOwners = RocketChat.authz.getUsersInRole('owner', room._id).count();\n\t\t\tif (numOwners === 1) {\n\t\t\t\tthrow new Meteor.Error('error-you-are-last-owner', 'You are the last owner. Please set new owner before leaving the room.', { method: 'leaveRoom' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.removeUserFromRoom(rid, user);\n\t},\n});\n","import s from 'underscore.string';\n\nMeteor.methods({\n\tremoveOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-url`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-token_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-identity_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-authorize_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-scope`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-token_sent_via`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-identity_token_sent_via`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-id`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-secret`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_label_text`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_label_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-button_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-login_style`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-username_field`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${ name }-merge_users`);\n\t},\n});\n","Meteor.methods({\n\trestart_server() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'restart_server' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasRole(Meteor.userId(), 'admin') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'restart_server' });\n\t\t}\n\n\t\tMeteor.setTimeout(() => {\n\t\t\tMeteor.setTimeout(() => {\n\t\t\t\tconsole.warn('Call to process.exit() timed out, aborting.');\n\t\t\t\tprocess.abort();\n\t\t\t}, 1000);\n\t\t\tprocess.exit(1);\n\t\t}, 1000);\n\n\t\treturn {\n\t\t\tmessage: 'The_server_will_restart_in_s_seconds',\n\t\t\tparams: [2],\n\t\t};\n\t},\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\t'robot.modelCall'(model, method, args) {\n\t\tcheck(model, String);\n\t\tcheck(method, String);\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'robot.modelCall',\n\t\t\t});\n\t\t}\n\t\tif (!RocketChat.authz.hasRole(Meteor.userId(), 'robot')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'robot.modelCall',\n\t\t\t});\n\t\t}\n\t\tconst m = RocketChat.models[model];\n\n\t\tif (!m || !_.isFunction(m[method])) {\n\t\t\tthrow new Meteor.Error('error-invalid-method', 'Invalid method', {\n\t\t\t\tmethod: 'robot.modelCall',\n\t\t\t});\n\t\t}\n\t\tconst cursor = RocketChat.models[model][method].apply(RocketChat.models[model], args);\n\t\treturn cursor && cursor.fetch ? cursor.fetch() : cursor;\n\t},\n});\n","/* eslint new-cap: 0 */\n\nMeteor.methods({\n\tsaveSetting(_id, value, editor) {\n\t\tif (Meteor.userId() === null) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting',\n\t\t\t});\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'edit-privileged-setting')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting',\n\t\t\t});\n\t\t}\n\n\t\t// Verify the _id passed in is a string.\n\t\tcheck(_id, String);\n\n\t\tconst setting = RocketChat.models.Settings.db.findOneById(_id);\n\n\t\t// Verify the value is what it should be\n\t\tswitch (setting.type) {\n\t\t\tcase 'roomPick':\n\t\t\t\tcheck(value, Match.OneOf([Object], ''));\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tcheck(value, Boolean);\n\t\t\t\tbreak;\n\t\t\tcase 'int':\n\t\t\t\tcheck(value, Number);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcheck(value, String);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tRocketChat.settings.updateById(_id, value, editor);\n\t\treturn true;\n\t},\n});\n","import * as Mailer from 'meteor/rocketchat:mailer';\nlet html = '';\nMeteor.startup(() => {\n\tMailer.getTemplate('Invitation_Email', (value) => {\n\t\thtml = value;\n\t});\n});\n\nMeteor.methods({\n\tsendInvitationEmail(emails) {\n\t\tcheck(emails, [String]);\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendInvitationEmail',\n\t\t\t});\n\t\t}\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'bulk-register-user')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'sendInvitationEmail',\n\t\t\t});\n\t\t}\n\t\tconst validEmails = emails.filter(Mailer.checkAddressFormat);\n\n\t\tconst subject = RocketChat.settings.get('Invitation_Subject');\n\n\t\treturn validEmails.filter((email) => {\n\t\t\ttry {\n\t\t\t\treturn Mailer.send({\n\t\t\t\t\tto: email,\n\t\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\t\tsubject,\n\t\t\t\t\thtml,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\temail,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t} catch ({ message }) {\n\t\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ message }`, {\n\t\t\t\t\tmethod: 'sendInvitationEmail',\n\t\t\t\t\tmessage,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t},\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tsendMessage(message) {\n\t\tcheck(message, Object);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendMessage',\n\t\t\t});\n\t\t}\n\n\t\tif (!message.rid) {\n\t\t\tthrow new Error('The \\'rid\\' property on the message object is missing.');\n\t\t}\n\n\t\tif (message.ts) {\n\t\t\tconst tsDiff = Math.abs(moment(message.ts).diff());\n\t\t\tif (tsDiff > 60000) {\n\t\t\t\tthrow new Meteor.Error('error-message-ts-out-of-sync', 'Message timestamp is out of sync', {\n\t\t\t\t\tmethod: 'sendMessage',\n\t\t\t\t\tmessage_ts: message.ts,\n\t\t\t\t\tserver_ts: new Date().getTime(),\n\t\t\t\t});\n\t\t\t} else if (tsDiff > 10000) {\n\t\t\t\tmessage.ts = new Date();\n\t\t\t}\n\t\t} else {\n\t\t\tmessage.ts = new Date();\n\t\t}\n\n\t\tif (message.msg) {\n\t\t\tconst adjustedMessage = RocketChat.messageProperties.messageWithoutEmojiShortnames(message.msg);\n\n\t\t\tif (RocketChat.messageProperties.length(adjustedMessage) > RocketChat.settings.get('Message_MaxAllowedSize')) {\n\t\t\t\tthrow new Meteor.Error('error-message-size-exceeded', 'Message size exceeds Message_MaxAllowedSize', {\n\t\t\t\t\tmethod: 'sendMessage',\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst user = RocketChat.models.Users.findOneById(Meteor.userId(), {\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\tname: 1,\n\t\t\t},\n\t\t});\n\n\t\tconst room = Meteor.call('canAccessRoom', message.rid, user._id);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(message.rid, Meteor.userId());\n\t\tif (subscription && (subscription.blocked || subscription.blocker)) {\n\t\t\tRocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: room._id,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('room_is_blocked', {}, user.language),\n\t\t\t});\n\t\t\tthrow new Meteor.Error('You can\\'t send messages because you are blocked');\n\t\t}\n\n\t\tif ((room.muted || []).includes(user.username)) {\n\t\t\tRocketChat.Notifications.notifyUser(Meteor.userId(), 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: room._id,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('You_have_been_muted', {}, user.language),\n\t\t\t});\n\t\t\tthrow new Meteor.Error('You can\\'t send messages because you have been muted');\n\t\t}\n\n\t\tif (message.alias == null && RocketChat.settings.get('Message_SetNameToAliasEnabled')) {\n\t\t\tmessage.alias = user.name;\n\t\t}\n\n\t\tif (Meteor.settings.public.sandstorm) {\n\t\t\tmessage.sandstormSessionId = this.connection.sandstormSessionId();\n\t\t}\n\n\t\tRocketChat.metrics.messagesSent.inc(); // TODO This line needs to be moved to it's proper place. See the comments on: https://github.com/RocketChat/Rocket.Chat/pull/5736\n\t\treturn RocketChat.sendMessage(user, message, room);\n\t},\n});\n// Limit a user, who does not have the \"bot\" role, to sending 5 msgs/second\nRocketChat.RateLimiter.limitMethod('sendMessage', 5, 1000, {\n\tuserId(userId) {\n\t\treturn !RocketChat.authz.hasPermission(userId, 'send-many-messages');\n\t},\n});\n","import * as Mailer from 'meteor/rocketchat:mailer';\n\nMeteor.methods({\n\tsendSMTPTestEmail() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'sendSMTPTestEmail',\n\t\t\t});\n\t\t}\n\t\tconst user = Meteor.user();\n\t\tif (!user.emails && !user.emails[0] && user.emails[0].address) {\n\t\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email', {\n\t\t\t\tmethod: 'sendSMTPTestEmail',\n\t\t\t});\n\t\t}\n\t\ttry {\n\t\t\tMailer.send({\n\t\t\t\tto: user.emails[0].address,\n\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\tsubject: 'SMTP Test Email',\n\t\t\t\thtml: '<p>You have successfully sent an email</p>',\n\t\t\t});\n\t\t} catch ({ message }) {\n\t\t\tthrow new Meteor.Error('error-email-send-failed', `Error trying to send email: ${ message }`, {\n\t\t\t\tmethod: 'sendSMTPTestEmail',\n\t\t\t\tmessage,\n\t\t\t});\n\t\t}\n\t\treturn {\n\t\t\tmessage: 'Your_mail_was_sent_to_s',\n\t\t\tparams: [user.emails[0].address],\n\t\t};\n\t},\n});\n\nDDPRateLimiter.addRule({\n\ttype: 'method',\n\tname: 'sendSMTPTestEmail',\n\tuserId() {\n\t\treturn true;\n\t},\n}, 1, 1000);\n","Meteor.methods({\n\tsetAdminStatus(userId, admin) {\n\n\t\tcheck(userId, String);\n\t\tcheck(admin, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'assign-admin-role') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tconst user = Meteor.users.findOne({ _id: userId }, { fields: { username: 1 } });\n\n\t\tif (admin) {\n\t\t\treturn Meteor.call('authorization:addUserToRole', 'admin', user.username);\n\t\t} else {\n\t\t\treturn Meteor.call('authorization:removeUserFromRole', 'admin', user.username);\n\t\t}\n\t},\n});\n","Meteor.methods({\n\tsetRealName(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setRealName' });\n\t\t}\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowRealNameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setRealName' });\n\t\t}\n\n\t\tif (!RocketChat.setRealName(Meteor.userId(), name)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-name', 'Could not change name', { method: 'setRealName' });\n\t\t}\n\n\t\treturn name;\n\t},\n});\n\nRocketChat.RateLimiter.limitMethod('setRealName', 1, 1000, {\n\tuserId: () => true,\n});\n","import _ from 'underscore';\n\nMeteor.methods({\n\tsetUsername(username, param = {}) {\n\t\tconst { joinDefaultChannelsSilenced } = param;\n\t\tcheck(username, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setUsername' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (user.username && !RocketChat.settings.get('Accounts_AllowUsernameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setUsername' });\n\t\t}\n\n\t\tif (user.username === username || (user.username && user.username.toLowerCase() === username.toLowerCase())) {\n\t\t\treturn username;\n\t\t}\n\n\t\tlet nameValidation;\n\t\ttry {\n\t\t\tnameValidation = new RegExp(`^${ RocketChat.settings.get('UTF8_Names_Validation') }$`);\n\t\t} catch (error) {\n\t\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t\t}\n\n\t\tif (!nameValidation.test(username)) {\n\t\t\tthrow new Meteor.Error('username-invalid', `${ _.escape(username) } is not a valid username, use only letters, numbers, dots, hyphens and underscores`);\n\t\t}\n\n\t\tif (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `<strong>${ _.escape(username) }</strong> is already in use :(`, { method: 'setUsername', field: username });\n\t\t}\n\n\t\tif (!RocketChat.setUsername(user._id, username)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-username', 'Could not change username', { method: 'setUsername' });\n\t\t}\n\n\t\tif (!user.username) {\n\t\t\tMeteor.runAsUser(user._id, () => Meteor.call('joinDefaultChannels', joinDefaultChannelsSilenced));\n\t\t\tMeteor.defer(function() {\n\t\t\t\treturn RocketChat.callbacks.run('afterCreateUser', RocketChat.models.Users.findOneById(user._id));\n\t\t\t});\n\t\t}\n\n\t\treturn username;\n\t},\n});\n\nRocketChat.RateLimiter.limitMethod('setUsername', 1, 1000, {\n\tuserId() { return true; },\n});\n","Meteor.methods({\n\tsetEmail(email) {\n\n\t\tcheck (email, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setEmail' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowEmailChange')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Changing email is not allowed', { method: 'setEmail', action: 'Changing_email' });\n\t\t}\n\n\t\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\t\treturn email;\n\t\t}\n\n\t\tif (!RocketChat.setEmail(user._id, email)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-email', 'Could not change email', { method: 'setEmail' });\n\t\t}\n\n\t\treturn email;\n\t},\n});\n\nRocketChat.RateLimiter.limitMethod('setEmail', 1, 1000, {\n\tuserId(/* userId*/) { return true; },\n});\n","Meteor.methods({\n\tunarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'unarchive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.unarchiveRoom(rid);\n\t},\n});\n","Meteor.methods({\n\tunblockUser({ rid, blocked }) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.unsetBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t},\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tupdateMessage(message) {\n\n\t\tcheck(message, Match.ObjectIncluding({ _id:String }));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'updateMessage' });\n\t\t}\n\n\t\tconst originalMessage = RocketChat.models.Messages.findOneById(message._id);\n\n\t\tif (!originalMessage || !originalMessage._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst hasPermission = RocketChat.authz.hasPermission(Meteor.userId(), 'edit-message', message.rid);\n\t\tconst editAllowed = RocketChat.settings.get('Message_AllowEditing');\n\t\tconst editOwn = originalMessage.u && originalMessage.u._id === Meteor.userId();\n\n\t\tif (!hasPermission && (!editAllowed || !editOwn)) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Message editing not allowed', { method: 'updateMessage', action: 'Message_editing' });\n\t\t}\n\n\t\tconst blockEditInMinutes = RocketChat.settings.get('Message_AllowEditing_BlockEditInMinutes');\n\t\tif (Match.test(blockEditInMinutes, Number) && blockEditInMinutes !== 0) {\n\t\t\tlet currentTsDiff;\n\t\t\tlet msgTs;\n\n\t\t\tif (Match.test(originalMessage.ts, Number)) {\n\t\t\t\tmsgTs = moment(originalMessage.ts);\n\t\t\t}\n\t\t\tif (msgTs) {\n\t\t\t\tcurrentTsDiff = moment().diff(msgTs, 'minutes');\n\t\t\t}\n\t\t\tif (currentTsDiff > blockEditInMinutes) {\n\t\t\t\tthrow new Meteor.Error('error-message-editing-blocked', 'Message editing is blocked', { method: 'updateMessage' });\n\t\t\t}\n\t\t}\n\n\t\t// It is possible to have an empty array as the attachments property, so ensure both things exist\n\t\tif (originalMessage.attachments && originalMessage.attachments.length > 0 && originalMessage.attachments[0].description !== undefined) {\n\t\t\tmessage.attachments = originalMessage.attachments;\n\t\t\tmessage.attachments[0].description = message.msg;\n\t\t\tmessage.msg = originalMessage.msg;\n\t\t}\n\n\t\tmessage.u = originalMessage.u;\n\n\t\treturn RocketChat.updateMessage(message, Meteor.user(), originalMessage);\n\t},\n});\n","import {\n\tConversationRoomType,\n\tDirectMessageRoomType,\n\tFavoriteRoomType,\n\tPrivateRoomType,\n\tPublicRoomType,\n\tUnreadRoomType,\n} from '../lib/roomTypes';\n\nRocketChat.roomTypes.add(new UnreadRoomType());\nRocketChat.roomTypes.add(new FavoriteRoomType());\nRocketChat.roomTypes.add(new ConversationRoomType());\nRocketChat.roomTypes.add(new PublicRoomType());\nRocketChat.roomTypes.add(new PrivateRoomType());\nRocketChat.roomTypes.add(new DirectMessageRoomType());\n","import * as Mailer from 'meteor/rocketchat:mailer';\n\nMailer.setSettings(RocketChat.settings);\n"]}